C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MENUFUNC
OBJECT MODULE PLACED IN .\Obj\MenuFunc.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\UI\MenuFunc.c OPTIMIZE(9,SPEED) BROWSE INCDIR(..\KERNEL\SYSTEM\INC;..
                    -\KERNEL\SCALER\INC;..\DRIVER\extDEVICE\INC;..\LIB\INC;..\PANEL\INC;..\UI\BOARD;..\UI\INC;..\UI\MODEL;..\DRIVER\INC;..\Cu
                    -stomer) DEFINE(ModelName=TSUMXX9_DEMO) DEBUG OBJECTEXTEND PRINT(.\List\MenuFunc.lst) TABS(2) OBJECT(.\Obj\MenuFunc.obj)

line level    source

   1          #include "types.h"
   2          #include "board.h"
   3          #include "global.h"
   4          #include "keypaddef.h"
   5          #include "menudef.h"
   6          #include "adjust.h"
   7          //#include "msADC.h"
   8          #include "ms_reg.h"
   9          #include "debug.h"
  10          #include "Common.h"
  11          #include "msosd.h"
  12          #include "power.h"
  13          #include "misc.h"
  14          #include "autofunc.h"
  15          #include "nvram.h"
  16          #include "userpref.h"
  17          #include "mstar.h"
  18          #include "ms_rwreg.h"
  19          #include "mcu.h"
  20          #include "menustrprop.h"
  21          #include "gamma.h"
  22          #include "ddc2bi.h"
  23          #include "MsDLC.H"
  24          #include "MsACE.H"
  25          //#include "MsRegTV.h" // 110927 coding reserved
  26          //#include "Panel.h"
  27          #include "OsdDefault.h"
  28          
  29          #include "drvgamma.h"
  30          #include "MsHDCP.h"
  31          
  32          #include "msflash.h"
  33          #include "menufunc.h"
  34          #include "drvosd.h"
  35          #include "drvadc.h"
  36          #include "colorpalette.h"
  37          #if ENABLE_HDMI
  38          #include "MsHDMI.h"
  39          #endif
  40          #if ENABLE_DP_INPUT
                #include "drvDpRxAPP.h"
              #endif
  43          #if ENABLE_RTE
              #include "msOVD.h"
              #endif
  46          #if ENABLE_DSC
  47          #include "msDSC_Setting.h"
  48          #endif
  49          #if ENABLE_DPS
  50          #include "msDPS_Setting.h"
  51          #endif
  52          #if ENABLE_3DLUT
              #include "ms3DLUT.h"
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 2   

              #endif
  55          #if CHIP_ID==CHIP_TSUMU
              #include "msscaler.h"
              #elif CHIP_ID == CHIP_TSUM2
              #include "msscaler_2.h"
              #elif CHIP_ID == CHIP_TSUMC || CHIP_ID == CHIP_TSUMK
              #include "msscaler_C.h"
              #elif CHIP_ID == CHIP_TSUMD
              #include "msscaler_D.h"
              #elif CHIP_ID == CHIP_TSUMJ
              #include "msscaler_J.h"
              #endif
  66          
  67          #include "drvDPRxApp.h"
  68          
  69          #if (MS_PM)
  70          #include "Ms_PM.h"
  71          #endif
  72          #include "gpio_def.h"
  73          ////////////////////////////////////
  74          //#include "drvMcu.h"
  75          #include "drvmStar.h"
  76          //#include "halRwreg.h"
  77          ///////////////////////////////////
  78          #if MS_DAC
              #include "drvDAC.h"
              #endif
  81          #if ENABLE_FREESYNC
              #include "ComboApp.h"
              #endif
  84          #define MenuFunc_DEBUG    1
  85          #if ENABLE_DEBUG&&MenuFunc_DEBUG
  86              #define MenuFunc_printData(str, value)   printData(str, value)
  87              #define MenuFunc_printMsg(str)           printMsg(str)
  88          #else
                  #define MenuFunc_printData(str, value)
                  #define MenuFunc_printMsg(str)
              #endif
  92          
  93          void ReadWarm1Setting( void );
  94          void ReadWarm2Setting( void );
  95          void ReadNormalSetting( void );
  96          void ReadCool1Setting( void );
  97          void ReadCool2Setting( void );
  98          void ReadSRGBSetting( void );
  99          
 100          void SetYCMColor( MenuItemActionType action, WORD color, WORD value );
 101          void SetECO( void );
 102          Bool SetBFSize( BYTE ucSize );
 103          void ReadColorTempSetting( void );
 104          
 105          #if Enable_Expansion       // For 4:3 Mode BrightnessFrame Position
 106          WORD xdata DispalyWidth = PANEL_WIDTH;
 107          WORD xdata HStartOffset = 0;
 108          #define DISPLAY_WIDTH   DispalyWidth
 109          #define HSTART_OFFSET   HStartOffset
 110          #else       // Normal Mode
              #define DISPLAY_WIDTH   PanelWidth
              #define HSTART_OFFSET   0
              #endif
 114          
 115          #if ENABLE_OSD_3D_CONTROL
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 3   

              #if CHIP_ID == CHIP_TSUMD
              extern code BYTE t2Dto3DPIXGain[5];
              extern code BYTE t2Dto3DBLKGain[5];
              extern code BYTE t2Dto3DPIXOffset[5];
              extern code BYTE t2Dto3DBLKOffset[5];
              #elif CHIP_ID == CHIP_TSUM2
              extern code BYTE t2Dto3DGain[5];
              extern code BYTE t2Dto3DOffset[5];
              #endif
              #endif
 126          #if EN_HotKeyTimes
              extern BYTE xdata HotKeyTimes_Minutes;
              extern BYTE xdata HotKeyTimes_Second;
              //extern Bool ExecuteKeyEvent(MenuItemActionType menuAction);
              
              #endif
 132          
 133          void ReadUserSetting( void );
 134          //void Save9300KSetting(void);
 135          //void Save6500KSetting(void);
 136          
 137          //vs ccflag add
 138          #if Enable_Expansion
 139          void SetExpansionMode( void );
 140          #endif
 141          #if Audio_Switch
              Bool SetAudioType(AudioType Type);
              #endif
 144          WORD DecIncValue( MenuItemActionType action, WORD value, WORD minValue, WORD maxValue, BYTE step );
 145          WORD GetScale100Value( WORD value, WORD minValue, WORD maxValue );
 146          extern BYTE xdata MenuItemIndex;
 147          extern BYTE xdata MenuPageIndex;
 148          
 149          code short tNormalColorCorrectionMatrix[3][3] =
 150          {
 151              { 1024,    0,       0},
 152              {     0,    1024,       0},
 153              {    0,     0,      1024}
 154          };
 155          //DLC Table......
 156          BYTE code t_MWEDLC_Linear_Table[] =
 157          {
 158              0x07, 0x17, 0x27, 0x37, 0x47, 0x57, 0x67, 0x77, 0x87, 0x97, 0xA7, 0xB7, 0xC7, 0xD7, 0xE7, 0xF7,
 159              0x87, 0x9B, 0x0F, 0xC2, 0xBD, 0x4E, 0xC6, 0xFD, 0xF3, 0x3E, 0xE9, 0x35, 0x75, 0xED, 0x76, 0x8D,
 160              0xC1, 0x74, 0xD4, 0x3C, 0x3A, 0x18, 0xE0, 0x0A, 0xD6, 0xE3, 0x33, 0x0C, 0x0A, 0x84, 0xB7, 0xA0,
 161          };
 162          
 163          /*
 164          BYTE code t_Normal_ColorSettingTable[] =
 165          {
 166              0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
 167              0x04, 0x00, 0x00, 0x00, 0x00, 0xD4, 0x55, 0xED, 0xDC, 0xEA, 0x20, 0x81, 0x11, 0x1B, 0x01, 0xFE,
 168              0xDC, 0xC2, 0xAD, 0xDE, 0x23, 0x63, 0x0E, 0x58, 0x10, 0x21, 0xF1, 0xFA, 0x5D, 0x7B, 0xF1, 0x87,
 169          };
 170          */
 171          
 172          //////////////////////////////////////////////////////////////////////////
 173          // Matrix for VIDEO color correcttion
 174          //////////////////////////////////////////////////////////////////////////
 175          //code short tStandardColorCorrectionMatrix[][3]=
 176          code short t_Normal_ColorSettingTable[][3]=
 177          {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 4   

 178          0x03FF, 0x0000, 0x0000, 0x0000, 0x03FF, 0x0000, 0x0000, 0x0000,
 179          0x03FF,-0x0369, 0x01AB,-0x051B, 0x0012,-0x01D9, 0x0777,-0x0378,
 180          -0x0735, 0x017A, 0x019E,-0x026E, 0x0274, 0x0687,-0x07A6, 0x0280,
 181          -0x0831, 0x0000,-0x0500, 0x0500,-0x0005, 0x0000, 0x0000, 0x0000,
 182          };
 183          
 184          
 185          BYTE* code ColorTempPtr[5][3] =
 186          {
 187              {&UserPrefRedColorWarm1, &UserPrefGreenColorWarm1, &UserPrefBlueColorWarm1},  
 188              {&UserPrefRedColorNormal, &UserPrefGreenColorNormal, &UserPrefBlueColorNormal},
 189              {&UserPrefRedColorCool1, &UserPrefGreenColorCool1, &UserPrefBlueColorCool1},
 190              {&UserPrefRedColorUser, &UserPrefGreenColorUser, &UserPrefBlueColorUser},      
 191              {&UserPrefRedColorSRGB, &UserPrefGreenColorSRGB, &UserPrefBlueColorSRGB},
 192          };
 193          
 194          
 195          WORD GetNonFuncValue( void )
 196          {
 197   1          return 50;
 198   1      }
 199          WORD GetBlueColorValue( void )
 200          {
 201   1          return GetScale100Value( UserPrefBlueColor, MinColorValue, MaxColorValue );
 202   1      }
 203          //====================================================
 204          
 205          WORD GetGreenColorValue( void )
 206          {
 207   1          return GetScale100Value( UserPrefGreenColor, MinColorValue, MaxColorValue );
 208   1      }
 209          //====================================================
 210          
 211          WORD GetRedColorValue( void )
 212          {
 213   1          return GetScale100Value( UserPrefRedColor, MinColorValue, MaxColorValue );
 214   1      }
 215          Bool ChangeSource( void )
 216          {
 217   1        if (UserPrefInputPriorityType == MenuItemIndex)
 218   1          return FALSE;
 219   1        UserPrefInputPriorityType = MenuItemIndex;
 220   1      
 221   1          if( UserPrefInputPriorityType == Input_Priority_Auto )
 222   1          {
 223   2            SrcInputType=SrcInputType;
 224   2          UserPrefInputType=SrcInputType;     
 225   2          }
 226   1          else if( UserPrefInputPriorityType == Input_Priority_Analog1 )
 227   1          {
 228   2            SrcInputType=Input_Analog1;
 229   2          UserPrefInputType=SrcInputType; 
 230   2          } 
 231   1      #if INPUT_TYPE == INPUT_1A1D || INPUT_TYPE == INPUT_1A1H || INPUT_TYPE == INPUT_1A1H || INPUT_TYPE == INPU
             -T_1A1C2
 232   1        else if ( UserPrefInputPriorityType == Input_Priority_Digital1 )
 233   1          {
 234   2          SrcInputType=Input_Digital;
 235   2          UserPrefInputType=SrcInputType;     
 236   2          }
 237   1      #endif
 238   1      #if INPUT_TYPE == INPUT_1A2D || INPUT_TYPE == INPUT_1A2H || INPUT_TYPE == INPUT_1A1D1H || INPUT_TYPE == IN
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 5   

             -PUT_1A1D1DP || INPUT_TYPE == INPUT_1A1H1DP || INPUT_TYPE == INPUT_1A2C
                else if ( UserPrefInputPriorityType == Input_Priority_Digital1 )
                  {
                  SrcInputType=Input_Digital;
                  UserPrefInputType=SrcInputType;     
                  }
                else if ( UserPrefInputPriorityType == Input_Priority_Digital2 )
                  {
                  SrcInputType=Input_Digital2;
                  UserPrefInputType=SrcInputType;     
                  }
              #endif
 250   1      #if INPUT_TYPE == INPUT_1A3C
                else if ( UserPrefInputPriorityType == Input_Priority_Digital1 )
                  {
                  SrcInputType=Input_Digital;
                  UserPrefInputType=SrcInputType;     
                  }
                else if ( UserPrefInputPriorityType == Input_Priority_Digital2 )
                  {
                  SrcInputType=Input_Digital2;
                  UserPrefInputType=SrcInputType;     
                  }
                else if ( UserPrefInputPriorityType == Input_Priority_Digital3 )
                  {
                  SrcInputType=Input_Digital3;
                  UserPrefInputType=SrcInputType;     
                  }
              #endif
 267   1      #if INPUT_TYPE == INPUT_1A1D1H1DP
                else if ( UserPrefInputPriorityType == Input_Priority_Digital1 )
                {
                  SrcInputType=Input_Digital;
                  UserPrefInputType=SrcInputType;     
                }
                else if ( UserPrefInputPriorityType == Input_Priority_Digital2 )
                {
                  SrcInputType=Input_Digital2;
                  UserPrefInputType=SrcInputType;     
                }
                else if ( UserPrefInputPriorityType == Input_Priority_Digital3 )
                {
                  SrcInputType=Input_Displayport;
                  UserPrefInputType=SrcInputType;     
                }
              #endif
 284   1      
 285   1      
 286   1        Set_SaveMonitorSettingFlag();
 287   1          Power_TurnOffPanel();
 288   1        
 289   1          mStar_SetupInputPort();
 290   1          Set_InputTimingChangeFlag();
 291   1          //SrcFlags |= SyncLoss;
 292   1          //if( !ProductModeFlag )
 293   1          //    Set_ShowInputInfoFlag();
 294   1          return TRUE;
 295   1      }
 296          #if ENABLE_DPS
 297          BYTE GetSubWndRealContrast(BYTE ucContrast)
 298          {
 299   1      #if MWEFunction
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 6   

                  return (UserPrefSubContrast+ucContrast-DefContrast);
              #else
 302   1          return (UserPrefContrast+ucContrast-DefContrast);
 303   1      #endif
 304   1      }
 305          #endif
 306          
 307          void MenuFuncuncall(void)
 308          {
 309   1         //AdjustAudioSource();
 310   1          AdjustDcrMode(0);
 311   1      
 312   1      #if 0 
                  AdjustGamaMode(0);
              #if ENABLE_DPS
                  AdjustDPSMode(0);
              #endif
              #if ENABLE_DSC
                  AdjustDSCMode(0);
              #endif
              #if ENABLE_DLC
                  AdjustDLCMode(0);
              #endif
              #if ENABLE_TNR
                  AdjustNRMode(0);
              #endif
              #if ENABLE_SUPER_RESOLUTION
                  AdjustSuperResolutionMode(0);
              #endif
                  //AdjustLanguage();
              #if ENABLE_SHARPNESS
                  GetSharpnessValue();
              #endif
              #endif
 334   1      
 335   1      #if ENABLE_FREESYNC
                  GetSrcFreesyncFPS();
                  SetDRRFunction();
              #endif
 339   1      
 340   1      #if (CHIP_ID == CHIP_TSUMF)
              msDPS_On_Setting();
              msDSC_On_Setting();
              #endif
 344   1      }
 345          
 346          
 347          #if 0
              //////////////////////////////////////////////////////////////////////////
              // Matrix for convert to sRGB space
              //////////////////////////////////////////////////////////////////////////
              code short tSRGB[3][3] =
              {
                  { 1096, -43, -28 }, // R  1.0694, -0.0424, -0.0270
                  { - 21,   1063, -18 }, // G -0.0204,  1.0376, -0.0172
                  { - 1,   34,   991 }  // B -0.0009,  0.0330,  0.9679
              
              };
              
              //================================================================================
              
              
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 7   

              
              
              #if MWEFunction
              void IndependentColorControl( void )
              {
                  BYTE code tColorRangeTbl[] = {0x20, 0x28, 0x20, 0x20, 0x28, 0x20, 0x19, 0x29, 0x19};
                  BYTE i, j;
              
                  BYTE code tColorControlTbl[][18] = //0x3A~0x4B
                  {
                      //  3A  3B   3C   3D   3E   3F   40   41   42   43   44   45   46   47   48   49   4A   4B
                      {0x08, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0
             -x00, 0x00}, //FullEnhanceFlag
                      {0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0
             -x00, 0x00}, //SkinFlag
                      {0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0
             -x00, 0x00}, //BlueFlag
                      {0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0
             -x00, 0x00}, //GreenFlag
                      {0x08, 0x10, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0
             -x00, 0x00} //ColorAutoDetectFlag
                  };
                  msWriteByte( BK0_00, REGBANK6 );
              
                  for( i = 0; i < 9; i++ ) //0x31~0x39
                      msWriteByte( BK6_31 + i, tColorRangeTbl[i] );
              
                  if( FullEnhanceFlag )
                      j = 0;
                  else if( SkinFlag )
                      j = 1;
                  else if( BlueFlag )
                      j = 2;
                  else if( GreenFlag )
                      j = 3;
                  else if( ColorAutoDetectFlag )
                      j = 4;
              
                  for( i = 0; i < 18; i++ ) //0x3A~0x4B
                      msWriteByte( BK6_3A + i, tColorControlTbl[j][i] );
                  if( DemoFlag )
                      msWriteByte( BK6_30, 0x07 );
                  else
                  {
                      SetBFSize( UserPrefBFSize ); //SetBFSize();
                      msWriteByte( BK6_30, 0x70 );
                  }
                  msWriteByte( BK0_00, REGBANK0 );
              }
              #if !ENABLE_HDMI
              void SetColorBoostWindow( BYTE mode )
              {
                  if( DemoFlag )
                      mode = COLORBOOST_HALF;
                  if( mode != COLORBOOST_OFF )
                  {
                      // 2006/11/10 10:43PM by KK         msAdjustSubBrightness( UserPrefSubBrightness );
                      if( DemoFlag )
                          msAdjustVideoContrast( DefContrastBase + DefContrast );
                      else
                          msAdjustVideoContrast( DefContrastBase + UserPrefContrast );
                      if( mode == COLORBOOST_HALF )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 8   

                      {
                          UserPrefBFHSize = PanelWidth / 2;
                          UserPrefBFVSize = PanelHeight;
                          UserPrefBFHStart = 0;
                          UserPrefBFVStart = 0;
                      }
                      else if( mode == COLORBOOST_FULL )
                      {
                          UserPrefBFHSize = PanelWidth;
                          UserPrefBFVSize = PanelHeight;
                          UserPrefBFHStart = 0;
                          UserPrefBFVStart = 0;
                      }
                      if( DemoFlag )
                      {
                          msAccSetup( UserPrefBFHStart, UserPrefBFHSize, UserPrefBFVStart, UserPrefBFVSize );
                          msAccOnOff( 1 );
                      }
              
                  }
                  else
                      // COLORBOOST_OFF
                  {
                      msAccOnOff( 0 );
                  }
              }
              #endif
              void SetColorEnhance( bit enable )
              {
                  BYTE *pColorTable;
                  enable = 1;
                  if( UserPrefDcrMode )
                  {
                      pColorTable = (BYTE *)t_Normal_ColorSettingTable;
                      //LoadACETable( pColorTable, DefHue, DefSaturation, 0x80 ); //  UserPrefSubContrast  );
                      LoadACETable(MAIN_WINDOW, pColorTable, DefHue, DefSaturation, 0x80 ); //  UserPrefSubContrast  );
                      msAccOnOff( 1 );
                      msDlcOnOff( 1 );
                  }
              #if 1 // wait for coding
              
              #else
                  else if( FullEnhanceFlag || SkinFlag || BlueFlag || GreenFlag || DemoFlag || ColorAutoDetectFlag )
              
                  {
              
                      if( FullEnhanceFlag || ColorAutoDetectFlag || GreenFlag || BlueFlag || SkinFlag )
                          IndependentColorControl();
                      else
                      {
                          msWriteByte( BK0_00, REGBANK6 );
                          msWriteByte( BK6_30, 0x00 );
                          msWriteByte( BK0_00, REGBANK0 );
                          //LoadACETable(pColorTable, DefHue, DefSaturation, DefContrastBase + UserPrefContrast);
                      }
                      if( GreenFlag || SkinFlag )
                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x6A );
                          msWriteByte( BK3_73, 0x6A );
                          msWriteByte( BK3_74, 0x6A );
                          msWriteByte( BK0_00, REGBANK0 );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 9   

                      }
                      else if( ColorAutoDetectFlag )
                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x60 );
                          msWriteByte( BK3_73, 0x60 );
                          msWriteByte( BK3_74, 0x60 );
                          msWriteByte( BK0_00, REGBANK0 );
                      }
                      else
                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x70 );
                          msWriteByte( BK3_73, 0x70 );
                          msWriteByte( BK3_74, 0x70 );
                          msWriteByte( BK0_00, REGBANK0 );
                      }
                  }
                  else
                  {
                      msWriteByte( BK0_00, REGBANK6 );
                      msWriteByte( BK6_30, 0x00 );
                      msWriteByte( BK0_00, REGBANK0 );
                      //LoadACETable(pColorTable, DefHue, DefSaturation, DefContrastBase + UserPrefContrast);
                  }
              #endif
              
              }
              #if ENABLE_HDMI
              void SetColorBoostWin( BYTE mode )
              {
                  if( DemoFlag )
                      mode =  COLORBOOST_HALF;
              
                  if( mode != COLORBOOST_OFF )
                  {
                      msAdjustVideoContrast( DefContrastBase + UserPrefContrast );
              
                      if( mode == COLORBOOST_HALF )
                      {
                          UserPrefBFHSize = PanelWidth / 2;
                          UserPrefBFVSize = PanelHeight;
                          UserPrefBFHStart = 0;
                          UserPrefBFVStart = 0;
                      }
                      else if( mode == COLORBOOST_FULL )
                      {
                          UserPrefBFHSize = PanelWidth ;
                          UserPrefBFVSize = PanelHeight;
                          UserPrefBFHStart = 0;
                          UserPrefBFVStart = 0;
                      }
              
              
                      if( DemoFlag )
                      {
                          msAccSetup( UserPrefBFHStart, UserPrefBFHSize, UserPrefBFVStart, UserPrefBFVSize );
                          if( gScInfo.InputColor == INPUT_RGB )
                              msAccOnOff( 1 );
                          else
                              mStar_WriteByteMask( BK0_5C, BIT3, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C ) | B
             -IT3 );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 10  

                      }
                      else
                      {
                          if( gScInfo.InputColor == INPUT_RGB )
                              msAccOnOff( 0 );
                          else
                              mStar_WriteByteMask( BK0_5C, 0x00, BIT3 );  //msWriteByte( BK0_5C, msReadByte( BK0_5C )&~B
             -IT3 );
                      }
              
                  }
                  else // COLORBOOST_OFF
                  {
                      msAccSetup( 0, 0, 0, 0 );
                      //msAccOnOff( 0 );
                  }
              
              }
              
              void SetColorMatrix( void )
              {
                  BYTE *pColorTable;
              
                  if( UserPrefDcrMode )
                  {
                      pColorTable = (BYTE *)t_Normal_ColorSettingTable;
                      //LoadACETable( pColorTable, UserPrefHue, UserPrefSaturation, 0x80 ); //  UserPrefSubContrast  );
                      LoadACETable( MAIN_WINDOW, pColorTable, UserPrefHue, UserPrefSaturation, 0x80 ); //  UserPrefSubCo
             -ntrast  );
                      //msAccOnOff( 1 );
                      //msDlcOnOff( 1 );
                  }
                  else  if( FullEnhanceFlag || SkinFlag || BlueFlag || GreenFlag || DemoFlag || ColorAutoDetectFlag )  /
             -/NormalSkin+GreenENhance+BlueEnhance
                  {
              
                      if( FullEnhanceFlag || ColorAutoDetectFlag || GreenFlag || BlueFlag || SkinFlag )
                          IndependentColorControl();
                      else
                      {
                          msWriteByte( BK0_00, REGBANK6 );
                          msWriteByte( BK6_30, 0x00 );
                          msWriteByte( BK0_00, REGBANK0 );
                          //LoadACETable(pColorTable, DefHue, DefSaturation, DefContrastBase + UserPrefContrast);
                      }
                      if( GreenFlag || SkinFlag )
                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x6A );
                          msWriteByte( BK3_73, 0x6A );
                          msWriteByte( BK3_74, 0x6A );
                          msWriteByte( BK0_00, REGBANK0 );
                      }
                      else if( ColorAutoDetectFlag )
                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x60 );
                          msWriteByte( BK3_73, 0x60 );
                          msWriteByte( BK3_74, 0x60 );
                          msWriteByte( BK0_00, REGBANK0 );
                      }
                      else
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 11  

                      {
                          msWriteByte( BK0_00, REGBANK3 );
                          msWriteByte( BK3_72, 0x70 );
                          msWriteByte( BK3_73, 0x70 );
                          msWriteByte( BK3_74, 0x70 );
                          msWriteByte( BK0_00, REGBANK0 );
                      }
                  }
                  else
                  {
                      msWriteByte( BK0_00, REGBANK6 );
                      msWriteByte( BK6_30, 0x00 );
                      msWriteByte( BK0_00, REGBANK0 );
                      //LoadACETable(pColorTable, DefHue, DefSaturation, DefContrastBase + UserPrefContrast);
                  }
              }
              
              void SetColorSpace( void )
              {
              #if ENABLE_HDMI
                  BYTE XDATA ucDomain;
              #endif
              
              #if ENABLE_HDMI
                  ucDomain = 0x00;
                  if( gScInfo.InputColor != INPUT_RGB )
                      ucDomain = 0xFF;
              #endif
              
                  if( DemoFlag || BlueFlag || SkinFlag || GreenFlag || ColorAutoDetectFlag || FullEnhanceFlag )
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                      {
                          if( DemoFlag )
                          {
                              SetMainWinVideoDomain( ucDomain );      //SetMainWinColorControl(ucDomain);
                              mStar_WriteByteMask( BK0_5C, BIT3, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C ) | B
             -IT3 );
                          }
                          else
                          {
                              mStar_WriteByteMask( BK0_02, BIT3, BIT3 ); //msWriteByte( BK0_02, msReadByte( BK0_02 ) | B
             -IT3 );
                              mStar_WriteByteMask( BK0_5C, 0x00, BIT3 );  //msWriteByte( BK0_5C, msReadByte( BK0_5C )&~B
             -IT3 );
                          }
                      }
                      else
              #endif
                          if( DemoFlag )
                              msAccOnOff( 1 );
                  }
                  else
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_5C, 0x00, BIT3 );  //msWriteByte( BK0_5C, msReadByte( BK0_5C )&~BIT3 
             -);
                      else
              #endif
                          msAccOnOff( 0 );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 12  

              #if ENABLE_HDMI
                      SetMainWinVideoDomain( 0 ); //SetMainWinColorControl(0);
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_02, BIT3, BIT3 ); //msWriteByte( BK0_02, msReadByte( BK0_02 ) | BIT3 
             -);
              #endif
                  }
              }
              #endif
              
              //================================================================================
              Bool AdjustColorBoostMode( MenuItemActionType action )
              {
                  action = 0;
                  if( !DemoFlag )
                  {
                      Clr_DemoFlag();
                  }
                  Clr_SkinFlag();
                  Clr_GreenFlag();
                  Clr_BlueFlag();
                  Clr_ColorAutoDetectFlag();
                  Clr_PictureBoostFlag();
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( FullEnhanceFlag )        // clr
                  {
                      Clr_FullEnhanceFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_OFF );
              #else
                      SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else        // set
                  {
                      Set_FullEnhanceFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_FULL );
              #else
                      SetColorBoostWindow( COLORBOOST_FULL );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 13  

                  //Benz 2007.4.24   9:50:19      Osd_Draw4Num(7,1,UserPrefColorFlags);
                  return TRUE;
              }
              
              //================================================================================
              Bool AdjustSkinProtectMode( MenuItemActionType action )
              {
                  action = action;
                  if( !DemoFlag )
                  {
                      Clr_DemoFlag();
                  }
                  Clr_GreenFlag();
                  Clr_FullEnhanceFlag();
                  Clr_BlueFlag();
                  Clr_ColorAutoDetectFlag();
                  Clr_PictureBoostFlag();
              
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( SkinFlag )
                  {
                      Clr_SkinFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_OFF );
              #else
                      SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else
                  {
                      Set_SkinFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_FULL );
              #else
                      SetColorBoostWindow( COLORBOOST_FULL );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
                  //Benz 2007.4.24   9:50:24  Osd_Draw4Num(6,1,UserPrefColorFlags);
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 14  

                  return TRUE;
              }
              Bool AdjustGreenEnhanceMode( MenuItemActionType action )
              {
                  action = action;
                  if( !DemoFlag )
                  {
                      Clr_DemoFlag();
                  }
                  Clr_SkinFlag();
                  Clr_FullEnhanceFlag();
                  Clr_BlueFlag();
                  Clr_ColorAutoDetectFlag();
                  Clr_PictureBoostFlag();
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( GreenFlag )
                  {
                      Clr_GreenFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_OFF );
              #else
                      SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else
                  {
                      Set_GreenFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_FULL );
              #else
                      SetColorBoostWindow( COLORBOOST_FULL );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
                  //Benz 2007.4.24   9:50:28      Osd_Draw4Num(5,1,UserPrefColorFlags);
                  return TRUE;
              }
              Bool AdjustBlueEnhanceMode( MenuItemActionType action )
              {
                  action = action;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 15  

                  if( !DemoFlag )
                  {
                      Clr_DemoFlag();
                  }
                  // color boost menu
                  Clr_FullEnhanceFlag();
                  Clr_GreenFlag();
                  Clr_SkinFlag();
                  Clr_ColorAutoDetectFlag();
                  // picture boost menu
                  Clr_PictureBoostFlag();
                  // DCR function
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( BlueFlag )
                  {
                      Clr_BlueFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_OFF );
              #else
                      SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else
                  {
                      Set_BlueFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_FULL );
              #else
                      SetColorBoostWindow( COLORBOOST_FULL );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
                  //Benz 2007.4.24   9:50:33      Osd_Draw4Num(4,1,UserPrefColorFlags);
                  return TRUE;
              }
              
              Bool AdjustAutoDetectMode( MenuItemActionType action )
              {
                  action = action;
                  if( !DemoFlag )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 16  

                      // when demo on, don't clear the demo flag
                  {
                      Clr_DemoFlag();
                  }
                  // color boost menu
                  Clr_FullEnhanceFlag();
                  Clr_GreenFlag();
                  Clr_BlueFlag();
                  Clr_SkinFlag();
                  // picture boost menu
                  Clr_PictureBoostFlag();
                  // DCR function
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( ColorAutoDetectFlag )
                  {
                      Clr_ColorAutoDetectFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_OFF );
              #else
                      msDlcOnOff( _DISABLE );
                      SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else
                  {
                      Set_ColorAutoDetectFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_FULL );
              #else
                      LoadDLCTable( t_MWEDLC_Linear_Table );
                      msDlcOnOff( _DISABLE );
                      SetColorBoostWindow( COLORBOOST_FULL );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
                  //Benz 2007.4.24   9:50:40      Osd_Draw4Num(3,1,UserPrefColorFlags);
                  return TRUE;
              }
              Bool AdjustDemoMode( MenuItemActionType action )
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 17  

                  action = action;
                  Clr_PictureBoostFlag();
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  UserPrefBFSize = 1;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( DemoFlag )
                  {
                      Clr_DemoFlag();
                      if( BlueFlag || SkinFlag || GreenFlag || ColorAutoDetectFlag || FullEnhanceFlag )
              #if ENABLE_HDMI
                          SetColorBoostWin( COLORBOOST_OFF );
              #else
                          SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                      else
              #if ENABLE_HDMI
                          SetColorBoostWin( COLORBOOST_OFF );
              #else
                          SetColorBoostWindow( COLORBOOST_OFF );
              #endif
                  }
                  else
                  {
                      Clr_PictureBoostFlag();
                      Set_DemoFlag();
              #if ENABLE_HDMI
                      SetColorBoostWin( COLORBOOST_HALF );
              #else
                      SetColorBoostWindow( COLORBOOST_HALF );
              #endif
                  }
              #if ENABLE_HDMI
                  SetColorMatrix();
                  SetColorSpace();
              #else
                  SetColorEnhance( 1 );
              #endif
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
              #endif
                  //Benz 2007.4.24   9:50:44      Osd_Draw4Num(2,1,UserPrefColorFlags);
                  return TRUE;
              }
              //-----------------------------------------------------
              
              #if 1  //2006-08-29 Andy
              //Bool SetBFSize(void)
              Bool SetBFSize( BYTE ucSize )
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 18  

              #if ENABLE_HDMI
                  BYTE XDATA ucDomain;
              #endif
              
              #if ENABLE_HDMI
                  ucDomain = 0x00;
                  if( gScInfo.InputColor != INPUT_RGB )
                      ucDomain = 0xFF;
              #endif
              
              #if 1
                  if( !PictureBoostFlag )
                  {
              #if !ENABLE_HDMI
                      msAccOnOff( 0 );
                      msDlcOnOff( 0 );
              #endif
                      UserPrefBFHSize = 0;
                      UserPrefBFVSize = 0;
                      UserPrefBFHStart = 0;
                      UserPrefBFVStart = 0;
                      UserPrefBFSize = ucSize = 1; //Benz 2007.4.14   14:34:23
                  }
                  else
                  {
              #if !ENABLE_HDMI
                      msAccOnOff( 1 );
              #endif
                      if( ucSize == 1 ) // H:5 V:5
                      {
                          UserPrefBFHSize = ( DISPLAY_WIDTH + 4 ) / 8; // / 5;
                          UserPrefBFVSize = PanelHeight / 8; // / 5;
                      }
                      else if( ucSize == 2 )         // H:5 V:3
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH / 5;
                          UserPrefBFVSize = PanelHeight / 5; // / 3;
                      }
                      else if( ucSize == 3 )    //  H4 V:4
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH / 4;
                          UserPrefBFVSize = PanelHeight / 4;
                      }
                      else if( ucSize == 4 )      //  H3 V:3
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH / 3;
                          UserPrefBFVSize = PanelHeight / 3;
                      }
                      else if( ucSize == 5 )       //  H2 V:2
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH / 2;
                          UserPrefBFVSize = PanelHeight / 2;
                      }
                      else if( ucSize == 6 )       //  H2 V:1
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH / 2;
                          UserPrefBFVSize = PanelHeight;
                      }
                      else if( ucSize == 7 )      //  Full
                      {
                          UserPrefBFHSize = DISPLAY_WIDTH;
                          UserPrefBFVSize = PanelHeight;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 19  

                      }
                      UserPrefBFHStart = 0;
                      UserPrefBFVStart = 0;
                      msAdjustVideoContrast( UserPrefSubContrast );
                      msAccSetup( UserPrefBFHStart + HSTART_OFFSET, UserPrefBFHSize + HSTART_OFFSET, UserPrefBFVStart, U
             -serPrefBFVSize );
              #if ENABLE_HDMI
                      msAdjustSubBrightness( UserPrefSubBrightness );
              #else
                      msAccOnOff( 1 );
              #endif
                  }
              #endif
              
              #if ENABLE_HDMI
                  if( PictureBoostFlag )
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                      {
                          SetMainWinVideoDomain( ucDomain );  //SetMainWinColorControl(ucDomain);
                          mStar_WriteByteMask( BK0_5C, BIT3, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C ) | BIT3 
             -);
                      }
                      else
              #endif
                          msAccOnOff( 1 );
                  }
                  else
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_5C, 0x00, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C )&~BIT3 )
             -;
                      else
              #endif
                          msAccOnOff( 0 );
              #if ENABLE_HDMI
                      SetMainWinVideoDomain( 0 ); //SetMainWinColorControl(0);
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_02, BIT3, BIT3 ); //msWriteByte( BK0_02, msReadByte( BK0_02 ) | BIT3 
             -);
              #endif
                  }
              #endif
                  return TRUE;
              }
              
              #if ENABLE_HDMI
              Bool AdjustBrightFrameSize( BYTE ucSize )
              {
                  if( ucSize == 1 )         // H:5 V:5
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 8; // / 5;
                      UserPrefBFVSize = PanelHeight / 8; // / 5;
                  }
                  else if( ucSize == 2 )  // H:5 V:3
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 5;
                      UserPrefBFVSize = PanelHeight / 5; // / 3;
                  }
                  else if( ucSize == 3 )  //  H4 V:4
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 20  

                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 4;
                      UserPrefBFVSize = PanelHeight / 4;
                  }
                  else if( ucSize == 4 )  //  H3 V:3
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 3;
                      UserPrefBFVSize = PanelHeight / 3;
                  }
                  else if( ucSize == 5 )  //  H2 V:2
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 2;
                      UserPrefBFVSize = PanelHeight / 2;
                  }
                  else if( ucSize == 6 )  //  H2 V:1
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH / 2;
                      UserPrefBFVSize = PanelHeight;
                  }
                  else if( ucSize == 7 )  //  Full
                  {
                      UserPrefBFHSize = DISPLAY_WIDTH;
                      UserPrefBFVSize = PanelHeight;
                  }
              
                  UserPrefBFHStart = 0;
                  UserPrefBFVStart = 0;
                  //msAdjustVideoContrast( UserPrefSubContrast );
                  msAccSetup( UserPrefBFHStart + HSTART_OFFSET, UserPrefBFHSize + HSTART_OFFSET, UserPrefBFVStart, UserP
             -refBFVSize );
                  //msAccOnOff( 1 );
              
                  return TRUE;
              }
              #endif
              //---------------------------------------------------------------
              Bool AdjustBFSize( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefBFSize, 1, 7, 1 );
                  if( tempValue == UserPrefBFSize )
                  {
                      return FALSE;
                  }
                  UserPrefBFSize = tempValue;
                  //printData("UserPrefBFSize=%d",UserPrefBFSize);
              #if ENABLE_HDMI
                  AdjustBrightFrameSize( UserPrefBFSize ); //
              #else
                  SetBFSize( UserPrefBFSize ); //SetBFSize();
              #endif
                  return TRUE;
              }
              WORD GetBFSizeValue( void )
              {
                  return GetScale100Value( UserPrefBFSize, 0, 7 );
              }
              
              //---------------------------------------------------------------
              Bool AdjustBFHstart( MenuItemActionType action )
              {
                  WORD tempValue;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 21  

                  if( UserPrefBFSize == 1 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFHStart, 0, 7, 1 );
                  }
                  else if( UserPrefBFSize == 2 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFHStart, 0, 4, 1 );
                  }
                  else if( UserPrefBFSize == 3 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFHStart, 0, 3, 1 );
                  }
                  else if( UserPrefBFSize == 4 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFHStart, 0, 2, 1 );
                  }
                  else if( UserPrefBFSize == 5 || UserPrefBFSize == 6 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFHStart, 0, 1, 1 );
                  }
                  else
                  {
                      tempValue = UserPrefHStart;
                  }
                  if( tempValue == UserPrefHStart )
                  {
                      return FALSE;
                  }
                  //printData("tempValue11=%d",tempValue);
              
                  UserPrefBFHStart = tempValue;
                  tempValue = UserPrefBFHStart * UserPrefBFHSize;
                  msAccSetup( tempValue + HStartOffset, ( UserPrefBFHSize + tempValue ) + HStartOffset, UserPrefBFVStart
             - * UserPrefBFVSize, ( UserPrefBFVStart * UserPrefBFVSize + UserPrefBFVSize ) );
                  return TRUE;
              }
              
              WORD GetBFHstartValue( void )
              {
                  if( UserPrefBFSize == 2 )
                  {
                      return GetScale100Value( UserPrefBFHStart, 0, 4 );
                  }
                  else if( UserPrefBFSize == 3 )
                  {
                      return GetScale100Value( UserPrefBFHStart, 0, 3 );
                  }
                  else if( UserPrefBFSize == 4 )
                  {
                      return GetScale100Value( UserPrefBFHStart, 0, 2 );
                  }
                  else if( UserPrefBFSize == 5 || UserPrefBFSize == 6 )
                  {
                      return GetScale100Value( UserPrefBFHStart, 0, 1 );
                  }
                  else if( UserPrefBFSize == 1 )
                  {
                      return GetScale100Value( UserPrefBFHStart, 0, 7 );
                  }
                  else
                  {
                      return 0;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 22  

                  }
              }
              //---------------------------------------------------------------
              Bool AdjustBFVstart( MenuItemActionType action )
              {
                  WORD tempValue;
                  if( UserPrefBFSize == 6 || UserPrefBFSize == 7 )
                  {
                      tempValue = 0;
                  }
                  else if( UserPrefBFSize == 1 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFVStart, 0, 7, 1 );
                  }
                  else if( UserPrefBFSize == 2 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFVStart, 0, 4, 1 );
                  }
                  else if( UserPrefBFSize == 4 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFVStart, 0, 2, 1 );
                  }
                  else if( UserPrefBFSize == 3 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFVStart, 0, 3, 1 );
                  }
                  else if( UserPrefBFSize == 5 )
                  {
                      tempValue = DecIncValue( action, UserPrefBFVStart, 0, 1, 1 );
                  }
                  /*
                  if ( tempValue == UserPrefVStart )
                  {
                  return FALSE;
                  }
                   */
                  UserPrefBFVStart = tempValue;
                  tempValue = UserPrefBFVStart * UserPrefBFVSize;
                  msAccSetup( UserPrefBFHStart * UserPrefBFHSize + HStartOffset, UserPrefBFHStart * UserPrefBFHSize + Us
             -erPrefBFHSize + HStartOffset, tempValue, ( tempValue + UserPrefBFVSize ) );
                  return TRUE;
              }
              WORD GetBFVstartValue( void )
              {
                  if( UserPrefBFSize == 1 )
                  {
                      return GetScale100Value( UserPrefBFVStart, 0, 7 );
                  }
                  else if( UserPrefBFSize == 2 )
                  {
                      return GetScale100Value( UserPrefBFVStart, 0, 4 );
                  }
                  else if( UserPrefBFSize == 4 )
                  {
                      return GetScale100Value( UserPrefBFVStart, 0, 2 );
                  }
                  else if( UserPrefBFSize == 3 )
                  {
                      return GetScale100Value( UserPrefBFVStart, 0, 3 );
                  }
                  else if( UserPrefBFSize == 5 )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 23  

                      return GetScale100Value( UserPrefBFVStart, 0, 1 );
                  }
                  else
                  {
                      return 0;
                  }
              }
              //================================================================================
              Bool AdjustBF_Switch( MenuItemActionType action )
              {
                  action = action;
                  Clr_ColorAutoDetectFlag();
                  Clr_FullEnhanceFlag();
                  Clr_GreenFlag();
                  Clr_BlueFlag();
                  Clr_SkinFlag();
                  Clr_DemoFlag();
                  //if (UserPrefDcrMode)
                  //SetECO();
                  UserPrefDcrMode = 0;
              #if 0//Enable_Lightsensor
                  UserPrefiCareMode = LightSensorOff;
              #endif
                  UserPrefECOMode = ECO_Standard;
                  SetECO();
              
              #if ENABLE_HDMI
                  msDlcOnOff( _DISABLE );
              #endif
              
                  if( PictureBoostFlag )
                  {
                      Clr_PictureBoostFlag();
              #if ENABLE_HDMI
                      UserPrefBFSize = 1 ;    // recall default setting=> BFSize=1, position(0,0)
              #endif
                      SetBFSize( UserPrefBFSize ); //SetBFSize();
                  }
                  else
                  {
              #if !ENABLE_HDMI
                      //msAdjustSubBrightness( UserPrefSubBrightness );
                      //LoadACETable( t_Normal_ColorSettingTable, UserPrefHue, UserPrefSaturation, UserPrefSubContrast )
             -;
                      msAdjustSubBrightness( MAIN_WINDOW, UserPrefSubBrightness, UserPrefSubBrightness, UserPrefSubBrigh
             -tness );
                      LoadACETable( MAIN_WINDOW, (BYTE *)t_Normal_ColorSettingTable, UserPrefHue, UserPrefSaturation, Us
             -erPrefSubContrast );
              #endif
                      Set_PictureBoostFlag();
              #if !ENABLE_HDMI
                      UserPrefBFSize = 1; // recall default setting=> BFSize=1, position(0,0)
              #endif
                      SetBFSize( UserPrefBFSize ); //SetBFSize();
              #if !ENABLE_HDMI
                      SetColorEnhance( 1 );
              #endif
                  }
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #else
                  UserPref_EnableFlashSaveBit( bFlashSaveMonitorBit );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 24  

              #endif
                  //Benz 2007.4.24   9:50:48  Osd_Draw4Num(1,1,UserPrefColorFlags);
                  return TRUE;
              }
              //================================================================================
              Bool AdjustSubContrast( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefSubContrast, MinSubContrast, MaxSubContrast, 2 );
                  if( tempValue == UserPrefSubContrast )
                  {
                      return FALSE;
                  }
                  UserPrefSubContrast = tempValue;
                  msAdjustVideoContrast( UserPrefSubContrast );
                  //NVRam_WriteByte( nvrMonitorAddr( SubContrast ), UserPrefSubContrast);
                  return TRUE;
              }
              WORD GetSubContrast100Value( void )
              {
                  return GetScale100Value( UserPrefSubContrast, MinSubContrast, MaxSubContrast );
              }
              //================================================================================
              Bool AdjustSubBrightness( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefSubBrightness, MinSubBrightness, MaxSubBrightness, 2 );
                  if( tempValue == UserPrefSubBrightness )
                  {
                      return FALSE;
                  }
                  UserPrefSubBrightness = tempValue;
                  msAdjustSubBrightness( UserPrefSubBrightness );
                  return TRUE;
              }
              WORD GetSubBrightness100Value( void )
              {
                  return GetScale100Value( UserPrefSubBrightness, MinSubBrightness, MaxSubBrightness );
              }
              #endif
              #endif
              //-----------------------------------------------------
              
              //extern void DPRxDCHPD( Bool enable );
              
              
              
              //================================================================================
              //================================================================================
              //================================================================================
              
              //=============================================================================
              
              //====================================================
              
              //=====================================================
              
              //================================================================================
              
              //================================================================================
              
              //====================================================
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 25  

              
              
              
              
              Bool SetColorFormat(void)
              {
                  if (UserPrefInputColorFormat == MenuItemIndex)
                      return FALSE;
                  UserPrefInputColorFormat = MenuItemIndex;
                  SetInputColorFormat();
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              
              //====================================================
              
              //Bool AdjustLanguage( MenuItemActionType action )
              
              
              
              
              #if 1
              /*
              Bool ResetBriConValue(void)
              {
              UserPrefBrightness=UserPrefBrightness6500K;
              UserPrefContrast=UserPrefContrast6500K;
              mStar_AdjustBrightness(UserPrefBrightness);
              mStar_AdjustContrast(UserPrefContrast);
              SaveMonitorSetting();
              return TRUE;
              }
               */
              
              #endif
              /*void SaveUserPref(void)
              {
                  // 2006/10/24 7:5PM by Emily      printData("SaveUserPref", 0);
                  SaveMonitorSetting();
                  if (SrcInputType < Input_Digital)
                  {
                      SaveModeSetting();
                  }
              }*/
              
              #if !USEFLASH
              void SaveFactorySettingByItem( BYTE itemIndex )
              {
                  if( itemIndex == 2 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( AdcRedGain ), UserPrefAdcRedGain );
                  }
                  else if( itemIndex == 4 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( AdcGreenGain ), UserPrefAdcGreenGain );
                  }
                  else if( itemIndex == 6 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( AdcBlueGain ), UserPrefAdcBlueGain );
                  }
                  else if( itemIndex == 8 )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 26  

                      NVRam_WriteByte( nvrFactoryAddr( AdcRedOffset ), UserPrefAdcRedOffset );
                  }
                  else if( itemIndex == 10 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( AdcGreenOffset ), UserPrefAdcGreenOffset );
                  }
                  else if( itemIndex == 12 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( AdcBlueOffset ), UserPrefAdcBlueOffset );
                  }
                  else if( itemIndex == 14 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( RedColorCool1 ), UserPrefRedColorCool1 );
                  }
                  else if( itemIndex == 16 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( GreenColorCool1 ), UserPrefGreenColorCool1 );
                  }
                  else if( itemIndex == 18 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( BlueColorCool1 ), UserPrefBlueColorCool1 );
                  }
                  else if( itemIndex == 20 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FBrightnessCool1 ), FUserPrefBrightnessCool1 );
                  }
                  else if( itemIndex == 22 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FContrastCool1 ), FUserPrefContrastCool1 );
                  }
                  else if( itemIndex == 24 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( RedColorNormal ), UserPrefRedColorNormal );
                  }
                  else if( itemIndex == 26 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( GreenColorNormal ), UserPrefGreenColorNormal );
                  }
                  else if( itemIndex == 28 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( BlueColorNormal ), UserPrefBlueColorNormal );
                  }
                  else if( itemIndex == 30 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FBrightnessNormal ), FUserPrefBrightnessNormal );
                  }
                  else if( itemIndex == 32 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FContrastNormal ), FUserPrefContrastNormal );
                  }
                  else if( itemIndex == 34 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( RedColorWarm1 ), UserPrefRedColorWarm1 );
                  }
                  else if( itemIndex == 36 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( GreenColorWarm1 ), UserPrefGreenColorWarm1 );
                  }
                  else if( itemIndex == 38 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( BlueColorWarm1 ), UserPrefBlueColorWarm1 );
                  }
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 27  

                  else if( itemIndex == 40 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FBrightnessWarm1 ), FUserPrefBrightnessWarm1 );
                  }
                  else if( itemIndex == 42 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FContrastWarm1 ), FUserPrefContrastWarm1 );
                  }
                  else if( itemIndex == 44 )
                      NVRam_WriteByte( nvrFactoryAddr( RedColorsRGB ), UserPrefRedColorSRGB );
                  else if( itemIndex == 46 )
                      NVRam_WriteByte( nvrFactoryAddr( GreenColorsRGB ), UserPrefGreenColorSRGB );
                  else if( itemIndex == 48 )
                      NVRam_WriteByte( nvrFactoryAddr( BlueColorsRGB ), UserPrefBlueColorSRGB );
                  else if( itemIndex == 50 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FBrightnesssRGB ), FUserPrefBrightnessSRGB );
                  }
                  else if( itemIndex == 52 )
                  {
                      NVRam_WriteByte( nvrFactoryAddr( FContrastsRGB ), FUserPrefContrastSRGB );
                  }
                  //else if (itemIndex == 54)
                  //{
                  //    NVRam_WriteByte(nvrMonitorAddr(MonitorFlag), MonitorFlags);
                  //}
              }
              #endif
              
              //=======================================================================================
              // For Factory alignment
              #if 1
              
              #if !USEFLASH
              Bool EraseAllEEPROMCell( void )
              {
                  if( UserPrefBrightness == 0 && UserPrefContrast == MinContrastValue )
                  {
                      WORD  i;
              #ifdef EEPRom_24C04
                      for( i = 0; i < 0x1ff; i++ )
              #else
                      for( i = 0; i < 0x7ff; i++ )
              #endif
                          NVRam_WriteByte( i, 0xFF );
                      Power_TurnOnAmberLed();
                  }
                  return TRUE;
              }
              #else
              Bool EraseFlashUserData(void) //2011.9.13 14:54 CC - A022
              {
              
                  if( UserPrefBrightness != 0|| UserPrefContrast!= MinContrastValue )
                  {   //printMsg("EraseFlashUserData(1)");
                      Delay1ms( 200 ); // for Factory check delay,It's can reduce
                      return FALSE;
                  }
              
                  if( UserPrefBrightness == 0 && UserPrefContrast == MinContrastValue )
                  {   //printMsg("EraseFlashUserData(2)");
                      FlashSectorErase( TRUE, FLASH_FactorySettingAddr );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 28  

                      FlashSectorErase( TRUE, FLASH_MonitorSettingAddr );
                      FlashSectorErase( TRUE, FLASH_MonitorSetting2Addr );
                      FlashSectorErase( TRUE, FLASH_TimingModeAddr );
                      FlashSectorErase( TRUE, FLASH_FreeBufferAddr);
                      Power_TurnOnAmberLed();
                      Delay1ms( 1000 );
                  }
              
                  return TRUE;
              }
              #endif
              #if 1
              //====================================================
              
              #endif
              
              
              
              #if Enable_Gamma
              Bool AdjustGamaMode( MenuItemActionType action )
              {
                  //if (UserPrefColorTemp==CTEMP_SRGB)  //0617
                  //  return FALSE;
                  if( action == MIA_DecValue )
                  {
                      UserPrefGamaMode = ( UserPrefGamaMode + GAMA_Nums - 1 ) % GAMA_Nums;
                  }
                  else
                  {
                      UserPrefGamaMode = ( UserPrefGamaMode + 1 ) % GAMA_Nums;
                  }
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( GamaMode ), UserPrefGamaMode );
              #else
                  //SaveMonitorSetting();
                  Set_FlashSaveMonitorFlag();
              #endif
              
                  // 2006/11/9 11:44PM by Emily     if(!BlueFlag||!SkinFlag||!GreenFlag||!ColorAutoDetectFlag)
                  {
                      //msWriteByte( BK0_00, REGBANK3 );
                     // msWriteByte( BK3_40, 0x00 );
                     // msWriteByte( BK0_00, REGBANK0 );
                      mStar_SetupGamma( UserPrefGamaMode );
              #if MWEFunction
                      if( UserPrefColorFlags != 0 || UserPrefDcrMode )
              #else
                      if( UserPrefDcrMode )
              #endif
                      {
              #if !ENABLE_HDMI
                          msAccOnOff( 1 );
              #endif
                         // msWriteByte( BK0_00, REGBANK3 );
                         // msWriteByte( BK3_40, 0x01 );
                         // msWriteByte( BK0_00, REGBANK0 );
                      }
                  }
                  return TRUE;
              }
              #endif
              
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 29  

              
              Bool SetDCRmode(void)
              {
                  if (UserPrefDcrMode == MenuItemIndex)
                      return FALSE;
                  UserPrefDcrMode = MenuItemIndex;
                  //printData("========UserprefDSCMode====%x",UserPrefDcrMode);
              
                  msDCROnOff(UserPrefDcrMode, MAIN_WINDOW);
              
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              
              #if ENABLE_DSC
              Bool AdjustDSCMode( MenuItemActionType action )
              {
                  action=action;
              
                  if( UserprefDSCMode )
                  {
                      UserprefDSCMode = 0;
                      msDSC_Off_Setting();
                  }
                  else
                  {
                      UserprefDSCMode = 1;
                      msDSC_On_Setting();
                  }
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( DSCMode ), UserprefDSCMode );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
                  return TRUE;
              }
              Bool SetDSCmode(void)
              {
                  if (UserprefDSCMode == MenuItemIndex)
                      return FALSE;
                  UserprefDSCMode = MenuItemIndex;
                  //printData("========UserprefDSCMode====%x",UserprefDSCMode);
                  if( UserprefDSCMode )
                  {
                      msDSC_On_Setting();
                  }
                  else
                  {
                      msDSC_Off_Setting();
                  }
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              #endif
              #if ENABLE_DPS
              Bool AdjustDPSMode( MenuItemActionType action )
              {
                  action=action;
              
                  if( UserprefDPSMode )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 30  

                      UserprefDPSMode = 0;
                      msDPS_Off_Setting();
                  }
                  else
                  {
                      UserprefDPSMode = 1;
                      msDPS_On_Setting();
                  }
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( DPSMode ), UserprefDPSMode );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
                  return TRUE;
              }
              Bool SetDPSmode(void)
              {
                  if (UserprefDPSMode == MenuItemIndex)
                      return FALSE;
                  UserprefDPSMode = MenuItemIndex;
                  //printData("========UserprefDPSMod====%x",UserprefDPSMode);
                  if( UserprefDPSMode )
                  {
                      msDPS_On_Setting();
                  }
                  else
                  {
                      msDPS_Off_Setting();
                  }
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              #endif
              #if ENABLE_DLC
              Bool AdjustDLCMode( MenuItemActionType action )
              {
                  action=action;
              
                  if( UserprefDLCMode )
                  {
                      UserprefDLCMode = 0;
                      g_bDLCOnOff=0;
              
                      msDlcOnOff(1);
                  }
                  else
                  {
                      UserprefDLCMode = 1;
                      g_bDLCOnOff=0;
                      msDlcOnOff(0);
                  }
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( DLCMode ), UserprefDLCMode );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
                  return TRUE;
              }
              Bool SetDLCmode(void)
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 31  

                  if (UserprefDLCMode == MenuItemIndex)
                      return FALSE;
                  UserprefDLCMode = MenuItemIndex;
                  //printData("========UserprefDLCMode====%x",UserprefDLCMode);
                  if( UserprefDLCMode )
                  {
                      g_bDLCOnOff=0;
                      msDlcOnOff(1);
                  }
                  else
                  {
                      //UserprefDLCMode = 1;
                      g_bDLCOnOff=0;
                      msDlcOnOff(0);
                  }
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              #endif
              
              #if ENABLE_3DLUT
              Bool Adjust3DLUTMode( MenuItemActionType action )
              {
                  action=action;
              
                  UserPref3DLUTmode=MenuItemIndex;
                  ms3DLutEnable(MAIN_WINDOW, UserPref3DLUTmode);
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( RGB3DLUTMode ), UserPref3DLUTmode );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
                  return TRUE;
              }
              #endif
              
              #if ENABLE_OSD_3D_CONTROL
              Bool AdjustT3DMode( MenuItemActionType action )
              {
                  action=action;
              
                  if( UserPref2Dto3D )
                  {
                      UserPref2Dto3D = 0;
                      g_SetupPathInfo.b2DTo3DEnable = FALSE;
                      mStar_SetupMode();
                      Sc2DTo3DOff();
                  }
                  else
                  {
                      UserPref2Dto3D = 1;
                      g_SetupPathInfo.b2DTo3DEnable = TRUE;
                      mStar_SetupMode();
              /*
                      if (InputColorFormat == INPUTCOLOR_YUV)
                          LoadACETable( MAIN_WINDOW, (BYTE *)t_Off_ColorSettingTable, DefHue, DefSaturation, UserPrefCon
             -trast);
                      else if (InputColorFormat == InputColor_RGB)
                          LGE_T3D_Photo_2_ColorMatrix();
              */
                      Sc2DTo3DInit();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 32  

                  }
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( T3DMode ), UserPref2Dto3D );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
                  return TRUE;
              }
              
              Bool AdjustT3DGameMode( MenuItemActionType action )
              {
                  action=action;
              
                  if ( UserPref2Dto3DGameMode )
                  {
                      UserPref2Dto3DGameMode = 0;
                      msWrite2Byte(REG_2102, 0x0000);
                      MenuFunc_printMsg("Exit 2D to 3D Game Mode");
                  }
                  else
                  {
                      UserPref2Dto3DGameMode = 1;
                      msWrite2Byte(REG_2102, 0x1111);
                      MenuFunc_printMsg("Enter 2D to 3D Game Mode");
                  }
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( T3DGameMode ), UserPref2Dto3DGameMode );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
              
                  return TRUE;
              }
              
              Bool AdjustT3DGain( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPref2Dto3DGain, 0, MAX_T3DGAIN, 1 );
                  if( tempValue == UserPref2Dto3DGain )
                  {
                      return FALSE;
                  }
                  UserPref2Dto3DGain = tempValue;
              
                  Sc2DTo3DSetPIXGain(t2Dto3DPIXGain[UserPref2Dto3DGain]);
                  Sc2DTo3DSetBLKGain(t2Dto3DBLKGain[UserPref2Dto3DGain]);
              
                  return TRUE;
              }
              
              WORD GetT3DGainValue( void )
              {
                      return GetScale100Value(UserPref2Dto3DGain,0,MAX_T3DGAIN);
              }
              
              Bool AdjustT3DOffset( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPref2Dto3DOffset, 0, MAX_T3DOFFSET, 1 );
                  if( tempValue == UserPref2Dto3DOffset )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 33  

                  {
                      return FALSE;
                  }
                  UserPref2Dto3DOffset = tempValue;
              
                  Sc2DTo3DSetPIXOffset(t2Dto3DPIXOffset[UserPref2Dto3DOffset]);
                  Sc2DTo3DSetBLKOffset(t2Dto3DBLKOffset[UserPref2Dto3DOffset]);
              
                  return TRUE;
              }
              
              WORD GetT3DOffsetValue( void )
              {
                  return GetScale100Value(UserPref2Dto3DOffset,0,MAX_T3DOFFSET);
              }
              #endif
              #if ENABLE_SUPER_RESOLUTION
              Bool AdjustSuperResolutionMode( MenuItemActionType action )
              {
                  if( action == MIA_DecValue )
                  {
                      UserPrefSuperResolutionMode = ( UserPrefSuperResolutionMode + SRMODE_Nums - 1 ) % SRMODE_Nums;
                  }
                  else
                  {
                      UserPrefSuperResolutionMode = ( UserPrefSuperResolutionMode + 1 ) % SRMODE_Nums;
                  }
              
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( SuperResolutionMode ), UserPrefSuperResolutionMode );
              #else
                  Set_FlashSaveMonitorFlag();
              #endif
                  mStar_SetupSuperResolution( UserPrefSuperResolutionMode );
                  return TRUE;
              }
              Bool SetSuperResolutionMode(void)
              {
                  if (UserPrefSuperResolutionMode== MenuItemIndex)
                      return FALSE;
                  UserPrefSuperResolutionMode = MenuItemIndex;
                  mStar_SetupSuperResolution( UserPrefSuperResolutionMode );
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              #endif
              #if ENABLE_TNR
              Bool AdjustNRMode( MenuItemActionType action )
              {
                  if( action == MIA_DecValue )
                  {
                      UserPrefNRmode = ( UserPrefNRmode + NRMODE_Nums - 1 ) % NRMODE_Nums;
                  }
                  else
                  {
                      UserPrefNRmode = ( UserPrefNRmode + 1 ) % NRMODE_Nums;
                  }
              
              #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( NRmode ), UserPrefNRmode );
              #else
                  Set_FlashSaveMonitorFlag();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 34  

              #endif
                  mStar_SetupNRmode( UserPrefNRmode );
                  return TRUE;
              }
              #endif
              
              #if ENABLE_DeBlocking
              Bool AdjustDeBlockingMode( MenuItemActionType action )
              {
                  action=action;
              
                  // temp, TNR always on/off with deblocking function.
                  AdjustTNR(0);
              
                  if( UserPrefDeBlocking)
                      UserPrefDeBlocking = 0;
                  else
                      UserPrefDeBlocking = 1;
              
                  #if !USEFLASH
                      NVRam_WriteByte( nvrMonitorAddr( DeBlocking ), UserPrefDeBlocking );
                  #else
                      Set_FlashSaveMonitorFlag();
                  #endif
              
                  msDeBlockingOnOff(UserPrefDeBlocking, MAIN_WINDOW);
              
                  return TRUE;
              }
              #endif
              
              //=====================================================================
              #if 1
              
              Bool SetFactoryColorTempSRGB( void )
              {
                  UserPrefColorTemp = CTEMP_SRGB;
                  ReadColorTempSetting(); // 2006/11/10 6:58PM by KK ReadSRGBSetting();
                  //mStar_AdjustBrightness( UserPrefBrightness );
                  //mStar_AdjustContrast( UserPrefContrast );
                  return TRUE;
              }
              
              #endif
              #if 1
              
              //====================================================
              
              Bool AdjustBrightnessCool1( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefBrightnessCool1, 0, 100, 1 );
                  if( tempValue == UserPrefBrightnessCool1 )
                  {
                      return FALSE;
                  }
                  UserPrefBrightnessCool1 = tempValue;
                  UserPrefBrightness = UserPrefBrightnessCool1;
                  if( FactoryModeFlag )
                      FUserPrefBrightnessCool1 = UserPrefBrightnessCool1;
                  mStar_AdjustBrightness( UserPrefBrightnessCool1 );
                  return TRUE;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 35  

              }
              Bool AdjustContrastCool1( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefContrastCool1, MinContrastValue, MaxContrastValue, 1 );
                  if( tempValue == UserPrefContrastCool1 )
                  {
                      return FALSE;
                  }
                  UserPrefContrastCool1 = tempValue;
                  UserPrefContrast = UserPrefContrastCool1;
                  if( FactoryModeFlag )
                      FUserPrefContrastCool1 = UserPrefContrastCool1;
                  mStar_AdjustContrast( UserPrefContrast );
                  return TRUE;
              }
              
              WORD GetBrightnessCool1Value( void )
              {
                  return FUserPrefBrightnessCool1 % 101;
              }
              WORD GetContrastCool1Value( void ) // WMZ 050819
              {
                  WORD temp;
                  temp = GetScale100Value( FUserPrefContrastCool1, MinContrastValue, MaxContrastValue );
                  return temp;
              }
              //====================================================
              
              Bool AdjustBrightnessWarm1( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefBrightnessWarm1, 0, 100, 1 );
                  if( tempValue == UserPrefBrightnessWarm1 )
                  {
                      return FALSE;
                  }
                  UserPrefBrightnessWarm1 = tempValue;
                  UserPrefBrightness = UserPrefBrightnessWarm1;
                  if( FactoryModeFlag )
                      FUserPrefBrightnessWarm1 = UserPrefBrightnessWarm1;
                  mStar_AdjustBrightness( UserPrefBrightnessWarm1 );
                  return TRUE;
              }
              Bool AdjustContrastWarm1( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefContrastWarm1, MinContrastValue, MaxContrastValue, 1 );
                  if( tempValue == UserPrefContrastWarm1 )
                  {
                      return FALSE;
                  }
                  UserPrefContrastWarm1 = tempValue;
                  UserPrefContrast = UserPrefContrastWarm1;
                  if( FactoryModeFlag )
                      FUserPrefContrastWarm1 = UserPrefContrastWarm1;
                  mStar_AdjustContrast( UserPrefContrast );
                  return TRUE;
              }
              
              WORD GetBrightnessWarm1Value( void )
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 36  

                  return FUserPrefBrightnessWarm1 % 101;
              }
              WORD GetContrastWarm1Value( void ) // WMZ 050819
              {
                  WORD temp;
                  temp = GetScale100Value( FUserPrefContrastWarm1, MinContrastValue, MaxContrastValue );
                  return temp;
              }
              //===============================================================
              
              Bool AdjustBrightnessNormal( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefBrightnessNormal, 0, 100, 1 );
                  if( tempValue == UserPrefBrightnessNormal )
                  {
                      return FALSE;
                  }
                  UserPrefBrightnessNormal = tempValue;
                  UserPrefBrightness = UserPrefBrightnessNormal;
                  if( FactoryModeFlag )
                      FUserPrefBrightnessNormal = UserPrefBrightnessNormal;
                  mStar_AdjustBrightness( UserPrefBrightnessNormal );
                  return TRUE;
              }
              Bool AdjustContrastNormal( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefContrastNormal, MinContrastValue, MaxContrastValue, 1 );
                  if( tempValue == UserPrefContrastNormal )
                  {
                      return FALSE;
                  }
                  UserPrefContrastNormal = tempValue;
                  UserPrefContrast = UserPrefContrastNormal;
                  if( FactoryModeFlag )
                      FUserPrefContrastNormal = UserPrefContrastNormal;
                  mStar_AdjustContrast( UserPrefContrast );
                  return TRUE;
              }
              
              WORD GetBrightnessNormalValue( void )
              {
                  //   return FUserPrefBrightnessNormal % 101;
                  return FUserPrefBrightnessNormal % 101;
              }
              WORD GetContrastNormalValue( void ) // WMZ 050819
              {
                  WORD temp;
                  temp = GetScale100Value( FUserPrefContrastNormal, MinContrastValue, MaxContrastValue );
                  return temp;
              }
              //====================================================
              Bool AdjustRedColorSRGB( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefRedColorSRGB, MinColorValue, MaxColorValue, 1 );
                  if( tempValue == UserPrefRedColorSRGB )
                  {
                      return FALSE;
                  }
                  UserPrefRedColorSRGB = tempValue;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 37  

              #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
                  mStar_AdjustRedColor( UserPrefRedColorSRGB, UserPrefContrastSRGB );
              #endif
                  return TRUE;
              }
              Bool AdjustGreenColorSRGB( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefGreenColorSRGB, MinColorValue, MaxColorValue, 1 );
                  if( tempValue == UserPrefGreenColorSRGB )
                  {
                      return FALSE;
                  }
                  UserPrefGreenColorSRGB = tempValue;
              #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
                  mStar_AdjustGreenColor( UserPrefGreenColorSRGB, UserPrefContrastSRGB );
              #endif
                  return TRUE;
              }
              Bool AdjustBlueColorSRGB( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefBlueColorSRGB, MinColorValue, MaxColorValue, 1 );
                  if( tempValue == UserPrefBlueColorSRGB )
                  {
                      return FALSE;
                  }
                  UserPrefBlueColorSRGB = tempValue;
              #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
                  mStar_AdjustBlueColor( UserPrefBlueColorSRGB, UserPrefContrastSRGB );
              #endif
                  return TRUE;
              }
              Bool AdjustBrightnessSRGB( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, FUserPrefBrightnessSRGB, 0, 100, 1 );
                  if( tempValue == FUserPrefBrightnessSRGB )
                  {
                      return FALSE;
                  }
                  FUserPrefBrightnessSRGB = tempValue;
                  UserPrefBrightness = FUserPrefBrightnessSRGB;
                  mStar_AdjustBrightness( UserPrefBrightness );
                  return TRUE;
              }
              Bool AdjustContrastSRGB( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, FUserPrefContrastSRGB, MinContrastValue, MaxContrastValue, 1 );
                  if( tempValue == FUserPrefContrastSRGB )
                  {
                      return FALSE;
                  }
                  FUserPrefContrastSRGB = tempValue;
                  UserPrefContrast = FUserPrefContrastSRGB;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 38  

                  mStar_AdjustContrast( UserPrefContrast );
                  return TRUE;
              }
              WORD GetRColorSRGBValue( void )
              {
                  return UserPrefRedColorSRGB;
              }
              WORD GetGColorSRGBValue( void )
              {
                  return UserPrefGreenColorSRGB;
              }
              WORD GetBColorSRGBValue( void )
              {
                  return UserPrefBlueColorSRGB;
              }
              WORD GetBrightnessSRGBValue( void )
              {
                  return FUserPrefBrightnessSRGB % 101;
              }
              WORD GetContrastSRGBValue( void ) // WMZ 050819
              {
                  WORD temp;
                  temp = GetScale100Value( FUserPrefContrastSRGB, MinContrastValue, MaxContrastValue );
                  return temp;
              }
              #endif
              //======================================================================================
              
              
              
              //====================================================
              WORD GetProductionValue( void )
              {
                  return ( ProductModeFlag) ? ( 1 ) : ( 0 );
              }
              Bool AdjustProduction( MenuItemActionType action )
              {
                  action = action;
                  if( UserPrefBrightness == 0 && UserPrefContrast == MinContrastValue )
                  {
                      if( ProductModeFlag )
                      {
                          #if USEFLASH
                          FactoryProductModeValue = ProductModeOffValue;
                          #else
                          WORD u16TempValue = ProductModeOffValue;
                          NVRam_WriteTbl( ProductModeAddr, ( BYTE* )( &u16TempValue ), 2 );
                          #endif
                          Clr_ProductModeFlag();
                      }
                      else
                      {
                          #if USEFLASH
                          FactoryProductModeValue = ProductModeOnValue;
                          #else
                          WORD u16TempValue = ProductModeOnValue;
                          NVRam_WriteTbl( ProductModeAddr, ( BYTE* )( &u16TempValue ), 2 );
                          #endif
                          Set_ProductModeFlag();
                      }
                      #if USEFLASH
                      //SaveMonitorSetting();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 39  

                      Set_FlashForceSaveMonitor2Flag();
                      #else
                      NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), System2Flags );
                      #endif
                      Delay1ms( 200 );
                   }
                  return TRUE;
              }
              
              WORD GetDDCWPActiveValue( void )
              {
                  return (( DDCWPActiveFlag) ? ( 1 ) : ( 0 ));
              }
              Bool AdjustDDCWP( MenuItemActionType action )
              {
                  action = action;
                  if( DDCWPActiveFlag )
                  {
                      g_bServiceEDIDUnLock = 1;
                      hw_ClrDDC_WP();
                  }
                  else
                  {
                     g_bServiceEDIDUnLock = 0;
                     hw_SetDDC_WP();
                  }
                  Delay1ms( 200 );
                  return TRUE;
              }
              //====================================================
              Bool AdjustBankNo( MenuItemActionType action )
              {
                  if( action == MIA_IncValue )
                  {
                      MSBankNo = ( MSBankNo + 1 ) % 3;
                  }
                  else
                  {
                      MSBankNo = ( MSBankNo + 2 ) % 3;
                  }
                  return TRUE;
              }
              Bool AdjustAddr( MenuItemActionType action )
              {
                  if( action == MIA_IncValue )
                  {
                      MSAddr = ( MSAddr + 1 ) % 0x100;
                  }
                  else
                  {
                      MSAddr = ( MSAddr + 255 ) % 0x100;
                  }
                  return TRUE;
              }
              WORD GetAddrValue( void )
              {
                  return MSAddr;
              }
              Bool AdjustRegValue( MenuItemActionType action )
              {
                  if( action == MIA_IncValue )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 40  

                      MSValue = ( MSValue + 1 ) % 0x100;
                  }
                  else
                  {
                      MSValue = ( MSValue + 255 ) % 0x100;
                  }
                  return TRUE;
              }
              WORD GetAddrRegValue( void )
              {
                  if( MSBankNo == 0 )        // scaler
                  {
                      MSValue = msReadByte( MSAddr );
                  }
                  else if( MSBankNo == 1 )        // adc
                  {
                      // wait for coding
                      //msWriteByte( BK0_00, REGBANK1 );
                      MSValue = msReadByte( MSAddr );
                      //msWriteByte( BK0_00, REGBANK0 );
                  }
                  else if( MSBankNo == 2 )        // TCON
                  {
                      // wait for coding
                      //msWriteByte( BK0_00, REGBANK2 );
                      MSValue = msReadByte( MSAddr );
                      //msWriteByte( BK0_00, REGBANK0 );
                  }
                  return MSValue;
              }
              WORD GetRegValue( void )
              {
                  return MSValue;
              }
              Bool WriteRegValue( void )
              {
                  if( MSBankNo == 0 )        // scaler
                  {
                      msWriteByte( MSAddr, MSValue );
                  }
                  else if( MSBankNo == 1 )        // adc
                  {
                      // wait for coding
                      //msWriteByte( BK0_00, REGBANK1 );
                      msWriteByte( MSAddr, MSValue );
                      //msWriteByte( BK0_00, REGBANK0 );
                  }
                  else if( MSBankNo == 2 )        // TCON
                  {
                      // wait for coding
                      //msWriteByte( BK0_00, REGBANK2 );
                      msWriteByte( MSAddr, MSValue );
                      //msWriteByte( BK0_00, REGBANK0 );
                  }
                  return TRUE;
              }
              
              
              #endif
              WORD GetPanelOnTimeValue( void )
              {
                  WORD hour;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 41  

                  if( BlacklitTime > 235926000ul )
                      // 655365*3600
                      hour = 0xFFFF;
                  else
                      hour = ( DWORD )BlacklitTime / 3600;
                  return hour;
              }
              
              /*
              WORD GetSSCStepValue( void )
              {
                  WORD StepValue;
                  StepValue=msRead2Byte(BK0_D8);
                  return StepValue;
              }
              WORD GetSSCSpanValue( void )
              {
                  WORD SpanValue;
                  SpanValue=msRead2Byte(BK0_DA);
                  return SpanValue;
              }
              */
              
              
              #if ENABLE_TNR
              Bool AdjustTNR( MenuItemActionType action )
              {
                  action = action;
                  if( TNROnFlag )
                  {
                      Clr_TNROnFlag();
                      msTNROnOff( FALSE );
                  }
                  else
                  {
                      Set_TNROnFlag();
                      msTNROnOff( TRUE );
              #if ENABLE_RTE && (CHIP_ID == CHIP_TSUMC || CHIP_ID==CHIP_TSUMK ||CHIP_ID == CHIP_TSUMJ)
                      if(UserprefOverDriveSwitch)
                      {
                          UserprefOverDriveSwitch = 0;
                          msOverDriveOnOff( FALSE );
                      }
              #endif
                  }
              #if USEFLASH
                  //SaveMonitorSetting();
                  Set_FlashSaveMonitorFlag();
              #else
                  NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #endif
                  Delay1ms( 200 );
                  return TRUE;
              }
              #endif
              #if PanelRSDS
              WORD GetVCOMValue( void )
              {
                  return UserPrefVcomValue;
              }
              
              Bool AdjustVCOMValue( MenuItemActionType action )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 42  

              {
                  BYTE tempBank = msReadByte( BK0_00 );
                  msWriteByte( BK0_00, REGBANK0 );
              
                  if( action == MIA_IncValue )
                  {
                      UserPrefVcomValue = UserPrefVcomValue + 1;
                  }
                  else
                  {
                      UserPrefVcomValue = UserPrefVcomValue + 255;
                  }
                  msWriteByte( BK0_C5, UserPrefVcomValue );
              
                  msWriteByte( BK0_00, tempBank );
                  return TRUE;
              }
              #endif
              #if ENABLE_SUPER_RESOLUTION
              BYTE xdata SRmodeContent = SRMODE_Nums;
              code RegUnitType tSR_Mode_OFF_Tbl[]=
              {
                  //STD_Off
                  { REG_2F00,     0x0B},
                  { REG_2F20,     0x00},
                  { REG_2F60,     0x00},
                  { REG_2F21,     0x01},
                  { REG_2F30,     0x10},
                  { REG_2F22,     0x00},
                  { REG_2F31,     0x10},
                  { REG_2F32,     0x10},
                  { REG_2F33,     0x10},
                  { REG_2F62,     0x00},
                  { REG_2F64,     0xFF},
                  { REG_2F80,     0x15},
                  { REG_2F81,     0x15},
                  { REG_2F82,     0x10},
                  { REG_2F83,     0x10},
                  { REG_2F84,     0x15},
                  { REG_2F85,     0x15},
                  { REG_2F86,     0x20},
                  { REG_2F87,     0x20},
                  { REG_2F88,     0x20},
                  { REG_2F89,     0x20},
                  { REG_2F8A,     0x20},
                  { REG_2F8B,     0x20},
                  { REG_2F8C,     0x20},
                  { REG_2F8D,     0x20},
                  { REG_2F8E,     0x20},
                  { REG_2F8F,     0x20},
                  { REG_2F40,     0xFF},
                  { REG_2F48,     0xFF},
                  { REG_2F41,     0xFF},
                  { REG_2F49,     0xFF},
                  { REG_2F42,     0xFF},
                  { REG_2F4A,     0xFF},
                  { REG_2F43,     0xFF},
                  { REG_2F4B,     0xFF},
                  { REG_2F38,     0x10},
                  { REG_2F39,     0x32},
                  { REG_2F3C,     0x10},
                  { REG_2F3D,     0x32},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 43  

                  { REG_2F27,     0x10},
                  //{ REG_2FA0,   0x00},
                  { REG_2FA1,     0x00},
                  { REG_2F00,     0x00},
                  { REG_2F10,     0x00},
                  { REG_2F14,   ( PANEL_HEIGHT - 1 ) & 0xFF},
                  { REG_2F15,   ( PANEL_HEIGHT - 1 ) >> 8},
                  { REG_2F00,     0x0B},
                  { REG_2F25,     0x00},
                  { REG_2F34,     0x08},
                  { REG_2F23,     0xFF},
                  { REG_2F37,     0x08},
                  { REG_2F65,     0xEF},
                  { REG_2F90,     0x1C},
                  { REG_2F91,     0x1C},
                  { REG_2F92,     0x20},
                  { REG_2F93,     0x20},
                  { REG_2F94,     0x24},
                  { REG_2F95,     0x24},
                  { REG_2F96,     0x28},
                  { REG_2F97,     0x28},
                  { REG_2F98,     0x24},
                  { REG_2F99,     0x24},
                  { REG_2F9A,     0x20},
                  { REG_2F9B,     0x20},
                  { REG_2F9C,     0x18},
                  { REG_2F9D,     0x18},
                  { REG_2F9E,     0x10},
                  { REG_2F9F,     0x10},
                  { REG_2F44,     0xFF},
                  { REG_2F4C,     0xFF},
                  { REG_2F47,     0xFF},
                  { REG_2F4F,     0xFF},
                  { REG_2F3A,     0x54},
                  { REG_2F3B,     0x76},
                  { REG_2F3E,     0x54},
                  { REG_2F3F,     0x76},
                  { REG_2F26,     0x42},
                  { REG_2F61,     0x33},
                  { REG_2F35,     0x08},
                  { REG_2F36,     0x08},
                  { REG_2F68,     0x00},
                  { REG_2F69,     0x00},
                  { REG_2F45,     0xFF},
                  { REG_2F4D,     0xFF},
                  { REG_2F46,     0xFF},
                  { REG_2F4E,     0xFF},
                  { REG_2FC0,     0x00},
                  { REG_2FC2,     0x00},
                  { REG_2FE0,     0x00},
                  { REG_2FE4,     0x00},
                  { REG_2FE5,     0x00},
                  { REG_2FE2,     0x00},
                  { REG_2FC1,     0x00},
                  { REG_2FC3,     0x00},
                  { REG_2FEA,     0x00},
                  { REG_2FEE,     0x00},
                  { REG_2FEF,     0x00},
                  { REG_2FEC,     0x00},
                  { REG_2F24,     0x00},
                  { REG_2F72,     0x00},
                  { REG_2FF4,     0x00},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 44  

                  { REG_2FF8,     0x00},
                  { REG_2FF9,     0x00},
                  { REG_2FF6,     0x00}
              };
              code RegUnitType tSR_Mode_H_Tbl[]=
              {
                  //STD_H for T3D
                  {REG_2F00 ,     0x0B},
                  {REG_2F20 ,     0x81},
                  {REG_2F60 ,     0x00},
                  {REG_2F21 ,     0x83},
                  {REG_2F30 ,     0x2F},
                  {REG_2F22 ,     0x57},
                  {REG_2F31 ,     0x2F},
                  {REG_2F32 ,     0x10},
                  {REG_2F33 ,     0x10},
                  {REG_2F62 ,     0x9F},
                  {REG_2F64 ,     0xFF},
                  {REG_2F80 ,     0x15},
                  {REG_2F81 ,     0x15},
                  {REG_2F82 ,     0x10},
                  {REG_2F83 ,     0x10},
                  {REG_2F84 ,     0x15},
                  {REG_2F85 ,     0x15},
                  {REG_2F86 ,     0x20},
                  {REG_2F87 ,     0x20},
                  {REG_2F88 ,     0x20},
                  {REG_2F89 ,     0x20},
                  {REG_2F8A ,     0x20},
                  {REG_2F8B ,     0x20},
                  {REG_2F8C ,     0x20},
                  {REG_2F8D ,     0x20},
                  {REG_2F8E ,     0x20},
                  {REG_2F8F ,     0x20},
                  {REG_2F40 ,     0xD0},
                  {REG_2F48 ,     0xD0},
                  {REG_2F41 ,     0xD0},
                  {REG_2F49 ,     0xD0},
                  {REG_2F42 ,     0x40},
                  {REG_2F4A ,     0x40},
                  {REG_2F43 ,     0x40},
                  {REG_2F4B ,     0x40},
                  {REG_2F38 ,     0x10},
                  {REG_2F39 ,     0x32},
                  {REG_2F3C ,     0x10},
                  {REG_2F3D ,     0x32},
                  {REG_2F27 ,     0x10},
                  {REG_2FA1 ,     0x00},
                  {REG_2F00 ,     0x00},
                  {REG_2F10 ,     0x02},
                  {REG_2F14 ,    ( PANEL_HEIGHT - 1 + 2 ) & 0xFF},
                  {REG_2F15 ,    ( PANEL_HEIGHT - 1 + 2 ) >> 8},
                  {REG_2F00 ,     0x0B},
                  {REG_2F25 ,     0x00},
                  {REG_2F34 ,     0x1C},
                  {REG_2F23 ,     0xFF},
                  {REG_2F37 ,     0x1C},
                  {REG_2F65 ,     0xEF},
                  {REG_2F90 ,     0x1C},
                  {REG_2F91 ,     0x1C},
                  {REG_2F92 ,     0x20},
                  {REG_2F93 ,     0x20},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 45  

                  {REG_2F94 ,     0x24},
                  {REG_2F95 ,     0x24},
                  {REG_2F96 ,     0x28},
                  {REG_2F97 ,     0x28},
                  {REG_2F98 ,     0x24},
                  {REG_2F99 ,     0x24},
                  {REG_2F9A ,     0x20},
                  {REG_2F9B ,     0x20},
                  {REG_2F9C ,     0x18},
                  {REG_2F9D ,     0x18},
                  {REG_2F9E ,     0x10},
                  {REG_2F9F ,     0x10},
                  {REG_2F44 ,     0x40},
                  {REG_2F4C ,     0x40},
                  {REG_2F47 ,     0x60},
                  {REG_2F4F ,     0x60},
                  {REG_2F3A ,     0x54},
                  {REG_2F3B ,     0x76},
                  {REG_2F3E ,     0x54},
                  {REG_2F3F ,     0x76},
                  {REG_2F26 ,     0x88},
                  {REG_2F61 ,     0x03},
                  {REG_2F35 ,     0x1F},
                  {REG_2F36 ,     0x1F},
                  {REG_2F68 ,     0x70},
                  {REG_2F69 ,     0x07},
                  {REG_2F45 ,     0x40},
                  {REG_2F4D ,     0x40},
                  {REG_2F46 ,     0x40},
                  {REG_2F4E ,     0x40},
                  {REG_2FC0 ,     0x04},
                  {REG_2FC2 ,     0xFF},
                  {REG_2FE0 ,     0x00},
                  {REG_2FE4 ,     0x00},
                  {REG_2FE5 ,     0x00},
                  {REG_2FE2 ,     0x00},
                  {REG_2FC1 ,     0x04},
                  {REG_2FC3 ,     0xFF},
                  {REG_2FEA ,     0x00},
                  {REG_2FEE ,     0x00},
                  {REG_2FEF ,     0x00},
                  {REG_2FEC ,     0x00},
                  {REG_2F24 ,     0x04},
                  {REG_2F72 ,     0x00},
                  {REG_2FF4 ,     0x00},
                  {REG_2FF8 ,     0x00},
                  {REG_2FF9 ,     0x00}
              };
              
              code RegUnitType tSR_Mode_M_Tbl[]=
              {
                  //STD_M
                  {REG_2F00 ,    0x0B },
                  {REG_2F20 ,    0x81 },
                  {REG_2F60 ,    0x00 },
                  {REG_2F21 ,    0xF3 },
                  {REG_2F30 ,    0x1F },
                  {REG_2F22 ,    0x57 },
                  {REG_2F31 ,    0x13 },
                  {REG_2F32 ,    0x10 },
                  {REG_2F33 ,    0x10 },
                  {REG_2F62 ,    0x9F },
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 46  

                  {REG_2F64 ,    0xFF },
                  {REG_2F80 ,    0x15 },
                  {REG_2F81 ,    0x15 },
                  {REG_2F82 ,    0x10 },
                  {REG_2F83 ,    0x10 },
                  {REG_2F84 ,    0x15 },
                  {REG_2F85 ,    0x15 },
                  {REG_2F86 ,    0x20 },
                  {REG_2F87 ,    0x20 },
                  {REG_2F88 ,    0x20 },
                  {REG_2F89 ,    0x20 },
                  {REG_2F8A ,    0x20 },
                  {REG_2F8B ,    0x20 },
                  {REG_2F8C ,    0x20 },
                  {REG_2F8D ,    0x20 },
                  {REG_2F8E ,    0x20 },
                  {REG_2F8F ,    0x20 },
                  {REG_2F40 ,    0x20 },
                  {REG_2F48 ,    0x20 },
                  {REG_2F41 ,    0x20 },
                  {REG_2F49 ,    0x20 },
                  {REG_2F42 ,    0x20 },
                  {REG_2F4A ,    0x20 },
                  {REG_2F43 ,    0x20 },
                  {REG_2F4B ,    0x20 },
                  {REG_2F38 ,    0x10 },
                  {REG_2F39 ,    0x32 },
                  {REG_2F3C ,    0x10 },
                  {REG_2F3D ,    0x32 },
                  {REG_2F27 ,    0x10 },
                  //{REG_2FA0 ,    0x00 },
                  {REG_2FA1 ,    0x00 },
                  {REG_2F00 ,    0x00 },
                  {REG_2F10 ,    0x02 },
                  {REG_2F14 ,    ( PANEL_HEIGHT - 1 + 2 ) & 0xFF},
                  {REG_2F15 ,    ( PANEL_HEIGHT - 1 + 2 ) >> 8},
                  {REG_2F00 ,    0x0B},
                  {REG_2F25 ,    0x00 },
                  {REG_2F34 ,    0x0F },
                  {REG_2F23 ,    0xFF },
                  {REG_2F37 ,    0x0F },
                  {REG_2F65 ,    0xEF },
                  {REG_2F90 ,    0x1C },
                  {REG_2F91 ,    0x1C },
                  {REG_2F92 ,    0x20 },
                  {REG_2F93 ,    0x20 },
                  {REG_2F94 ,    0x24 },
                  {REG_2F95 ,    0x24 },
                  {REG_2F96 ,    0x28 },
                  {REG_2F97 ,    0x28 },
                  {REG_2F98 ,    0x24 },
                  {REG_2F99 ,    0x24 },
                  {REG_2F9A ,    0x20 },
                  {REG_2F9B ,    0x20 },
                  {REG_2F9C ,    0x18 },
                  {REG_2F9D ,    0x18 },
                  {REG_2F9E ,    0x10 },
                  {REG_2F9F ,   0x10 },
                  {REG_2F44 ,    0x18 },
                  {REG_2F4C ,    0x18 },
                  {REG_2F47 ,    0x18 },
                  {REG_2F4F ,    0x18 },
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 47  

                  {REG_2F3A ,    0x54 },
                  {REG_2F3B ,    0x76 },
                  {REG_2F3E ,    0x54 },
                  {REG_2F3F ,    0x76 },
                  {REG_2F26 ,    0x66 },
                  {REG_2F61 ,    0x03 },
                  {REG_2F35 ,    0x0F },
                  {REG_2F36 ,    0x0F },
                  {REG_2F68 ,    0x40 },
                  {REG_2F69 ,    0x04 },
                  {REG_2F45 ,    0x20 },
                  {REG_2F4D ,    0x20 },
                  {REG_2F46 ,    0x20 },
                  {REG_2F4E ,    0x20 },
                  {REG_2FC0 ,    0x84 },
                  {REG_2FC2 ,    0xFF },
                  {REG_2FE0 ,    0x00 },
                  {REG_2FE4 ,    0x00 },
                  {REG_2FE5 ,    0x00 },
                  {REG_2FE2 ,    0x00 },
                  {REG_2FC1 ,    0x84 },
                  {REG_2FC3 ,    0xFF },
                  {REG_2FEA ,    0x00 },
                  {REG_2FEE ,    0x00 },
                  {REG_2FEF ,    0x00 },
                  {REG_2FEC ,    0x00 },
                  {REG_2F24 ,    0x84 },
                  {REG_2F72 ,    0x00 },
                  {REG_2FF4 ,    0x00 },
                  {REG_2FF8 ,    0x00 },
                  {REG_2FF9 ,    0x00 },
                  {REG_2FF6 ,    0x00 }
              };
              code RegUnitType tSR_Mode_L_Tbl[]=
              {
                  //STD_L
                  {REG_2F00 ,    0x0B},
                  {REG_2F20 ,    0x81},
                  {REG_2F60 ,    0x00},
                  {REG_2F21 ,    0xF3},
                  {REG_2F30 ,    0x1D},
                  {REG_2F22 ,    0x57},
                  {REG_2F31 ,    0x07},
                  {REG_2F32 ,    0x10},
                  {REG_2F33 ,    0x10},
                  {REG_2F62 ,    0x9F},
                  {REG_2F64 ,    0xFF},
                  {REG_2F80 ,    0x15},
                  {REG_2F81 ,    0x15},
                  {REG_2F82 ,    0x10},
                  {REG_2F83 ,    0x10},
                  {REG_2F84 ,    0x15},
                  {REG_2F85 ,    0x15},
                  {REG_2F86 ,    0x20},
                  {REG_2F87 ,    0x20},
                  {REG_2F88 ,    0x20},
                  {REG_2F89 ,    0x20},
                  {REG_2F8A ,    0x20},
                  {REG_2F8B ,    0x20},
                  {REG_2F8C ,    0x20},
                  {REG_2F8D ,    0x20},
                  {REG_2F8E ,    0x20},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 48  

                  {REG_2F8F ,    0x20},
                  {REG_2F40 ,    0x20},
                  {REG_2F48 ,    0x20},
                  {REG_2F41 ,    0x20},
                  {REG_2F49 ,    0x20},
                  {REG_2F42 ,    0x20},
                  {REG_2F4A ,    0x20},
                  {REG_2F43 ,    0x20},
                  {REG_2F4B ,    0x20},
                  {REG_2F38 ,    0x10},
                  {REG_2F39 ,    0x32},
                  {REG_2F3C ,    0x10},
                  {REG_2F3D ,    0x32},
                  {REG_2F27 ,    0x10},
                  //{REG_2FA0 ,    0x00},
                  {REG_2FA1 ,    0x00},
                  {REG_2F00,     0x00},
                  {REG_2F10 ,    0x02},
                  {REG_2F14,    ( PANEL_HEIGHT - 1 + 2 ) & 0xFF},
                  {REG_2F15,    ( PANEL_HEIGHT - 1 + 2 ) >> 8},
                  {REG_2F00,     0x0B},
                  {REG_2F25 ,    0x00},
                  {REG_2F34 ,    0x09},
                  {REG_2F23 ,    0xFF},
                  {REG_2F37 ,    0x09},
                  {REG_2F65 ,    0xEF},
                  {REG_2F90 ,    0x1C},
                  {REG_2F91 ,    0x1C},
                  {REG_2F92 ,    0x20},
                  {REG_2F93 ,    0x20},
                  {REG_2F94 ,    0x24},
                  {REG_2F95 ,    0x24},
                  {REG_2F96 ,    0x28},
                  {REG_2F97 ,    0x28},
                  {REG_2F98 ,    0x24},
                  {REG_2F99 ,    0x24},
                  {REG_2F9A ,    0x20},
                  {REG_2F9B ,    0x20},
                  {REG_2F9C ,    0x18},
                  {REG_2F9D ,    0x18},
                  {REG_2F9E ,    0x10},
                  {REG_2F9F ,    0x10},
                  {REG_2F44 ,    0x18},
                  {REG_2F4C ,    0x18},
                  {REG_2F47 ,    0x18},
                  {REG_2F4F ,    0x18},
                  {REG_2F3A ,    0x54},
                  {REG_2F3B ,    0x76},
                  {REG_2F3E ,    0x54},
                  {REG_2F3F ,    0x76},
                  {REG_2F26 ,    0x33},
                  {REG_2F61 ,    0x03},
                  {REG_2F35 ,    0x0F},
                  {REG_2F36 ,    0x0F},
                  {REG_2F68 ,    0x40},
                  {REG_2F69 ,    0x04},
                  {REG_2F45 ,    0x20},
                  {REG_2F4D ,    0x20},
                  {REG_2F46 ,    0x20},
                  {REG_2F4E ,    0x20},
                  {REG_2FC0 ,    0x84},
                  {REG_2FC2 ,    0xFF},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 49  

                  {REG_2FE0 ,    0x00},
                  {REG_2FE4 ,    0x00},
                  {REG_2FE5 ,    0x00},
                  {REG_2FE2 ,    0x00},
                  {REG_2FC1 ,    0x84},
                  {REG_2FC3 ,    0xFF},
                  {REG_2FEA ,    0x00},
                  {REG_2FEE ,    0x00},
                  {REG_2FEF ,    0x00},
                  {REG_2FEC ,    0x00},
                  {REG_2F24 ,    0x84},
                  {REG_2F72 ,    0x00},
                  {REG_2FF4 ,    0x00},
                  {REG_2FF8 ,    0x00},
                  {REG_2FF9 ,    0x00},
                  {REG_2FF6 ,    0x00}
              };
              
              void mStar_SetupSuperResolution( BYTE SuperResolutionMode )
              {
                  BYTE i=0;
                  if((SRmodeContent == SuperResolutionMode))
                  {
                      if(SuperResolutionMode!=SRMODE_OFF)
                      {
                           msWriteByte(SC0_14, (msReadByte(SC0_14)+2));
                      }
                 return;
                  }
              
                  switch(SuperResolutionMode)
                  {
                      case SRMODE_STRONG:
                      MenuFunc_printMsg("tSR_Mode_H_Tbl");
                      for(i=0;i<sizeof(tSR_Mode_H_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tSR_Mode_H_Tbl[i].u16Reg,tSR_Mode_H_Tbl[i].u8Value);
                          break;
              
                      case SRMODE_MIDDLE :
                      MenuFunc_printMsg("tSR_Mode_M_Tbl");
                      for(i=0;i<sizeof(tSR_Mode_M_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tSR_Mode_M_Tbl[i].u16Reg,tSR_Mode_M_Tbl[i].u8Value);
                          break;
              
                      case SRMODE_WEAK:
                      MenuFunc_printMsg("tSR_Mode_L_Tbl");
                      for(i=0;i<sizeof(tSR_Mode_L_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tSR_Mode_L_Tbl[i].u16Reg,tSR_Mode_L_Tbl[i].u8Value);
                          break;
              
                      default:
                      MenuFunc_printData("tSR_Mode_OFF_Tbl",0);
                      for(i=0;i<sizeof(tSR_Mode_OFF_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tSR_Mode_OFF_Tbl[i].u16Reg,tSR_Mode_OFF_Tbl[i].u8Value);
                          break;
                  }
                  SRmodeContent = SuperResolutionMode;
              }
              #endif
              
              #if ENABLE_TNR
              static BYTE xdata NRmodeContent = NRMODE_Nums;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 50  

              code RegUnitType tNR_Mode_OFF_Tbl[]=
              {
                  //STD_Off
                  {REG_2F00   ,0x0C},
                  {REG_2F42   ,0x00},
                  {REG_2F80   ,0x00},
                  {REG_2F81   ,0x00},
                  {REG_2F82   ,0x00},
                  {REG_2F83   ,0x00},
                  {REG_2F84   ,0x00},
                  {REG_2F85   ,0x00},
                  {REG_2F86   ,0x00},
                  {REG_2F87   ,0x00},
                  {REG_2F00   ,0x02},
                  {REG_2FA0   ,0x00},
                  {REG_2FA8   ,0x00},
                  {REG_2FAA   ,0x00},
                  {REG_2FB8   ,0x10},
                  {REG_2FB9   ,0x32},
                  {REG_2FBA   ,0x54},
                  {REG_2FBB   ,0x76},
                  {REG_2FBC   ,0x98},
                  {REG_2FBD   ,0xBA},
                  {REG_2FBE   ,0xDC},
                  {REG_2FBF   ,0xFE},
                  {REG_2F00   ,0x04},
                  {REG_2F20   ,0x00},
                  {REG_2F21   ,0x0F},
                  {REG_2F22   ,0x00},
                  {REG_2F23   ,0x00},
                  {REG_2F24   ,0xFF},
                  {REG_2F25   ,0x07},
                  {REG_2F80   ,0x01},
                  {REG_2F81   ,0x0F},
                  {REG_2F82   ,0x00},
                  {REG_2F84   ,0xFF},
                  {REG_2FA0   ,0x08},
                  {REG_2FA1   ,0x07},
                  {REG_2FA2   ,0x0A},
                  {REG_2FA3   ,0x08},
                  {REG_2FA4   ,0x00},
                  {REG_2FA5   ,0x00},
                  {REG_2FA6   ,0x00},
                  {REG_2FA7   ,0x03},
                  {REG_2FAA   ,0x10},
                  {REG_2FAB   ,0x32},
                  {REG_2FAC   ,0x54},
                  {REG_2FAD   ,0x76},
                  {REG_2FAE   ,0x98},
                  {REG_2FAF   ,0xBA},
                  {REG_2FB1   ,0xDC},
                  {REG_2FB2   ,0xFE},
                  {REG_2F00   ,0x02},
                  {REG_2F60   ,0x10},
                  {REG_2F61   ,0xFF},
                  {REG_2F62   ,0x00},
                  {REG_2F68   ,0xEF},
                  {REG_2F69   ,0xCD},
                  {REG_2F6A   ,0xAB},
                  {REG_2F6B   ,0x89},
                  {REG_2F6C   ,0x67},
                  {REG_2F6D   ,0x45},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 51  

                  {REG_2F6E   ,0x23},
                  {REG_2F6F   ,0x01},
                  {REG_2FE0   ,0xE0},
                  {REG_2F20   ,0x00},
                  {REG_2F21   ,0x30},
                  {REG_2F22   ,0xEF},
                  {REG_2F23   ,0x00},
                  {REG_2F28   ,0xEF},
                  {REG_2F29   ,0xCD},
                  {REG_2F2A   ,0xAB},
                  {REG_2F2B   ,0x89},
                  {REG_2F2C   ,0x67},
                  {REG_2F2D   ,0x45},
                  {REG_2F2E   ,0x23},
                  {REG_2F2F   ,0x01},
                  {REG_2F72   ,0x07},
                  {REG_2F73   ,0x09},
                  {REG_2FE2   ,0x00}
              
              };
              code RegUnitType tNR_Mode_H_Tbl[]=
              {
                  //STD_H
                  {REG_2F00   ,0x0C},
                  {REG_2F42   ,0x03},
                  {REG_2F4A   ,0x02},
                  {REG_2F80   ,0xFF},
                  {REG_2F81   ,0xF6},
                  {REG_2F82   ,0xB4},
                  {REG_2F83   ,0x84},
                  {REG_2F84   ,0x62},
                  {REG_2F85   ,0x10},
                  {REG_2F86   ,0x05},
                  {REG_2F87   ,0x00},
                  {REG_2F00   ,0x02},
                  {REG_2FA0   ,0x03},
                  {REG_2FA8   ,0x03},
                  {REG_2FAA   ,0xFF},
                  {REG_2FB8   ,0x10},
                  {REG_2FB9   ,0x32},
                  {REG_2FBA   ,0x54},
                  {REG_2FBB   ,0x76},
                  {REG_2FBC   ,0x98},
                  {REG_2FBD   ,0xBA},
                  {REG_2FBE   ,0xDC},
                  {REG_2FBF   ,0xFE},
                  {REG_2F00   ,0x04},
                  {REG_2F20   ,0x03},
                  {REG_2F21   ,0x1F},
                  {REG_2F22   ,0x20},
                  {REG_2F23   ,0x00},
                  {REG_2F24   ,0x10},
                  {REG_2F25   ,0x00},
                  {REG_2F80   ,0x01},
                  {REG_2F81   ,0x0F},
                  {REG_2F82   ,0x00},
                  {REG_2F84   ,0xFF},
                  {REG_2FA0   ,0x2B},
                  {REG_2FA1   ,0x0F},
                  {REG_2FA2   ,0x0A},
                  {REG_2FA3   ,0x08},
                  {REG_2FA4   ,0x00},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 52  

                  {REG_2FA5   ,0x00},
                  {REG_2FA6   ,0x00},
                  {REG_2FA7   ,0x03},
                  {REG_2FAA   ,0x10},
                  {REG_2FAB   ,0x32},
                  {REG_2FAC   ,0x54},
                  {REG_2FAD   ,0x76},
                  {REG_2FAE   ,0x98},
                  {REG_2FAF   ,0xBA},
                  {REG_2FB1   ,0xDC},
                  {REG_2FB2   ,0xFE},
                  {REG_2F00   ,0x02},
                  {REG_2F60   ,0x13},
                  {REG_2F61   ,0xFF},
                  {REG_2F62   ,0xEF},
                  {REG_2F68   ,0xEF},
                  {REG_2F69   ,0xCD},
                  {REG_2F6A   ,0xAB},
                  {REG_2F6B   ,0x89},
                  {REG_2F6C   ,0x67},
                  {REG_2F6D   ,0x45},
                  {REG_2F6E   ,0x23},
                  {REG_2F6F   ,0x01},
                  {REG_2FE0   ,0xE0},
                  {REG_2F20   ,0x11},
                  {REG_2F21   ,0x30},
                  {REG_2F22   ,0xEF},
                  {REG_2F23   ,0x00},
                  {REG_2F28   ,0xEF},
                  {REG_2F29   ,0xCD},
                  {REG_2F2A   ,0xAB},
                  {REG_2F2B   ,0x89},
                  {REG_2F2C   ,0x67},
                  {REG_2F2D   ,0x45},
                  {REG_2F2E   ,0x23},
                  {REG_2F2F   ,0x01},
                  {REG_2F72   ,0x07},
                  {REG_2F73   ,0x09},
                  {REG_2FE2   ,0x00}
              };
              code RegUnitType tNR_Mode_M_Tbl[]=
              {
                  //STD_M
                  {REG_2F00   ,0x0C},
                  {REG_2F42   ,0x03},
                  {REG_2F4A     ,0x02},
                  {REG_2F80   ,0xB9},
                  {REG_2F81   ,0xA9},
                  {REG_2F82   ,0x76},
                  {REG_2F83   ,0x34},
                  {REG_2F84   ,0x12},
                  {REG_2F85   ,0x00},
                  {REG_2F86   ,0x00},
                  {REG_2F87   ,0x00},
                  {REG_2F00   ,0x02},
                  {REG_2FA0   ,0x03},
                  {REG_2FA8   ,0x02},
                  {REG_2FAA   ,0xFF},
                  {REG_2FB8   ,0x10},
                  {REG_2FB9   ,0x32},
                  {REG_2FBA   ,0x54},
                  {REG_2FBB   ,0x76},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 53  

                  {REG_2FBC   ,0x98},
                  {REG_2FBD   ,0xBA},
                  {REG_2FBE   ,0xDC},
                  {REG_2FBF   ,0xFE},
                  {REG_2F00   ,0x04},
                  {REG_2F20   ,0x03},
                  {REG_2F21   ,0x0F},
                  {REG_2F22   ,0x20},
                  {REG_2F23   ,0x00},
                  {REG_2F24   ,0x10},
                  {REG_2F25   ,0x00},
                  {REG_2F80   ,0x01},
                  {REG_2F81   ,0x0F},
                  {REG_2F82   ,0x00},
                  {REG_2F84   ,0xFF},
                  {REG_2FA0   ,0x2B},
                  {REG_2FA1   ,0x07},
                  {REG_2FA2   ,0x0A},
                  {REG_2FA3   ,0x08},
                  {REG_2FA4   ,0x00},
                  {REG_2FA5   ,0x00},
                  {REG_2FA6   ,0x00},
                  {REG_2FA7   ,0x03},
                  {REG_2FAA   ,0x10},
                  {REG_2FAB   ,0x32},
                  {REG_2FAC   ,0x54},
                  {REG_2FAD   ,0x76},
                  {REG_2FAE   ,0x98},
                  {REG_2FAF   ,0xBA},
                  {REG_2FB1   ,0xDC},
                  {REG_2FB2   ,0xFE},
                  {REG_2F00   ,0x02},
                  {REG_2F60   ,0x13},
                  {REG_2F61   ,0xFF},
                  {REG_2F62   ,0xE7},
                  {REG_2F68   ,0xEF},
                  {REG_2F69   ,0xCD},
                  {REG_2F6A   ,0xAB},
                  {REG_2F6B   ,0x89},
                  {REG_2F6C   ,0x67},
                  {REG_2F6D   ,0x45},
                  {REG_2F6E   ,0x23},
                  {REG_2F6F   ,0x01},
                  {REG_2FE0   ,0xE0},
                  {REG_2F20   ,0x11},
                  {REG_2F21   ,0x30},
                  {REG_2F22   ,0xE7},
                  {REG_2F23   ,0x00},
                  {REG_2F28   ,0xEF},
                  {REG_2F29   ,0xCD},
                  {REG_2F2A   ,0xAB},
                  {REG_2F2B   ,0x89},
                  {REG_2F2C   ,0x67},
                  {REG_2F2D   ,0x45},
                  {REG_2F2E   ,0x23},
                  {REG_2F2F   ,0x01},
                  {REG_2F72   ,0x07},
                  {REG_2F73   ,0x09},
                  {REG_2FE2   ,0x00}
              };
              code RegUnitType tNR_Mode_L_Tbl[]=
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 54  

                  //STD_L
                  {REG_2F00   ,0x0C},
                  {REG_2F42   ,0x03},
                  {REG_2F4A   ,0x02},
                  {REG_2F80   ,0x80},
                  {REG_2F81   ,0x7B},
                  {REG_2F82   ,0x48},
                  {REG_2F83   ,0x06},
                  {REG_2F84   ,0x00},
                  {REG_2F85   ,0x00},
                  {REG_2F86   ,0x00},
                  {REG_2F87   ,0x00},
                  {REG_2F00   ,0x02},
                  {REG_2FA0   ,0x03},
                  {REG_2FA8   ,0x01},
                  {REG_2FAA   ,0xFF},
                  {REG_2FB8   ,0x10},
                  {REG_2FB9   ,0x32},
                  {REG_2FBA   ,0x54},
                  {REG_2FBB   ,0x76},
                  {REG_2FBC   ,0x98},
                  {REG_2FBD   ,0xBA},
                  {REG_2FBE   ,0xDC},
                  {REG_2FBF   ,0xFE},
                  {REG_2F00   ,0x04},
                  {REG_2F20   ,0x03},
                  {REG_2F21   ,0x07},
                  {REG_2F22   ,0x20},
                  {REG_2F23   ,0x00},
                  {REG_2F24   ,0x10},
                  {REG_2F25   ,0x00},
                  {REG_2F80   ,0x01},
                  {REG_2F81   ,0x0F},
                  {REG_2F82   ,0x00},
                  {REG_2F84   ,0xFF},
                  {REG_2FA0   ,0x2B},
                  {REG_2FA1   ,0x03},
                  {REG_2FA2   ,0x0A},
                  {REG_2FA3   ,0x08},
                  {REG_2FA4   ,0x00},
                  {REG_2FA5   ,0x00},
                  {REG_2FA6   ,0x00},
                  {REG_2FA7   ,0x03},
                  {REG_2FAA   ,0x10},
                  {REG_2FAB   ,0x32},
                  {REG_2FAC   ,0x54},
                  {REG_2FAD   ,0x76},
                  {REG_2FAE   ,0x98},
                  {REG_2FAF   ,0xBA},
                  {REG_2FB1   ,0xDC},
                  {REG_2FB2   ,0xFE},
                  {REG_2F00   ,0x02},
                  {REG_2F60   ,0x13},
                  {REG_2F61   ,0xFF},
                  {REG_2F62   ,0xE3},
                  {REG_2F68   ,0xEF},
                  {REG_2F69   ,0xCD},
                  {REG_2F6A   ,0xAB},
                  {REG_2F6B   ,0x89},
                  {REG_2F6C   ,0x67},
                  {REG_2F6D   ,0x45},
                  {REG_2F6E   ,0x23},
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 55  

                  {REG_2F6F   ,0x01},
                  {REG_2FE0   ,0xE0},
                  {REG_2F20   ,0x11},
                  {REG_2F21   ,0x30},
                  {REG_2F22   ,0xE3},
                  {REG_2F23   ,0x00},
                  {REG_2F28   ,0xEF},
                  {REG_2F29   ,0xCD},
                  {REG_2F2A   ,0xAB},
                  {REG_2F2B   ,0x89},
                  {REG_2F2C   ,0x67},
                  {REG_2F2D   ,0x45},
                  {REG_2F2E   ,0x23},
                  {REG_2F2F   ,0x01},
                  {REG_2F72   ,0x07},
                  {REG_2F73   ,0x09},
                  {REG_2FE2   ,0x00}
              };
              
              void mStar_SetupNRmode( BYTE NRMode )
              {
                  BYTE i=0;
                  if(NRmodeContent == NRMode)
                      return;
              
                  switch(NRMode)
                  {
                      case NRMODE1:
                      MenuFunc_printMsg("tNR_Mode_H_Tbl");
                      for(i=0;i<sizeof(tNR_Mode_H_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tNR_Mode_H_Tbl[i].u16Reg,tNR_Mode_H_Tbl[i].u8Value);
                          break;
              
                      case NRMODE2 :
                      MenuFunc_printMsg("tNR_Mode_M_Tbl");
                      for(i=0;i<sizeof(tNR_Mode_M_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tNR_Mode_M_Tbl[i].u16Reg,tNR_Mode_M_Tbl[i].u8Value);
                          break;
              
                      case NRMODE3:
                      MenuFunc_printMsg("tNR_Mode_L_Tbl");
                      for(i=0;i<sizeof(tNR_Mode_L_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tNR_Mode_L_Tbl[i].u16Reg,tNR_Mode_L_Tbl[i].u8Value);
                          break;
              
                      default:
                      MenuFunc_printData("tNR_Mode_OFF_Tbl",0);
                      for(i=0;i<sizeof(tNR_Mode_OFF_Tbl)/sizeof(RegUnitType);i++)
                          msWriteByte(tNR_Mode_OFF_Tbl[i].u16Reg,tNR_Mode_OFF_Tbl[i].u8Value);
                          break;
                  }
                  NRmodeContent = NRMode;
              }
              #endif
              
              #if ENABLE_DeBlocking
              void msDeBlockingOnOff( BYTE ucSwitch, BYTE win)
              {
                  win=win;
                  msWriteByteMask(SC2_20,  (ucSwitch)?(BIT0):(0), BIT0);  //BIT0:enable
              }
              
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 56  

              void msInitDeBlocking( void )
              {
                  BYTE i=0;
                  //SC2_60[3]=1: motion debug mode
                  //SC2_E0[3]=0:SPF all bypass
                  msWriteByteMask(SC2_E0, 0x00        ,BIT3|BIT2|BIT1|BIT0);
                  msWriteByteMask(SC2_E0, 0x00        ,BIT7);
              
                  msWriteByteMask(SC2_80, BIT0        ,BIT7|BIT6|BIT0);  //BIT7:debug mode ,BIT6: iir mode BIT0:blockine
             -ss_en_f2
                  //msWriteByteMask(SC2_80,   BIT3|BIT2   ,BIT3|BIT2);  //De-blocking coarse detect step F2
                  msWriteByteMask(SC2_81, 0x30    ,0xFF);  //De-blocking coarse active threshold F2
              
                  MenuFunc_printMsg("msInitDeBlocking");
              }
              #endif
              #if ENABLE_SHARPNESS
              //=============================================================================
              #define MaxSharpness    0x1F   //user sharpness adjust gain: 0x10~0x1F==>1.0~ 1.9
              #define MinSharpness    0x00     //user sharpness adjust gain  0x00~0x0F==>0.0~ 0.9
              
              Bool AdjustSharpness( MenuItemActionType action )
              {
                  WORD tempValue;
                  tempValue = DecIncValue( action, UserPrefSharpness, MinSharpness, MaxSharpness, 1 );
                  if( tempValue == UserPrefSharpness )
                  {
                      return FALSE;
                  }
                  UserPrefSharpness = tempValue;
              
              #if ENABLE_SUPER_RESOLUTION
                  mStar_SetupSuperResolution( SRMODE_OFF);
              #endif
                  msAdjustSharpness( MAIN_WINDOW, UserPrefSharpness, 0 );
              
                  MenuFunc_printData("UserPrefSharpness===%x",UserPrefSharpness);
              
                  return TRUE;
              }
              WORD GetSharpnessValue( void )
              {
                  return GetScale100Value( UserPrefSharpness, MinSharpness, MaxSharpness );
              }
              #endif
              
              
              
              
              #if ENABLE_OSD_ROTATION
              Bool SetOSDRotateMode(void)
              {
                  if (UserPrefOsdRotateMode == MenuItemIndex)
                      return FALSE;
                  UserPrefOsdRotateMode = MenuItemIndex;
              
                  if (UserPrefOsdRotateMode!=0)
                      SET_MENU_ROTATION_FLAG();
                  else
                      CLR_MENU_ROTATION_FLAG();
              
                  if ( UserPrefOsdRotateMode==OSDRotateMenuItems_90 )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 57  

                  {
              
                      drvOSD_SetWndCABaseAddr ( OSD_MAIN_WND, GET_CABASE_0_90 ( OSD_MAIN_WND_CA_BASE, OsdWindowWidth ) )
             -;
                      Osd_SetPosition ( UserPrefHStart, UserPrefVStart );
                  }
                  #if defined (_OSD_ROTATION_180_)
                  if ( UserPrefOsdRotateMode==OSDRotateMenuItems_180 )
                  {
                      drvOSD_SetWndCABaseAddr ( OSD_MAIN_WND, GET_CABASE_0_180 ( OSD_MAIN_WND_CA_BASE, OsdWindowWidth, O
             -sdWindowHeight ) );
                      Osd_SetPosition ( UserPrefHStart, UserPrefVStart );
                  }
                  else
                  #endif
                  #if defined (_OSD_ROTATION_270_)
                  if ( UserPrefOsdRotateMode==OSDRotateMenuItems_270 )
                  {
                      drvOSD_SetWndCABaseAddr ( OSD_MAIN_WND, GET_CABASE_0_270 ( OSD_MAIN_WND_CA_BASE, OsdWindowWidth, O
             -sdWindowHeight ) );
                      Osd_SetPosition ( UserPrefHStart, UserPrefVStart );
                  }
                  else
                  #endif
                  {
                      drvOSD_SetWndCABaseAddr ( OSD_MAIN_WND, OSD_MAIN_WND_CA_BASE );
                      Osd_SetPosition ( UserPrefOsdHStart, UserPrefOsdVStart);
                  }
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              #endif
              
              Bool OSD_SetColorTemp(void)
              {
                  if (UserPrefColorTemp== MenuItemIndex)
                      return FALSE;
                  UserPrefColorTemp = MenuItemIndex;
              
                SetColorTemp();
                
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              
              Bool AdjustVideoSaturation(MenuItemActionType enAction)
              {
                  WORD u16TempValue;
              
                  u16TempValue = DecIncValue(enAction, UserPrefSaturation, 0, 0xFF, 1);
              
              
                
                  if (u16TempValue == UserPrefSaturation)
                      return FALSE;
              
                  UserPrefSaturation = u16TempValue;
              
              
                  msAdjustVideoSaturation(MAIN_WINDOW,UserPrefSaturation);
                  return TRUE;
              }
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 58  

              WORD GetSaturationValue( void )
              {
                  WORD temp;
                  temp = GetScale100Value( UserPrefSaturation, 0x00, 0xFF );
                  return temp;
              }
              
              
              Bool AdjustVideoHUE(MenuItemActionType enAction)
              {
                  WORD u16TempValue;
              
                  u16TempValue = DecIncValue(enAction, UserPrefHue, 0, 100, 1);
                
                  if (u16TempValue == UserPrefHue)
                      return FALSE;
              
                  UserPrefHue = u16TempValue;
              
                  msAdjustVideoHue(MAIN_WINDOW,UserPrefHue);
                  return TRUE;
              }
              WORD GetHueValue( void )
              {
                  WORD temp;
                  temp = GetScale100Value( UserPrefHue, 0x00, 100 );
                  return temp;
              }
              
              Bool SetGammaOnOff(void)
              {
                  if (UserPrefGamaOnOff == MenuItemIndex)
                      return FALSE;
                  UserPrefGamaOnOff = MenuItemIndex;
                  drvGammaOnOff(UserPrefGamaOnOff, MAIN_WINDOW);
                  drvGammaOnOff(UserPrefGamaOnOff, SUB_WINDOW);
              
                  Set_SaveMonitorSettingFlag();
                  return TRUE;
              }
              
              #endif
3537          //vs add ccflag
3538          ///////////////////////////////////////////////////////////////////////////
3539          //=======================================================
3540          #if ENABLE_FREESYNC
              BYTE GetSrcFreesyncFPS(void)
              {
                  BYTE xdata u8Vfreq = 0xFF;
                  DWORD xdata u32OvsPeriod,u8DivN;
                  WORD xdata u16TimeOutCnt;
                  WORD xdata u16IvsPrd_L;
                  BYTE xdata u8IvsPrd_H,u8DivN_L,u8DivN_H;
              
                  u16TimeOutCnt = 600;
                  while(u16TimeOutCnt!=0)
                  {
                      u16TimeOutCnt--;
                      u16IvsPrd_L = msRead2Byte(REG_3842);
                      u8IvsPrd_H = msReadByte(REG_3844);
              
                      u8DivN_L = msReadByte(REG_3819);
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 59  

                      u8DivN_H = msReadByte(REG_381C);
                      u8DivN=(DWORD)(((u8DivN_H&BIT0)<<4)|(u8DivN_L&0x0F));
                      u32OvsPeriod = ((DWORD)u8IvsPrd_H<<16)|u16IvsPrd_L;
                      if(u32OvsPeriod!=0)
                      {
                          u8Vfreq = (((DWORD)CRYSTAL_CLOCK )*(u8DivN+1)) / u32OvsPeriod;
                          break;
                      }
                  }
                  return u8Vfreq;
              }
              Bool SetDRRFunction(void)
              {
                  if (UserprefFreeSyncMode == MenuItemIndex)
                      return FALSE;
                  UserprefFreeSyncMode = MenuItemIndex;
                  Set_SaveMonitorSettingFlag();
              
                  msAPI_combo_IPEnableDDRFlag(UserprefFreeSyncMode);
                  return TRUE;
              }
              #endif
3579          
3580          
3581          WORD DecIncValue( MenuItemActionType action, WORD value, WORD minValue, WORD maxValue, BYTE step )
3582          {
3583   1          if( action == MIA_IncValue || action == MIA_InvDecValue )
3584   1          {
3585   2              if( value >= maxValue )
3586   2              {
3587   3                  return value;
3588   3              }
3589   2              minValue = value + step;
3590   2              if( minValue > maxValue )
3591   2              {
3592   3                  minValue = maxValue;
3593   3              }
3594   2              value = minValue;
3595   2          }
3596   1          else
3597   1              // Decrease value
3598   1          {
3599   2              if( value <= minValue )
3600   2              {
3601   3                  return value;
3602   3              }
3603   2              maxValue = value - step;
3604   2              if( maxValue < minValue )
3605   2              {
3606   3                  maxValue = minValue;
3607   3              }
3608   2              value = maxValue;
3609   2          }
3610   1          return value;
3611   1      }
3612          WORD GetScale100Value( WORD value, WORD minValue, WORD maxValue )
3613          {
3614   1          maxValue = ( maxValue <= minValue ) ? minValue : ( maxValue - minValue );
3615   1          //maxValue = maxValue - minValue;
3616   1          value = value - minValue;
3617   1          if( value > 650 )
3618   1          {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 60  

3619   2              value /= 2;
3620   2              maxValue /= 2;
3621   2          }
3622   1          value = (( WORD )value * 100 + maxValue / 2 ) / maxValue;
3623   1          value %= 101;
3624   1          return value;
3625   1      }
3626          
3627          void SetOSDTimer(BYTE osdtime)
3628          { OsdCounter=osdtime;
3629   1          Clr_OsdTimeoutFlag();
3630   1      }
3631          Bool ResetOsdTimer( void )
3632          {
3633   1          if( !FactoryModeFlag )
3634   1          {
3635   2              OsdCounter = UserPrefOsdTime;
3636   2          }
3637   1          if( MenuPageIndex == MainMenu && !FactoryModeFlag )
3638   1          {
3639   2              UserPrefLastMenuIndex = MenuItemIndex;
3640   2          }
3641   1      
3642   1      #if EN_HotKeyTimes
                   if(MenuPageIndex == HotKeyShowTimes 
              #if EN_HotKeyXINGZHUN
                  ||(MenuPageIndex==HotXINGZHUN1)
                ||(MenuPageIndex==HotXINGZHUN2)
                ||(MenuPageIndex==HotXINGZHUN3)
                ||(MenuPageIndex==HotXINGZHUN4)
                ||(MenuPageIndex==HotXINGZHUN5)
                ||(MenuPageIndex==HotXINGZHUN6)
              #endif
                   )
                    {
                     OsdCounter = 0;
                   }
              
              #endif    
3658   1        
3659   1          //OsdCounter=0;
3660   1          return TRUE;
3661   1      }
3662          Bool EnablePowerDownCounter( void )
3663          {
3664   1          PowerDownCounter = 3;
3665   1      
3666   1          return TRUE;
3667   1      }
3668          
3669          Bool PowerOffSystem( void )
3670          {
3671   1          Clr_PowerOnFlag();
3672   1      
3673   1        if(!PowerOnFlag)
3674   1        {
3675   2          hw_SetAmberLed();
3676   2          hw_SetGreenLed();
3677   2        }
3678   1         else
3679   1          {
3680   2          Power_TurnOffLed();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 61  

3681   2          printMsg("788888");
3682   2         }
3683   1          
3684   1      #if AudioFunc
3685   1          mStar_AdjustVolume(0);
3686   1      #endif
3687   1      
3688   1      #if ENABLE_HDMI
3689   1          mstar_HDMIAudioMute( 0 );
3690   1          hw_SetMute();
3691   1      #endif
3692   1      
3693   1      
3694   1          Clr_FactoryModeFlag();
3695   1          Clr_DisplayLogoFlag();
3696   1          Clr_DoModeSettingFlag();
3697   1          Clr_DoBurninModeFlag(); //2009-10-13  add
3698   1          //msWriteByte( BK0_32, 0 ); // disable background color function.
3699   1          drvOSD_FrameColorEnable(FALSE);
3700   1          Clr_PowerSavingFlag(); // 091014
3701   1      
3702   1      #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #else
3705   1      #if (MS_PM)
3706   1          SaveMonitorSetting();   //110921 Rick modified - A032
3707   1      #else
                  Set_FlashForceSaveMonitorFlag();
              #endif
3710   1      #endif
3711   1      
3712   1      #if 0//ENABLE_HDCP//1
                  msPullLowHPD2();
              #endif
3715   1      
3716   1      
3717   1      #if ENABLE_DP_INPUT
                    #if ((CHIP_ID == CHIP_TSUMC)||(CHIP_ID==CHIP_TSUMK)||( CHIP_ID == CHIP_TSUMD)||( CHIP_ID == CHIP_TSU
             -M9)||( CHIP_ID == CHIP_TSUMF))
                              MenuFunc_printMsg(" DP -----DC OFF ");
                              DPOffSQ();
                              #if DP_DCOFFHPDLOW
                              DPRxHPDDisable();
                              #endif
                    #else
                              //DPRxDCHPD( TRUE );
                    #endif
              #endif
3728   1      
3729   1          Power_PowerOffSystem();
3730   1      
3731   1          Clr_PowerSavingFlag();
3732   1      
3733   1      #if (MS_PM)
3734   1          msPM_SetFlag_PMDCoff();
3735   1      #else
              
                  #if (ENABLE_POWEROFF_1X_MCU_CLK)
                  mStar_MCU_Clock_Select(FALSE);
                  #endif
              
                  #if ENABLE_POWER_BOARD_CONTROL
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 62  

                  Set_PowerBoardSaving_Pin();
                  #endif
              
              #endif
3746   1      
3747   1      
3748   1          return TRUE;
3749   1      }
3750          
3751          Bool PowerOnSystem( void )
3752          {
3753   1      #if ENABLE_POWER_BOARD_CONTROL
                  Clr_PowerBoardSaving_Pin();
              #endif
3756   1      
3757   1          Set_PowerOnFlag();
3758   1          Clr_InputTimingChangeFlag();
3759   1      
3760   1      #if !MS_PM
                  #if (ENABLE_POWEROFF_1X_MCU_CLK)
                  mStar_MCU_Clock_Select(TRUE);
                  #endif
              #endif
3765   1      
3766   1      #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #else
3769   1          #if (MS_PM)
3770   1          SaveMonitorSetting();
3771   1          #else
                  Set_FlashForceSaveMonitorFlag();
                  #endif
3774   1      #endif
3775   1      
3776   1      #if Enable_LED
                Power_TurnOnAmberLed();//
                printMsg("8888");
              #else
3780   1        Power_TurnOnGreenLed();
3781   1      #endif
3782   1          
3783   1          Power_PowerOnSystem();
3784   1      
3785   1      
3786   1      #if ENABLE_DP_INPUT
              #if ((CHIP_ID == CHIP_TSUMC)||(CHIP_ID==CHIP_TSUMK)||( CHIP_ID == CHIP_TSUMD)||( CHIP_ID == CHIP_TSUM9)||(
             - CHIP_ID == CHIP_TSUMF))
                  #if  !DP_DCOFFHPDLOW
                     if(DP_GetSquelch( 0x2FFFE ) && !(DPFastLink(TRUE)))
              #endif
              #endif
                      {
                          DPRxHPDDisable();
                          ForceDelay1ms(100);
                          DPRxHPDEnable();
                          MenuFunc_printMsg(" DC On/Off HPD ");
                      }
              
              #endif
3800   1      
3801   1          Clr_InputTimingChangeFlag();
3802   1         
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 63  

3803   1          mStar_SetupInputPort();
3804   1      
3805   1      #if DisplayPowerOnLogo
3806   1          if(!(FactoryModeFlag))
3807   1          {
3808   2              Set_DisplayLogoFlag();
3809   2              msWriteByte( IOSDC2, 0x02 ); //Disable color bit setting
3810   2          }
3811   1      #endif
3812   1          mStar_SetupFreeRunMode();
3813   1          Set_InputTimingChangeFlag();
3814   1      #if ENABLE_LED_CONTROLLER
                #if LED_AUTO_RECOVER
                  msLED_InitRecoveryVariables();
                #endif
              #endif
3819   1      
3820   1          return TRUE;
3821   1      }
3822          
3823          Bool EnterRootMenu( void )
3824          {
3825   1          OsdCounter = 0;
3826   1          return TRUE;
3827   1      }
3828          
3829          Bool AdjustContrast( MenuItemActionType action )
3830          {
3831   1          WORD tempValue;
3832   1          tempValue = DecIncValue( action, UserPrefContrast, MinContrastValue, MaxContrastValue, 1 );
3833   1          if( tempValue == UserPrefContrast )
3834   1          {
3835   2              return FALSE;
3836   2          }
3837   1          UserPrefContrast = tempValue;
3838   1           UserPrefContrastTemp=UserPrefContrast; 
3839   1          mStar_AdjustContrast( UserPrefContrast );
3840   1      #if 0 
                  if( UserPrefColorTemp == CTEMP_USER )
                  {
                      UserPrefContrastUser = UserPrefContrast;
                  }
                  else if( UserPrefColorTemp == CTEMP_9300K )
                  {
                      UserPrefContrastCool1 = UserPrefContrast;
                      if( FactoryModeFlag )
                          FUserPrefContrastCool1 = UserPrefContrast;
                  }
                  else if( UserPrefColorTemp == CTEMP_5400K )
                  {
                      UserPrefContrastWarm1 = UserPrefContrast;
                      if( FactoryModeFlag )
                          FUserPrefContrastWarm1 = UserPrefContrast;
                  }
                  else if( UserPrefColorTemp == CTEMP_6500K )
                  {
                      UserPrefContrastNormal = UserPrefContrast;
                      if( FactoryModeFlag )
                          FUserPrefContrastNormal = UserPrefContrast;
                  }
                  else if( UserPrefColorTemp == CTEMP_SRGB )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 64  

                      UserPrefContrastSRGB = UserPrefContrast;
                  }
              #endif  
3868   1      #if ENABLE_DPS
3869   1          if(!REG_DPS_RUN_Flag)
3870   1          {
3871   2              if(UserPrefECOMode>ECO_Standard)
3872   2              {
3873   3                  msAdjustVideoContrast(SUB_WINDOW,GetSubWndRealContrast(tempValue) );
3874   3              }
3875   2              else
3876   2              {
3877   3                  mStar_AdjustContrast(tempValue);
3878   3              }
3879   2          }
3880   1      #endif
3881   1      
3882   1          return TRUE;
3883   1      }
3884          
3885          WORD GetContrastValue( void )
3886          {
3887   1          //return GetScale100Value(UserPrefContrast, MinContrastValue, MaxContrastValue);
3888   1          WORD temp;
3889   1          temp = GetScale100Value( UserPrefContrast, MinContrastValue, MaxContrastValue );
3890   1          return temp;
3891   1      }
3892          //====================================================
3893          Bool AdjustBrightness( MenuItemActionType action )
3894          {
3895   1          WORD tempValue;
3896   1          tempValue = DecIncValue( action, UserPrefBrightness, 0, 100, 1 );
3897   1          if( tempValue == UserPrefBrightness )
3898   1          {
3899   2              return FALSE;
3900   2          }
3901   1          UserPrefBrightness = tempValue;
3902   1          UserPrefBrightnessTemp=UserPrefBrightness;
3903   1          mStar_AdjustBrightness( UserPrefBrightness );
3904   1      #if 0 
                  if( UserPrefColorTemp == CTEMP_USER )
                      UserPrefBrightnessUser = UserPrefBrightness;
                  else if( UserPrefColorTemp == CTEMP_9300K )
                  {
                      UserPrefBrightnessCool1 = UserPrefBrightness;
                      if( FactoryModeFlag )
                          FUserPrefBrightnessCool1 = UserPrefBrightness;
                  }
                  else if( UserPrefColorTemp == CTEMP_5400K )
                  {
                      UserPrefBrightnessWarm1 = UserPrefBrightness;
                      if( FactoryModeFlag )
                          FUserPrefBrightnessWarm1 = UserPrefBrightness;
                  }
                  else if( UserPrefColorTemp == CTEMP_6500K )
                  {
                      UserPrefBrightnessNormal = UserPrefBrightness;
                      if( FactoryModeFlag )
                          FUserPrefBrightnessNormal = UserPrefBrightness;
                  }
                  else if( UserPrefColorTemp == CTEMP_SRGB )
                  {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 65  

                      UserPrefBrightnessSRGB = UserPrefBrightness;
                  }
              #endif
3930   1      #if ENABLE_DPS
3931   1      if(!REG_DPS_RUN_Flag)
3932   1          mStar_AdjustBrightness(tempValue);
3933   1      #endif
3934   1      #if ENABLE_DPS
3935   1      #if DPS_UserBrightControl_EN
3936   1          REG_DPS_UserBrightContlGain = UserPrefBrightness;//(float)USER_PREF_BRIGHTNESS * 256 / 100;
3937   1      #else
                  REG_DPS_UserBrightContlGain = 100;
              #endif
3940   1      #endif
3941   1          return TRUE;
3942   1      }
3943          
3944          WORD GetBrightnessValue( void )
3945          {
3946   1          return UserPrefBrightness; //GetScale100Value(UserPrefBrightness, 0, 100);
3947   1      }
3948          
3949          Bool AdjustFocus( MenuItemActionType action )
3950          {
3951   1          WORD tempValue;
3952   1          tempValue = DecIncValue( action, UserPrefPhase, 0, MAX_PHASE_VALUE, 1 );
3953   1          if( tempValue == UserPrefPhase )
3954   1          {
3955   2              return FALSE;
3956   2          }
3957   1          UserPrefPhase = tempValue;
3958   1          //msADC_AdjustPhase( UserPrefPhase );
3959   1          drvADC_SetPhaseCode(UserPrefPhase);
3960   1          return TRUE;
3961   1      }
3962          
3963          WORD GetFocusValue( void )
3964          {
3965   1          return (!CURRENT_INPUT_IS_VGA()) ? 50 : GetScale100Value( UserPrefPhase, 0, MAX_PHASE_VALUE );
3966   1      }
3967          
3968          //====================================================
3969          
3970          Bool AdjustClock( MenuItemActionType action )
3971          {
3972   1          WORD tempValue;
3973   1          tempValue = DecIncValue( action, UserPrefHTotal, MinClock, MaxClock, 1 );
3974   1          if( tempValue == UserPrefHTotal )
3975   1          {
3976   2              return FALSE;
3977   2          }
3978   1          UserPrefHTotal = tempValue;
3979   1          //msADC_AdjustHTotal( UserPrefHTotal );
3980   1      #if !ENABLE_MENULOAD        //111110 Rick re-Enable wait Blanking before VTOTAL adjustment while disable M
             -enuload function - B40141
3981   1          mStar_WaitForDataBlanking();            //110930 Rick add for avoid noise while adjust clock value - C
             -_FOS_5
3982   1      #endif
3983   1          drvADC_AdjustHTotal(UserPrefHTotal);
3984   1          return TRUE;
3985   1      }
3986          
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 66  

3987          WORD GetClockValue( void ) // adjust range
3988          {
3989   1          return (!CURRENT_INPUT_IS_VGA()) ? 50 : GetScale100Value( UserPrefHTotal, MinClock, MaxClock );
3990   1      }
3991          //#define MaxHStart   UserPrefAutoHStart+50
3992          //#define MinHStart   UserPrefAutoHStart-50
3993          //====================================================
3994          Bool AdjustHPosition( MenuItemActionType action )
3995          {
3996   1          WORD tempValue;
3997   1          tempValue = DecIncValue( action, UserPrefHStart, MinHStart, MaxHStart, 1 );
3998   1          if( tempValue == UserPrefHStart )
3999   1          {
4000   2              return FALSE;
4001   2          }
4002   1          UserPrefHStart = tempValue;
4003   1          mStar_AdjustHPosition( UserPrefHStart );
4004   1          return TRUE;
4005   1      }
4006          
4007          WORD GetHPositionValue( void )
4008          {
4009   1          return (!CURRENT_INPUT_IS_VGA()) ? 50 : 100 - GetScale100Value( UserPrefHStart, MinHStart, MaxHStart )
             -; //, 0);
4010   1      }
4011          //====================================================
4012          //#define MaxVStart 2*UserPrefAutoVStart-1
4013          //#define MinVStart 1  // 2006/10/26 4:18PM by Emily  0
4014          //====================================================
4015          Bool AdjustVPosition( MenuItemActionType action )
4016          {
4017   1          WORD tempValue;
4018   1              tempValue = DecIncValue( action, UserPrefVStart, MinVStart, MaxVStart, 1 );
4019   1          if( tempValue == UserPrefVStart )
4020   1          {
4021   2              return FALSE;
4022   2          }
4023   1          UserPrefVStart = tempValue;
4024   1          mStar_AdjustVPosition( UserPrefVStart );
4025   1          return TRUE;
4026   1      }
4027          
4028          WORD GetVPositionValue( void )
4029          {
4030   1              return (!CURRENT_INPUT_IS_VGA()) ? 50 : GetScale100Value( UserPrefVStart, MinVStart, MaxVStart );
4031   1      }
4032          #if 0//EN_HotKeyTimes
              Bool AdjustTimes(void)
              {
                  if (MenuPageIndex==HotKeyTimes)
                  {
                
                    if(MenuItemIndex==Times10TextItem)
                      HotKeyTimes_Minutes=10;//UserPrefSelectInputType=Input_DVI;
                    else if(MenuItemIndex==Times20TextItem)
                      HotKeyTimes_Minutes=20;//UserPrefSelectInputType=Input_HDMI;
                    else if (MenuItemIndex==Times30TextItem)
                      HotKeyTimes_Minutes=30;//UserPrefSelectInputType=Input_Displayport;
                     else if(MenuItemIndex==Times40TextItem)
                      HotKeyTimes_Minutes=40;//UserPrefSelectInputType=Input_Analog1;
                    else if(MenuItemIndex==Times50TextItem)
                      HotKeyTimes_Minutes=50;//UserPrefSelectInputType=Input_HDMI;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 67  

                    else if (MenuItemIndex==Times60TextItem)
                      HotKeyTimes_Minutes=60;//UserPrefSelectInputType=Input_Displayport;
                    else if (MenuItemIndex==Times90TextItem)
                      HotKeyTimes_Minutes=90;//UserPrefSelectInputType=Input_Displayport;
              
                    
                         printData("\n xxxxxHotKeyTimes_Minutes=%d \n",HotKeyTimes_Minutes);
                  //  ExecuteKeyEvent( MIA_HotShowTimes);
              
                    //  MenuPageIndex=HotKeyShowTimes;
                      //MenuPageIndex=HotKeyShowTimes;
                      //menuAction=MIA_RedrawMenu;
                      //KeypadButton=BTN_Repeat;
                      //MenuItemIndex=0;
                    
                    }
                    return TRUE;
              }
              
              #endif
4068          
4069          #if DualInput
4070          #if OSD_INPUT_SUBMENU_ENABLE
4071          Bool AdjustInputType(MenuItemActionType action)
4072          {
4073   1        if(action==MIA_IncValue||action==MIA_DecValue)
4074   1          UserPrefSelectInputType=(UserPrefSelectInputType+1)%Input_Nums; 
4075   1        return TRUE;  
4076   1      }
4077          #endif
4078          Bool SwitchInput(void)
4079          {
4080   1      #if KeyInputSelectMenu
4081   1        if (MenuPageIndex==HotKeyInputSelectMenu)
4082   1        {
4083   2          #if InputType_Digital
                  if(MenuItemIndex==mDVITextItem)
                    UserPrefSelectInputType=Input_DVI;
                  else 
                  #endif
4088   2          #if InputType_HDMI
4089   2            if(MenuItemIndex==mHDMITextItem)
4090   2             UserPrefSelectInputType=Input_HDMI;
4091   2          #endif
4092   2          #if ENABLE_DP_INPUT
                  else if (MenuItemIndex==mDPTextItem)
                    UserPrefSelectInputType=Input_Displayport;
                  #endif
4096   2        #if(InputType_Analog1)
4097   2          else if(MenuItemIndex==mVGATextItem)
4098   2            UserPrefSelectInputType=Input_Analog1;
4099   2          #endif
4100   2        }
4101   1      #endif
4102   1      #if ENABLE_DEBUG
4103   1      printData("SwitchInput SrcInputType==%d", SrcInputType);
4104   1      printData("UserPrefInputPriorityType==%d", UserPrefSelectInputType);
4105   1      #endif  
4106   1      
4107   1        if (SrcInputType== UserPrefSelectInputType)
4108   1          return FALSE;
4109   1        else
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 68  

4110   1        SrcInputType=UserPrefSelectInputType;  
4111   1        //UserPrefInputType=SrcInputType = Input_Analog1; 
4112   1        
4113   1          #if 0 //AudioFunc
                #if Audio_Switch
                  if((SrcInputType==Input_HDMI)||(SrcInputType==Input_DP))
                    UserPrefHDMIAudioType=Audio_HDMI; 
                  else
                    UserPrefHDMIAudioType=Audio_LineIn;
                  
                    SetAudioType(UserPrefHDMIAudioType);
                #endif
                  #endif
4123   1      
4124   1        //Set_SaveSettingFlag();
4125   1        Power_TurnOffPanel();
4126   1        mStar_SetupInputPort();
4127   1        Set_InputTimingChangeFlag();
4128   1        SrcFlags |= SyncLoss;
4129   1        
4130   1        return TRUE;
4131   1      }
4132          #endif
4133          
4134          #if AudioFunc
4135          Bool AdjustVolume( MenuItemActionType action )
4136          {
4137   1          WORD tempValue;
4138   1          tempValue = DecIncValue( action, UserPrefVolume, MinVolume, MaxVolume, 1 );
4139   1          if( tempValue == UserPrefVolume )
4140   1          {
4141   2              return FALSE;
4142   2          }
4143   1          UserPrefVolume = tempValue;
4144   1          mStar_AdjustVolume( UserPrefVolume );
4145   1          return TRUE;
4146   1      }
4147          WORD GetVolumeValue( void )
4148          {
4149   1          return GetScale100Value( UserPrefVolume, MinVolume, MaxVolume );
4150   1      }
4151          #if (ENABLE_HDMI || ENABLE_DP_INPUT) && MS_DAC
              Bool AdjustAudioSource( void )
              {
                  mStar_AdjustVolume(0);
                  UserPrefAudioSource = ( UserPrefAudioSource + 1 ) % 2;
              
                  if (UserPrefAudioSource == AUDIO_DIGITAL)
                  {
                  #if ENABLE_HDMI
                      if( gScInfo.InputTmdsType == TMDS_HDMI && CURRENT_INPUT_IS_HDMI())//SrcInputType >= Input_Digital 
             -)
                      {
                          msAudioLineout_SourceSel( E_LINEOUT_FROM_DAC );
                          msAudioDPGA_SetVolume( E_AUDIO_LEFT_RIGHT_CH, 0x00 );   //111118 Modify
                          #if !USE_DAC_ADJ
                          msAudioLineOutGain( 0x3D );
                          #endif
                      }
                  #endif
                  #if ENABLE_DP_INPUT
                      if(CURRENT_INPUT_IS_DISPLAYPORT())//(SrcInputType==Input_Displayport)
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 69  

                      {
                          msAudioLineout_SourceSel( E_LINEOUT_FROM_DAC );
                          msAudioDPGA_SetVolume( E_AUDIO_LEFT_RIGHT_CH, 0x00 );   //111118 Modify
                          #if !USE_DAC_ADJ
                          msAudioLineOutGain( 0x3D );
                          #endif
                      }
              
                  #endif
                  }
                  else
                  {
                      msAudioLineout_SourceSel( E_LINEOUT_FROM_LINEIN0 );
                      msAudioDPGA_SetVolume( E_AUDIO_LEFT_RIGHT_CH, 0x00 );   //111118 Modify
                      #if !USE_DAC_ADJ
                      msAudioLineOutGain( 0x27 );
                      #endif
                  }
                  mStar_AdjustVolume( UserPrefVolume );
                  return TRUE;
              }
              #endif
4193          
4194          Bool SwitchMute(void)
4195          {
4196   1        if (UserOSDMuteOnFlag)
4197   1        {
4198   2          hw_ClrMute();
4199   2          UserOSDMuteOnFlag=0;
4200   2        }
4201   1        else
4202   1        {
4203   2          hw_SetMute();
4204   2          UserOSDMuteOnFlag=1;
4205   2      
4206   2        }
4207   1          SaveMonitorSetting(); // need changed again
4208   1          return TRUE;
4209   1      }
4210          
4211          #endif
4212          
4213          #if Audio_Switch
              Bool SetAudioType(AudioType Type)
              {
                if (Type == Audio_LineIn)
                {
                  msAudioLineout_SourceSel(E_LINEOUT_FROM_LINEIN0);
                  msAudioLineOutGain(0x27); // 091014 coding, max 1.4Vrms
                }
                else if (Type == Audio_HDMI)
                {
                  msAudioLineout_SourceSel(E_LINEOUT_FROM_DAC);
                  msAudioLineOutGain(0x3D); // 091014 coding, max 1.4Vrms
                }
              
                       //msAudioDPGA_SetVolume( E_AUDIO_LEFT_RIGHT_CH, 0x0000 );  //20121004
                       mStar_AdjustVolume(UserPrefVolume);
                return TRUE;
              }
              Bool AdjustAudioType(MenuItemActionType action)
              {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 70  

                BYTE temp;
                if((SrcInputType==Input_Analog1)||(SrcInputType==Input_DVI))
                  return FALSE;
                temp = UserPrefHDMIAudioType;
                if (action == MIA_DecValue)
                {
                  UserPrefHDMIAudioType = (UserPrefHDMIAudioType + AUdioType_Nums - 1) % AUdioType_Nums;
                }
                else
                {
                  UserPrefHDMIAudioType = (UserPrefHDMIAudioType + 1) % AUdioType_Nums;
                }
                if (temp == UserPrefHDMIAudioType)
                  return FALSE;
              
                SetAudioType(UserPrefHDMIAudioType);
                
                  #if USEFLASH
                UserPref_EnableFlashSaveBit(bFlashSaveMonitorBit); 
                  #else
                NVRam_WriteByte(NVRAM_ADDR_MointorMember(OsdSelectItemFlag), OsdSelectItemFlags); 
                #endif
                return TRUE;
              }
              #endif
4258          
4259          Bool AdjustOSDHPosition( MenuItemActionType action )
4260          {
4261   1          WORD tempValue;
4262   1          tempValue = DecIncValue( action, UserPrefOsdHStart, 0, 100, 5 ); //0729 New Spec
4263   1          if( tempValue == UserPrefOsdHStart )
4264   1          {
4265   2              return FALSE;
4266   2          }
4267   1          UserPrefOsdHStart = tempValue;
4268   1          mStar_WaitForDataBlanking();
4269   1          Osd_SetPosition( UserPrefOsdHStart, UserPrefOsdVStart );
4270   1          return TRUE;
4271   1      }
4272          WORD GetOSDHPositionValue( void )
4273          {
4274   1          return GetScale100Value( UserPrefOsdHStart, 0, 100 );
4275   1      }
4276          //================================================================================
4277          Bool AdjustOSDVPosition( MenuItemActionType action )
4278          {
4279   1          WORD tempValue;
4280   1          tempValue = DecIncValue( action, UserPrefOsdVStart, 0, 100, 5 ); //0729 New Spec
4281   1          if( tempValue == UserPrefOsdVStart )
4282   1          {
4283   2              return FALSE;
4284   2          }
4285   1          UserPrefOsdVStart = tempValue;
4286   1          mStar_WaitForDataBlanking();
4287   1          if (UserPrefOsdVStart == 100)
4288   1              Delay1ms(8);
4289   1          Osd_SetPosition( UserPrefOsdHStart, UserPrefOsdVStart );
4290   1          return TRUE;
4291   1      }
4292          WORD GetOSDVPositionValue( void )
4293          {
4294   1          return GetScale100Value( UserPrefOsdVStart, 0, 100 );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 71  

4295   1      }
4296          
4297          Bool AdjustOSDTime( MenuItemActionType action )
4298          {
4299   1          WORD tempValue;
4300   1          tempValue = DecIncValue( action, UserPrefOsdTime, 5, 60, 5 );
4301   1          if( tempValue == UserPrefOsdTime )
4302   1          {
4303   2              return FALSE;
4304   2          }
4305   1          UserPrefOsdTime = tempValue;
4306   1          return TRUE;
4307   1      }
4308          WORD GetOSDTimeValue(void)
4309          {
4310   1          return UserPrefOsdTime;
4311   1      }
4312          WORD GetOSDTime100Value( void )
4313          {
4314   1          return GetScale100Value(UserPrefOsdTime, 0, 60);;
4315   1      }
4316          
4317          Bool AdjustOSDTransparency( MenuItemActionType action )
4318          {
4319   1          WORD tempValue;
4320   1      
4321   1          tempValue=DecIncValue( action, UserPrefOsdTransparency, 0, 4, 1 );
4322   1      
4323   1          if (tempValue==UserPrefOsdTransparency)
4324   1              return FALSE;
4325   1          UserPrefOsdTransparency=tempValue;
4326   1      
4327   1          Osd_SetTransparency(UserPrefOsdTransparency);
4328   1      
4329   1          return TRUE;
4330   1      }
4331          WORD GetOSDTransparencyValue( void )
4332          {
4333   1          return GetScale100Value(UserPrefOsdTransparency, 0, 4); //UserPrefOsdTransparency;
4334   1      }
4335          
4336          Bool AdjustRedColor( MenuItemActionType action )
4337          {
4338   1          WORD tempValue;
4339   1          tempValue = DecIncValue( action, UserPrefRedColor, MinColorValue, MaxColorValue, (( UserPrefColorTemp 
             -== CTEMP_USER ) ? 2 : 1 ) );
4340   1          if( tempValue == UserPrefRedColor )
4341   1          {
4342   2              return FALSE;
4343   2          }
4344   1          UserPrefRedColor = tempValue;
4345   1          UserPrefRedColorUser = UserPrefRedColor;
4346   1      #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
4349   1          mStar_AdjustRedColor( UserPrefRedColorUser, UserPrefContrast );
4350   1      #endif
4351   1      
4352   1          Set_SaveSettingFlag();
4353   1          return TRUE;
4354   1      }
4355          Bool AdjustGreenColor( MenuItemActionType action )
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 72  

4356          {
4357   1          WORD tempValue;
4358   1          tempValue = DecIncValue( action, UserPrefGreenColor, MinColorValue, MaxColorValue, (( UserPrefColorTem
             -p == CTEMP_USER ) ? 2 : 1 ) );
4359   1          if( tempValue == UserPrefGreenColor )
4360   1          {
4361   2              return FALSE;
4362   2          }
4363   1          UserPrefGreenColor = tempValue;
4364   1          UserPrefGreenColorUser = UserPrefGreenColor;
4365   1      #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
4368   1          mStar_AdjustGreenColor( UserPrefGreenColorUser, UserPrefContrast );
4369   1      #endif
4370   1      
4371   1        Set_SaveSettingFlag();
4372   1          return TRUE;
4373   1      }
4374          Bool AdjustBlueColor( MenuItemActionType action )
4375          {
4376   1          WORD tempValue;
4377   1          tempValue = DecIncValue( action, UserPrefBlueColor, MinColorValue, MaxColorValue, (( UserPrefColorTemp
             - == CTEMP_USER ) ? 2 : 1 ) );
4378   1          if( tempValue == UserPrefBlueColor )
4379   1          {
4380   2              return FALSE;
4381   2          }
4382   1          UserPrefBlueColor = tempValue;
4383   1          UserPrefBlueColorUser = UserPrefBlueColor;
4384   1      #if UsesRGB
                  mStar_AdjustContrast( UserPrefContrast );
              #else
4387   1          mStar_AdjustBlueColor( UserPrefBlueColorUser, UserPrefContrast );
4388   1      #endif
4389   1      
4390   1        Set_SaveSettingFlag();
4391   1          return TRUE;
4392   1      }
4393          
4394          WORD GetRedColorValue100(void)
4395          {
4396   1           if(UserPrefColorTemp==CTEMP_6500K)
4397   1           return GetScale100Value(UserPrefRedColorNormal, MinColorValue, MaxColorValue);
4398   1           else if(UserPrefColorTemp==CTEMP_9300K)
4399   1           return GetScale100Value(UserPrefRedColorCool1, MinColorValue, MaxColorValue);
4400   1        #if FactoryAuto_5400K  
4401   1           else if(UserPrefColorTemp==CTEMP_5400K)
4402   1           return GetScale100Value(UserPrefRedColorWarm1, MinColorValue, MaxColorValue);
4403   1         #endif
4404   1           else
4405   1             return GetScale100Value(UserPrefRedColorUser, MinColorValue, MaxColorValue);
4406   1      }
4407          
4408          WORD GetGreenColorValue100(void)
4409          {
4410   1           if(UserPrefColorTemp==CTEMP_6500K)
4411   1           return GetScale100Value(UserPrefGreenColorNormal, MinColorValue, MaxColorValue);
4412   1           else if(UserPrefColorTemp==CTEMP_9300K)
4413   1           return GetScale100Value(UserPrefGreenColorCool1, MinColorValue, MaxColorValue);
4414   1      #if FactoryAuto_5400K
4415   1           else if(UserPrefColorTemp==CTEMP_5400K)
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 73  

4416   1           return GetScale100Value(UserPrefGreenColorWarm1, MinColorValue, MaxColorValue);
4417   1      #endif
4418   1           else
4419   1           return GetScale100Value(UserPrefGreenColorUser, MinColorValue, MaxColorValue);
4420   1      
4421   1      }
4422          
4423          WORD GetBlueColorValue100(void)
4424          {
4425   1           if(UserPrefColorTemp==CTEMP_6500K)
4426   1           return GetScale100Value(UserPrefBlueColorNormal, MinColorValue, MaxColorValue);
4427   1           else if(UserPrefColorTemp==CTEMP_9300K)
4428   1           return GetScale100Value(UserPrefBlueColorCool1, MinColorValue, MaxColorValue);
4429   1          #if FactoryAuto_5400K
4430   1           else if(UserPrefColorTemp==CTEMP_5400K)
4431   1           return GetScale100Value(UserPrefBlueColorWarm1, MinColorValue, MaxColorValue);
4432   1          #endif
4433   1           else
4434   1             return GetScale100Value(UserPrefBlueColorUser, MinColorValue, MaxColorValue);
4435   1      
4436   1      }
4437          
4438          Bool SetColorTemperature9300K(void)
4439          {
4440   1        if (!UserPrefDcrMode)
4441   1            mStar_AdjustBrightness(UserPrefBrightness);
4442   1            mStar_AdjustRedColor(UserPrefRedColorCool1, UserPrefContrast);
4443   1            mStar_AdjustGreenColor(UserPrefGreenColorCool1, UserPrefContrast);
4444   1            mStar_AdjustBlueColor(UserPrefBlueColorCool1, UserPrefContrast);
4445   1      
4446   1        return TRUE;
4447   1      }
4448          
4449          Bool SetColorTemperature6500K(void)
4450          {
4451   1        if (!UserPrefDcrMode)
4452   1             mStar_AdjustBrightness(UserPrefBrightness);
4453   1             mStar_AdjustRedColor(UserPrefRedColorNormal, UserPrefContrast);
4454   1             mStar_AdjustGreenColor(UserPrefGreenColorNormal, UserPrefContrast);
4455   1             mStar_AdjustBlueColor(UserPrefBlueColorNormal, UserPrefContrast);
4456   1        return TRUE;
4457   1      }
4458          #if FactoryAuto_5400K  
4459          Bool SetColorTemperature5400K(void)
4460          {
4461   1        if (!UserPrefDcrMode)
4462   1             mStar_AdjustBrightness(UserPrefBrightness);
4463   1             mStar_AdjustRedColor(UserPrefRedColorWarm1, UserPrefContrast);
4464   1             mStar_AdjustGreenColor(UserPrefGreenColorWarm1, UserPrefContrast);
4465   1             mStar_AdjustBlueColor(UserPrefBlueColorWarm1, UserPrefContrast);
4466   1        return TRUE;
4467   1      }
4468          #endif
4469          
4470          Bool SetColorTemperatureUser(void)
4471          {
4472   1        if (!UserPrefDcrMode)
4473   1             mStar_AdjustBrightness(UserPrefBrightness);
4474   1      #if LowBlueLight
                if(UserPrefLowBlueMode==BlueLight_Browsing)
                {
                  UserPrefBlueColorUser=97;   /// 114*85
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 74  

                }
                else if (UserPrefLowBlueMode==BlueLight_Read)
                {
                  UserPrefBlueColorUser=80;   /// /// 114*70
                }
                else if(UserPrefLowBlueMode==BlueLight_Video)
                {
                  UserPrefBlueColorUser=57;    /// 114*50
                }
                else if (UserPrefLowBlueMode==BlueLight_lowlight)
                {
                  UserPrefBlueColorUser=34;   /// 114*30
                }
                else  //BlueLight_Off
                {
                  UserPrefBlueColorUser=DefColorUser;  
                }
              #endif    
4496   1            mStar_AdjustRedColor(UserPrefRedColorUser, UserPrefContrast);
4497   1            mStar_AdjustGreenColor(UserPrefGreenColorUser, UserPrefContrast);
4498   1            mStar_AdjustBlueColor(UserPrefBlueColorUser, UserPrefContrast);
4499   1        return TRUE;
4500   1      }
4501          
4502          Bool SetColorTemp( void )
4503          {
4504   1          ReadColorTempSetting();
4505   1         // if( UserPrefColorTemp == CTEMP_SRGB )
4506   1         // {
4507   1           //   UserPrefECOMode = ECO_Standard;
4508   1          //}
4509   1          return TRUE;
4510   1      }
4511          Bool AdjustColorTempMode( MenuItemActionType action )
4512          {
4513   1          BYTE temp;
4514   1          temp = UserPrefColorTemp;
4515   1          if( action == MIA_DecValue )
4516   1          {
4517   2              UserPrefColorTemp = ( UserPrefColorTemp + CTEMP_Nums - 1 ) % CTEMP_Nums;
4518   2          }
4519   1          else
4520   1          {
4521   2              UserPrefColorTemp = ( UserPrefColorTemp + 1 ) % CTEMP_Nums;
4522   2          }
4523   1      
4524   1          if( UserPrefDcrMode )
4525   1          {
4526   2              UserPrefDcrMode = 0;
4527   2              #if !ENABLE_HDMI
                      #if MWEFunction
                      if( UserPrefColorFlags )
                          msAccOnOff( 1 );
                      else
                      #endif
                          msAccOnOff( 0 );
                      #endif
4535   2              msDlcOnOff( 0 );
4536   2          }
4537   1      
4538   1          if( temp == UserPrefColorTemp )
4539   1              return FALSE;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 75  

4540   1      
4541   1         if ( UserPrefColorTemp == CTEMP_6500K )
4542   1          {
4543   2            SetColorTemperature6500K();
4544   2          }
4545   1        else if ( UserPrefColorTemp == CTEMP_9300K )
4546   1          {
4547   2            SetColorTemperature9300K();
4548   2          }
4549   1        #if FactoryAuto_5400K
4550   1        else if ( UserPrefColorTemp == CTEMP_5400K )
4551   1          {
4552   2            SetColorTemperature5400K();
4553   2          }
4554   1        #endif  
4555   1        else if ( UserPrefColorTemp == CTEMP_USER )
4556   1          {
4557   2            SetColorTemperatureUser();
4558   2          }
4559   1      
4560   1          #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ColorTemp ), UserPrefColorTemp );
                  #else
4563   1          //SaveMonitorSetting();
4564   1          Set_FlashSaveMonitorFlag();
4565   1          #endif
4566   1          //msAccOnOff(0); // 2006/11/9 11:27PM by Emily test
4567   1      
4568   1      
4569   1          ReadColorTempSetting();
4570   1          //if( UserPrefECOMode != ECO_Standard )        //jeff add in 1112
4571   1              //UserPrefECOMode = ECO_Standard;
4572   1          return TRUE;
4573   1      }
4574          
4575          Bool AdjustLanguage(void)
4576          {
4577   1         
4578   1        if (UserPrefLanguage == MenuItemIndex)
4579   1              return FALSE;
4580   1          UserPrefLanguage = MenuItemIndex;
4581   1      
4582   1          Set_SaveSettingFlag();
4583   1          return TRUE;
4584   1      }
4585          
4586          
4587          Bool ResetAllSetting( void )   //
4588          {
4589   1        BYTE BackupLanguage;
4590   1          WORD hFreq, vFreq;
4591   1          hFreq = HFreq( SrcHPeriod );
4592   1          vFreq = VFreq( hFreq, SrcVTotal );
4593   1         
4594   1         Osd_Hide();
4595   1         
4596   1         UserPrefLanguage = LANG_Default; //xhq
4597   1         
4598   1         BackupLanguage = UserPrefLanguage;
4599   1      
4600   1         
4601   1      #if 1
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 76  

4602   1           if(FactoryModeFlag )  //
4603   1           {
4604   2         
4605   2           Init_FactorySetting();
*** WARNING C206 IN LINE 4605 OF ..\UI\MenuFunc.c: 'Init_FactorySetting': missing function-prototype
4606   2         
4607   2           
4608   2            // UserPrefRedColorUser = DefColorUser;
4609   2            // UserPrefGreenColorUser = DefColorUser;
4610   2            // UserPrefBlueColorUser = DefColorUser;
4611   2           }
4612   1      #else
                   if( FactoryModeFlag )
                   {
              #if 1 // 090721
                     UserPrefRedColorUser = DefColorUser;
                     UserPrefGreenColorUser = DefColorUser;
                     UserPrefBlueColorUser = DefColorUser;
              #else
                   UserPrefRedColorUser = DefColor;
                   UserPrefGreenColorUser = DefColor;
                   UserPrefBlueColorUser = DefColor;
              #endif
                   }
              #endif
4626   1         Init_MonitorSetting();
4627   1         UserPrefLanguage = BackupLanguage;
4628   1      #if AudioFunc
4629   1          if(UserOSDMuteOnFlag)
4630   1        {
4631   2          UserOSDMuteOnFlag=0;
4632   2        }
4633   1          mStar_AdjustVolume( UserPrefVolume );    
4634   1      #if Audio_Switch
                
                  if((SrcInputType==Input_HDMI)||(SrcInputType==Input_Displayport))
                  {     
                    SetAudioType(UserPrefHDMIAudioType);
                  }   
              #endif
4641   1      #endif
4642   1        Osd_SetTransparency(UserPrefOsdTransparency);
4643   1      #if ENABLE_RTE
                msOverDriveOnOff(UserprefOverDriveSwitch);
              #endif
4646   1        SetECO();
4647   1      
4648   1      #if Enable_Gamma
4649   1          UserPrefGamaMode = GAMA1;
4650   1          mStar_SetupGamma( UserPrefGamaMode );
4651   1          UserPrefGamaOnOff=FALSE;
4652   1          drvGammaOnOff(UserPrefGamaOnOff, MAIN_WINDOW );
4653   1          drvGammaOnOff(UserPrefGamaOnOff, SUB_WINDOW );  
4654   1      #endif
4655   1      
4656   1      //ccadd end
4657   1      
4658   1      
4659   1      #if ENABLE_DPS
4660   1          UserprefDPSMode = 0;
4661   1          msDPS_Off_Setting( );
4662   1      #endif
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 77  

4663   1      #if ENABLE_DSC
4664   1          UserprefDSCMode = 0;
4665   1          msDSC_Off_Setting( );
4666   1      #endif
4667   1      #if ENABLE_DLC
                  UserprefDLCMode = 0;
                  g_bDLCOnOff = 0;
              #endif
4671   1      
4672   1      
4673   1      
4674   1      #if ENABLE_FREESYNC
                  UserprefFreeSyncMode = FreeSyncMenuItems_On;
                  msAPI_combo_IPEnableDDRFlag(UserprefFreeSyncMode);
              #endif
4678   1      
4679   1      #if ENABLE_R2_2DTO3D
                  UserPref2Dto3D = Def2Dto3D;
                  UserPref2Dto3DGameMode = Def2Dto3DGameMode;
                  UserPref2Dto3DGain = Def2Dto3DGain;
                  UserPref2Dto3DOffset = Def2Dto3DOffset;
              #endif
4685   1      
4686   1        UserPrefInputPriorityType=DEF_INPUT_PRIORITY;
4687   1      
4688   1      
4689   1      #if ENABLE_SUPER_RESOLUTION
                  UserPrefSuperResolutionMode = SRMODE_MIDDLE;
                  mStar_SetupSuperResolution( UserPrefSuperResolutionMode );
              #endif
4693   1      #if ENABLE_DeBlocking
                  UserPrefDeBlocking= 0;
                  //msDPS_Off_Setting( );
              #endif
4697   1      
4698   1      
4699   1      #if ENABLE_TNR
                  UserPrefNRmode= NRMODE2;
                  mStar_SetupNRmode( UserPrefNRmode );
              #endif
4703   1         
4704   1          Set_DDCciFlag();
4705   1          if( UserPrefDcrMode )
4706   1          {
4707   2              UserPrefDcrMode = 0;
4708   2      #if !ENABLE_HDMI
                      msAccOnOff( 0 );
              #endif
4711   2              msDlcOnOff( 0 );
4712   2              SetECO();
4713   2          }
4714   1      
4715   1        UserPrefHue = DefHue;
4716   1          UserPrefSaturation = DefSaturation;
4717   1          msAdjustVideoHue( SUB_WINDOW ,UserPrefHue );
4718   1          msAdjustVideoSaturation(SUB_WINDOW, UserPrefSaturation );
4719   1        
4720   1      #if MWEFunction
                  UserPrefColorFlags = 0;
                  UserPrefSubContrast = DefSubContrast;
                  UserPrefSubBrightness = DefSubBrightness;
                  UserPrefBFSize = 1;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 78  

                  msAdjustSubBrightness( UserPrefSubBrightness );
                  msAdjustVideoContrast( DefContrastBase + UserPrefContrast );
                  SetBFSize( UserPrefBFSize );
              #endif
4729   1          UserprefHistogram1 = 0x40;
4730   1          UserprefHistogram2 = 0xB0;
4731   1          UserprefALha = 50;
4732   1          UserprefBata = 50;
4733   1      
4734   1      
4735   1      //cc add start
4736   1          if(CURRENT_INPUT_IS_VGA())//(( SrcInputType < Input_Digital ) )
4737   1          {
4738   2              if(( !FactoryModeFlag ) && !ProductModeFlag )   //for nw aoc factorymode
4739   2              {
4740   3                  //mStar_AutoGeomtry();
4741   3                  //UserPrefAutoTimes=0;
4742   3                  if( mStar_AutoGeomtry() == TRUE )
4743   3                      //0707
4744   3                  {
4745   4                      UserPrefAutoTimes = 1;
4746   4                      UserPrefAutoHStart = UserPrefHStart;
4747   4                      UserPrefAutoVStart = UserPrefVStart;
4748   4                  }
4749   3              }
4750   2              // UserPrefAutoHStart = UserPrefHStart;
4751   2              {
4752   3                  BYTE modeIndex, flag;
4753   3                  flag = SrcFlags; //UserModeFlag
4754   3                  modeIndex = SaveIndex; //SrcModeIndex;
4755   3                  SrcFlags &= ~bUserMode;
4756   3      #if !USEFLASH
                          for( SaveIndex = 0; SaveIndex < NumberOfMode; SaveIndex++ )
                          {
                              NVRam_WriteByte( nvrModeAddr( CheckSum ), 0 );
                          }
                          for( SaveIndex = 0; SaveIndex < NumberOfMode; SaveIndex++ )
                          {
                              modeInfo.HerFreq = 0;
                              modeInfo.VerFreq = 0;
                              modeInfo.VTotal = 0;
                              modeInfo.Flags = 0;
                              NVRam_WriteTbl( nvrModeInfoAddr( SaveIndex ), ( BYTE* ) &modeInfo, ModeInfoSize );
                          }
                          SaveIndex = 0;
                          SrcFlags = flag;
                          modeInfo.HerFreq = hFreq;
                          modeInfo.VerFreq = vFreq;
                          modeInfo.VTotal = SrcVTotal;
                          modeInfo.Flags = SrcFlags & 0x13;
                          NVRam_WriteTbl( nvrModeInfoAddr( SaveIndex ), ( BYTE* ) &modeInfo, ModeInfoSize );
                          NVRam_WriteByte( nvrModeAddr( CheckSum ), 0 );
                          NVRam_WriteByte( nvrMonitorAddr( SavedModeIndex ), UserPrefSavedModeIndex );
                          SaveModeSetting();
              #else
4780   3                  SaveIndex = SrcModeIndex;//SaveIndex = 0;
4781   3                  SrcFlags = flag;
4782   3                  Flash_ClearModeSet();
4783   3                  SaveModeSetting();
4784   3      #endif
4785   3              }
4786   2          }
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 79  

4787   1          else
4788   1          {
4789   2              Delay1ms( 500 );
4790   2          }
4791   1          Osd_SetPosition(UserPrefOsdHStart, UserPrefOsdVStart);
4792   1      #if Enable_Expansion            //111221 modified Expansion mode condition - B42048, B42029
4793   1          UserprefExpansionMode = DefExpansion;
4794   1          OverScanSetting.AspRatio = UserprefExpansionMode; //20150728  
4795   1          SetExpansionMode();//This Function will mute when reset all setting.
4796   1      #endif
4797   1      
4798   1          if( FactoryModeFlag )
4799   1          {
4800   2      #if USEFLASH
4801   2              UserprefBacklighttime = BlacklitTime = 0;
4802   2              SaveMonitorSetting2();
4803   2      #else
                      BlacklitTime = 0;
                      SaveBlacklitTime();
              #endif
4807   2          }
4808   1          Clr_BurninModeFlag();
4809   1          Clr_DoBurninModeFlag(); // 091014 coding
4810   1          SaveMonitorSetting(); //1020
4811   1          if( ProductModeFlag )
4812   1          {
4813   2      #if USEFLASH
4814   2              FactoryProductModeValue = ProductModeOffValue;
4815   2              SaveFactorySetting();
4816   2      #else
                      WORD temp = ProductModeOffValue;
                      NVRam_WriteTbl( ProductModeAddr, ( BYTE* )( &temp ), 2 );
              #endif
4820   2          }
4821   1      
4822   1          if( ProductModeFlag )
4823   1          {
4824   2              //Power_TurnOnAmberLed();canceled PE Request
4825   2              Clr_ProductModeFlag();//20091022
4826   2          }
4827   1      #if 0//DECREASE_V_SCALING       //111103 Rick modified for avoid auto fail after factory reset - A070
                  DecVScaleValue = 0;
              #endif
4830   1          return TRUE;
4831   1      }
4832          
4833          Bool AutoConfig( void )
4834          {
4835   1          Bool result;
4836   1          result = mStar_AutoGeomtry();
4837   1          //UserPrefAutoHStart=UserPrefHStart;
4838   1          if( result )
4839   1          {
4840   2              UserPrefAutoHStart = UserPrefHStart;
4841   2              UserPrefAutoVStart = UserPrefVStart;
4842   2              UserPrefAutoTimes = 1;
4843   2              SaveModeSetting();
4844   2          }
4845   1          else
4846   1          {
4847   2              UserPrefHTotal = StandardModeHTotal;
4848   2              UserPrefHStart = StandardModeHStart;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 80  

4849   2              UserPrefVStart = StandardModeVStart;
4850   2              UserPrefAutoHStart = UserPrefHStart;
4851   2              UserPrefAutoVStart = UserPrefVStart;
4852   2              UserPrefPhase = 18;
4853   2              UserPrefAutoTimes = 0;
4854   2              drvADC_AdjustHTotal( UserPrefHTotal );
4855   2              drvADC_SetPhaseCode( UserPrefPhase );
4856   2              mStar_AdjustHPosition(UserPrefHStart);//msWrite2Byte( SC0_07, UserPrefHStart );
4857   2              mStar_AdjustVPosition(UserPrefAutoVStart);
4858   2          }
4859   1      
4860   1          return result;
4861   1      }
4862          
4863          Bool ResetGeometry( void )
4864          {
4865   1          UserPrefHStart = StandardModeHStart;
4866   1          mStar_AdjustHPosition( UserPrefHStart );
4867   1          //NVRam_WriteByte(nvrModeAddr(HStart), UserPrefHStart);
4868   1          UserPrefVStart = StandardModeVStart;
4869   1          mStar_AdjustVPosition( UserPrefVStart );
4870   1          //NVRam_WriteByte(nvrModeAddr(VStart), UserPrefVStart);
4871   1          UserPrefHTotal = StandardModeHTotal;
4872   1          drvADC_AdjustHTotal( UserPrefHTotal );
4873   1          //NVRam_WriteByte(nvrModeAddr(HTotal), UserPrefHTotal);
4874   1          UserPrefPhase = 0;
4875   1          drvADC_SetPhaseCode( UserPrefPhase );
4876   1          //NVRam_WriteByte(nvrModeAddr(Phase), UserPrefPhase);
4877   1          AutoConfig();
4878   1          return TRUE;
4879   1      }
4880          
4881          void SaveUserPref(void)
4882          {
4883   1          #if USEFLASH
4884   1          UserPref_EnableFlashSaveBit(bFlashSaveMonitorBit); 
4885   1          if (SrcInputType == Input_Analog1)
4886   1          {
4887   2              UserPref_EnableFlashSaveBit(bFlashSaveModeBit);
4888   2          }
4889   1          #else
                  SaveMonitorSetting();
                  if (SrcInputType == Input_Analog1)
                  {
                      SaveModeSetting();
                  }
                  #endif
4896   1      }
4897          
4898          void SaveUserPrefSetting(BYTE menuPageIndex)
4899          {
4900   1          menuPageIndex = 0;
4901   1          SaveUserPref();
4902   1          Clr_SaveSettingFlag();
4903   1      }
4904          
4905          Bool AutoColor( void )
4906          {
4907   1          Bool result;
4908   1          if(!CURRENT_INPUT_IS_VGA())//( SrcInputType == Input_Digital || SrcInputType == Input_Digital2 )
4909   1              return TRUE;
4910   1          result = mStar_AutoColor();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 81  

4911   1          Osd_SetTextColor( CP_RedColor, CP_WhiteColor );
4912   1          if( result )
4913   1          {
4914   2              //Osd_DrawStr(10, 2, PassText());
4915   2              SaveFactorySetting();
4916   2          }
4917   1          return result;
4918   1      }
4919          
4920          Bool AdjustRedGain( MenuItemActionType action )
4921          {
4922   1          WORD tempValue;
4923   1          tempValue = DecIncValue( action, UserPrefAdcRedGain, 0, 0xFFF, 1 );
4924   1          if( tempValue == UserPrefAdcRedGain )
4925   1          {
4926   2              return FALSE;
4927   2          }
4928   1          UserPrefAdcRedGain = tempValue;
4929   1          //msADC_AdjustAdcRedGain( UserPrefAdcRedGain );
4930   1          drvADC_SetRedGainCode(UserPrefAdcRedGain);
4931   1          return TRUE;
4932   1      }
4933          WORD GetRedGainValue( void )
4934          {
4935   1          return UserPrefAdcRedGain;
4936   1      }
4937          Bool AdjustGreenGain( MenuItemActionType action )
4938          {
4939   1          WORD tempValue;
4940   1          tempValue = DecIncValue( action, UserPrefAdcGreenGain, 0, 0xFFF, 1 );
4941   1          if( tempValue == UserPrefAdcGreenGain )
4942   1          {
4943   2              return FALSE;
4944   2          }
4945   1          UserPrefAdcGreenGain = tempValue;
4946   1          //msADC_AdjustAdcGreenGain( UserPrefAdcGreenGain );
4947   1          drvADC_SetGreenGainCode(UserPrefAdcGreenGain);
4948   1          return TRUE;
4949   1      }
4950          WORD GetGreenGainValue( void )
4951          {
4952   1          return UserPrefAdcGreenGain;
4953   1      }
4954          Bool AdjustBlueGain( MenuItemActionType action )
4955          {
4956   1          WORD tempValue;
4957   1          tempValue = DecIncValue( action, UserPrefAdcBlueGain, 0, 0xFFF, 1 );
4958   1          if( tempValue == UserPrefAdcBlueGain )
4959   1          {
4960   2              return FALSE;
4961   2          }
4962   1          UserPrefAdcBlueGain = tempValue;
4963   1          //msADC_AdjustAdcBlueGain( UserPrefAdcBlueGain );
4964   1          drvADC_SetBlueGainCode(UserPrefAdcBlueGain);
4965   1          return TRUE;
4966   1      }
4967          WORD GetBlueGainValue( void )
4968          {
4969   1          return UserPrefAdcBlueGain;
4970   1      }
4971          //====================================================
4972          //====================================================
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 82  

4973          Bool AdjustAdcRedOffset( MenuItemActionType action )
4974          {
4975   1          WORD tempValue;
4976   1          tempValue = DecIncValue( action, UserPrefAdcRedOffset, 0, 0x7FF, 1 );
4977   1          if( tempValue == UserPrefAdcRedOffset )
4978   1          {
4979   2              return FALSE;
4980   2          }
4981   1          UserPrefAdcRedOffset = tempValue;
4982   1          //msADC_AdjustAdcRedOffset( UserPrefAdcRedOffset );
4983   1          drvADC_SetRedOffsetCode(UserPrefAdcRedOffset);
4984   1          return TRUE;
4985   1      }
4986          WORD GetAdcRedOffsetValue( void )
4987          {
4988   1          return UserPrefAdcRedOffset;
4989   1      }
4990          Bool AdjustAdcGreenOffset( MenuItemActionType action )
4991          {
4992   1          WORD tempValue;
4993   1          tempValue = DecIncValue( action, UserPrefAdcGreenOffset, 0, 0x7FF, 1 );
4994   1          if( tempValue == UserPrefAdcGreenOffset )
4995   1          {
4996   2              return FALSE;
4997   2          }
4998   1          UserPrefAdcGreenOffset = tempValue;
4999   1          //msADC_AdjustAdcGreenOffset( UserPrefAdcGreenOffset );
5000   1          drvADC_SetGreenOffsetCode(UserPrefAdcGreenOffset);
5001   1          return TRUE;
5002   1      }
5003          WORD GetAdcGreenOffsetValue( void )
5004          {
5005   1          return UserPrefAdcGreenOffset;
5006   1      }
5007          Bool AdjustAdcBlueOffset( MenuItemActionType action )
5008          {
5009   1          WORD tempValue;
5010   1          tempValue = DecIncValue( action, UserPrefAdcBlueOffset, 0, 0x7FF, 1 );
5011   1          if( tempValue == UserPrefAdcBlueOffset )
5012   1          {
5013   2              return FALSE;
5014   2          }
5015   1          UserPrefAdcBlueOffset = tempValue;
5016   1          //msADC_AdjustAdcBlueOffset( UserPrefAdcBlueOffset );
5017   1          drvADC_SetBlueOffsetCode(UserPrefAdcBlueOffset);
5018   1          return TRUE;
5019   1      }
5020          WORD GetAdcBlueOffsetValue( void )
5021          {
5022   1          return UserPrefAdcBlueOffset;
5023   1      }
5024          
5025          
5026          void GetColorTempRGB(ColorType *pstColor)
5027          {
5028   1          pstColor->u8Red     =*(ColorTempPtr[UserPrefColorTemp][0]);
5029   1          pstColor->u8Green   =*(ColorTempPtr[UserPrefColorTemp][1]);
5030   1          pstColor->u8Blue    =*(ColorTempPtr[UserPrefColorTemp][2]);
5031   1      }
5032          
5033          void ReadColorTempSetting( void )
5034          {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 83  

5035   1          UserPrefRedColor =  *ColorTempPtr[UserPrefColorTemp][0];
5036   1          UserPrefGreenColor =  *ColorTempPtr[UserPrefColorTemp][1];
5037   1          UserPrefBlueColor =  *ColorTempPtr[UserPrefColorTemp][2];
5038   1          CheckColorValueRange();
5039   1          UserPrefBrightness %= 101;
5040   1          // 2006/11/10 11:13PM by KK   if(!UserPrefDcrMode) // for under DCR mode, the picture show filter
5041   1          mStar_AdjustBrightness( UserPrefBrightness );
5042   1          mStar_AdjustContrast( UserPrefContrast );
5043   1          //msAdjustVideoContrast(DefContrastBase + UserPrefContrast);
5044   1      }
5045          
5046          
5047          void SetECO( void )
5048          {
5049   1          SetColorTemp();
5050   1         if (UserPrefECOMode == ECO_Text)
5051   1        {
5052   2          UserPrefBrightness = 60;   
5053   2          UserPrefContrast = DefContrast;   
5054   2        }
5055   1        else if (UserPrefECOMode == ECO_Game)
5056   1        {
5057   2          UserPrefBrightness = 85;   
5058   2          UserPrefContrast = 60;
5059   2        }
5060   1        else if (UserPrefECOMode == ECO_Movie)
5061   1        {
5062   2          UserPrefBrightness = 100;   
5063   2          UserPrefContrast = 80;   
5064   2        }
5065   1        else if (UserPrefECOMode == ECO_Standard)
5066   1        {
5067   2          UserPrefBrightness=UserPrefBrightnessTemp;  
5068   2          UserPrefContrast =UserPrefContrastTemp;     //  
5069   2        }
5070   1          mStar_AdjustBrightness( UserPrefBrightness );
5071   1          mStar_AdjustContrast( UserPrefContrast );
5072   1      }
5073          Bool AdjustECOMode( MenuItemActionType action )
5074          {
5075   1          UserPrefDcrMode = 0;
5076   1      #if MWEFunction
                  Clr_GreenFlag();
                  Clr_SkinFlag();
                  Clr_BlueFlag();
                  Clr_ColorAutoDetectFlag();
                  Clr_FullEnhanceFlag();
                  Clr_DemoFlag();
                  Clr_PictureBoostFlag();
                  SetBFSize( UserPrefBFSize );
              #endif
5086   1          //Benz 2007.4.23   15:35:12
5087   1          //Benz 2007.4.23   16:40:20     Osd_Draw4Num(1,1,UserPrefECOMode);
5088   1          if( action == MIA_DecValue )
5089   1          {
5090   2              UserPrefECOMode = ( UserPrefECOMode + ECO_Nums - 1 ) % ECO_Nums; //Benz have some bug issue
5091   2          }
5092   1          else
5093   1          {
5094   2              UserPrefECOMode = ( UserPrefECOMode + 1 ) % ECO_Nums;
5095   2          }
5096   1          //Benz 2007.4.23   16:40:10     Osd_Draw4Num(2,1,UserPrefECOMode);
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 84  

5097   1      #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( ECOMode ), UserPrefECOMode );
              #if MWEFunction
                  NVRam_WriteByte( nvrMonitorAddr( ColorFlag ), UserPrefColorFlags );
              #endif
              #else
5103   1          //SaveMonitorSetting();
5104   1          Set_FlashSaveMonitorFlag();
5105   1      #endif
5106   1          SetECO();
5107   1          return TRUE;
5108   1      }
5109          
5110          
5111          Bool AdjustDcrMode( MenuItemActionType action )
5112          {
5113   1      #if ENABLE_HDMI
5114   1          BYTE XDATA ucDomain;
5115   1      #endif
5116   1      
5117   1          action = action;
5118   1      
5119   1      #if ENABLE_HDMI
5120   1          ucDomain = 0x00;
5121   1          if( gScInfo.InputColor != INPUT_RGB )
5122   1              ucDomain = 0xFF;
5123   1      #endif
5124   1      
5125   1      #if 1
5126   1      
5127   1          if( UserPrefDcrMode )
5128   1          {
5129   2              UserPrefDcrMode = 0;
5130   2              SetECO();
5131   2          }
5132   1          else
5133   1          {
5134   2              UserPrefDcrMode = 1;
5135   2              UserPrefColorTemp = CTEMP_6500K;
5136   2      
5137   2              UserPrefECOMode = ECO_Standard;
5138   2              ReadColorTempSetting();
5139   2      
5140   2          #if MWEFunction
                  #if 0//!ENABLE_HDMI // wait for coding
                      //msAdjustSubBrightness( UserPrefSubBrightness );
                      msAdjustSubBrightness( MAIN_WINDOW, UserPrefSubBrightness, UserPrefSubBrightness, UserPrefSubBrigh
             -tness );
                      msAdjustVideoContrast( DefContrastBase + UserPrefContrast );
                  #endif
                      Clr_PictureBoostFlag();
                      Clr_ColorAutoDetectFlag();
                      Clr_FullEnhanceFlag();
                      Clr_SkinFlag();
                      Clr_BlueFlag();
                      Clr_GreenFlag();
                      Clr_DemoFlag();
                  #endif
5154   2      
5155   2          }
5156   1          msDCROnOff(UserPrefDcrMode, MAIN_WINDOW);
5157   1      
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 85  

5158   1      #else
              
                  if( UserPrefDcrMode )
                  {
                      UserPrefDcrMode = 0;
                      //msWriteByte( BK0_00, REGBANK0 );
                      mStar_AdjustBrightness( UserPrefBrightness );
              #if !ENABLE_HDMI
              #if MWEFunction
                      if( UserPrefColorFlags )
                          msAccOnOff( 1 );
                      else
              #endif
                          msAccOnOff( 0 );
              #endif
                      msDlcOnOff( 0 );
                      SetECO();
                  }
                  else
                  {
              
                      UserPrefDcrMode = 1;
              
                      //if ( UserPrefColorTemp == CTEMP_SRGB ) // 100817
                      UserPrefColorTemp = CTEMP_Warm1;
              
                      UserPrefECOMode = ECO_Standard;
                      ReadColorTempSetting();
                      #if MWEFunction
                      #if !ENABLE_HDMI
                      //msAdjustSubBrightness( UserPrefSubBrightness );
                      msAdjustSubBrightness( MAIN_WINDOW, UserPrefSubBrightness, UserPrefSubBrightness, UserPrefSubBrigh
             -tness );
                      msAdjustVideoContrast( DefContrastBase + UserPrefContrast );
                      #endif
                      Clr_PictureBoostFlag(); // 2006/10/20 6:21PM by Emily for aoc request
                      Clr_ColorAutoDetectFlag();
                      Clr_FullEnhanceFlag();
                      Clr_SkinFlag();
                      Clr_BlueFlag();
                      Clr_GreenFlag();
                      Clr_DemoFlag();
              #endif
              
                      //msWriteByte( BK0_00, REGBANK3 );
                      //msWriteByte( BK3_72, 0x70 );
                      //msWriteByte( BK3_73, 0x70 );
                      //msWriteByte( BK3_74, 0x70 );
                      //msWriteByte( BK0_00, REGBANK0 );
              
                      LoadACETable(MAIN_WINDOW, (BYTE *)t_Normal_ColorSettingTable, DefHue, DefSaturation, 0x80 ); // /U
             -serPrefSubContrast
                      msAccSetup( 0, PanelWidth, 0, PanelHeight );
              #if !ENABLE_HDMI
                      msAccOnOff( 1 );
              #endif
                      msDlcInit( PanelWidth, PanelHeight );
                      msSetDlcStrength( g_LowStrength, g_HighStrength );
                      LoadDLCTable( t_MWEDLC_Linear_Table );
              #if !ENABLE_HDMI
                      msDlcOnOff( 1 );
              #endif
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 86  

                  }
              #if ENABLE_HDMI
              #if MWEFunction
                  if( UserPrefDcrMode || UserPrefColorFlags )
              #else
                  if( UserPrefDcrMode )
              #endif
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                      {
                          SetMainWinVideoDomain( ucDomain );      //SetMainWinColorControl(ucDomain);
                          mStar_WriteByteMask( BK0_5C, BIT3, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C ) | BIT3 
             -);
                      }
                      else
              #endif
                          msAccOnOff( _ENABLE );
              
                      if( UserPrefDcrMode )
                          msDlcOnOff( _ENABLE );
                  }
                  else
                  {
              #if ENABLE_HDMI
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_5C, 0x00, BIT3 ); //msWriteByte( BK0_5C, msReadByte( BK0_5C )&~BIT3 )
             -;
                      else
              #endif
                          msAccOnOff( 0 );
              
                      msDlcOnOff( _DISABLE );
              
              #if ENABLE_HDMI
                      SetMainWinVideoDomain( 0 ); //SetMainWinColorControl(0);
                      if( ucDomain )
                          mStar_WriteByteMask( BK0_02, BIT3, BIT3 ); //msWriteByte( BK0_02, msReadByte( BK0_02 ) | BIT3 
             -);
              #endif
                  }
              #endif
              
                  msDCROnOff(UserPrefDcrMode, 0);
              #endif
5260   1      
5261   1      
5262   1      #if !USEFLASH
                  NVRam_WriteByte( nvrMonitorAddr( DcrMode ), UserPrefDcrMode );
                  NVRam_WriteByte( nvrMonitorAddr( ECOMode ), UserPrefECOMode );
              #else
5266   1          //SaveMonitorSetting();
5267   1          Set_FlashSaveMonitorFlag();
5268   1      #endif
5269   1          return TRUE;
5270   1      }
5271          
5272          
5273          Bool SetFactoryColorTempCool1( void )
5274          {
5275   1          UserPrefColorTemp = CTEMP_9300K;
5276   1          ReadColorTempSetting(); // 2006/11/10 6:58PM by KK ReadCool1Setting();
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 87  

5277   1          //mStar_AdjustBrightness( UserPrefBrightness );
5278   1          //mStar_AdjustContrast( UserPrefContrast );
5279   1          return TRUE;
5280   1      }
5281          
5282          Bool SetFactoryColorTempNormal( void )
5283          {
5284   1          UserPrefColorTemp = CTEMP_6500K;
5285   1          ReadColorTempSetting(); // 2006/11/10 6:58PM by KK ReadNormalSetting();
5286   1          //mStar_AdjustBrightness( UserPrefBrightness );
5287   1          //mStar_AdjustContrast( UserPrefContrast );
5288   1          return TRUE;
5289   1      }
5290          Bool SetFactoryColorTempWarm1( void )
5291          {
5292   1          UserPrefColorTemp = CTEMP_5400K;
5293   1          ReadColorTempSetting(); // 2006/11/10 6:57PM by KK  ReadWarm1Setting();
5294   1          //mStar_AdjustBrightness( UserPrefBrightness );
5295   1          //mStar_AdjustContrast( UserPrefContrast );
5296   1          return TRUE;
5297   1      }
5298          
5299          Bool AdjustRedColorWarm1( MenuItemActionType action )
5300          {
5301   1          WORD tempValue;
5302   1          tempValue = DecIncValue( action, UserPrefRedColorWarm1, MinColorValue, MaxColorValue, 1 );
5303   1          if( tempValue == UserPrefRedColorWarm1 )
5304   1          {
5305   2              return FALSE;
5306   2          }
5307   1          UserPrefRedColorWarm1 = tempValue;
5308   1        UserPrefColorTemp=CTEMP_5400K;
5309   1        SetColorTemperature5400K();
5310   1          return TRUE;
5311   1      }
5312          Bool AdjustGreenColorWarm1( MenuItemActionType action )
5313          {
5314   1          WORD tempValue;
5315   1          tempValue = DecIncValue( action, UserPrefGreenColorWarm1, MinColorValue, MaxColorValue, 1 );
5316   1          if( tempValue == UserPrefGreenColorWarm1 )
5317   1          {
5318   2              return FALSE;
5319   2          }
5320   1          UserPrefGreenColorWarm1 = tempValue;
5321   1        UserPrefColorTemp=CTEMP_5400K;
5322   1        SetColorTemperature5400K();
5323   1          return TRUE;
5324   1      }
5325          Bool AdjustBlueColorWarm1( MenuItemActionType action )
5326          {
5327   1          WORD tempValue;
5328   1          tempValue = DecIncValue( action, UserPrefBlueColorWarm1, MinColorValue, MaxColorValue, 1 );
5329   1          if( tempValue == UserPrefBlueColorWarm1 )
5330   1          {
5331   2              return FALSE;
5332   2          }
5333   1          UserPrefBlueColorWarm1 = tempValue;
5334   1        UserPrefColorTemp=CTEMP_5400K;
5335   1        SetColorTemperature5400K();
5336   1          return TRUE;
5337   1      }
5338          
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 88  

5339          WORD GetRColorWarm1Value( void )
5340          {
5341   1          return UserPrefRedColorWarm1;
5342   1      }
5343          WORD GetGColorWarm1Value( void )
5344          {
5345   1          return UserPrefGreenColorWarm1;
5346   1      }
5347          WORD GetBColorWarm1Value( void )
5348          {
5349   1          return UserPrefBlueColorWarm1;
5350   1      }
5351          
5352          Bool AdjustRedColorNormal( MenuItemActionType action )
5353          {
5354   1          WORD tempValue;
5355   1          tempValue = DecIncValue( action, UserPrefRedColorNormal, MinColorValue, MaxColorValue, 1 );
5356   1          if( tempValue == UserPrefRedColorNormal )
5357   1          {
5358   2              return FALSE;
5359   2          }
5360   1          UserPrefRedColorNormal = tempValue;
5361   1        UserPrefColorTemp=CTEMP_6500K;
5362   1        SetColorTemperature6500K();
5363   1          return TRUE;
5364   1      }
5365          Bool AdjustGreenColorNormal( MenuItemActionType action )
5366          {
5367   1          WORD tempValue;
5368   1          tempValue = DecIncValue( action, UserPrefGreenColorNormal, MinColorValue, MaxColorValue, 1 );
5369   1          if( tempValue == UserPrefGreenColorNormal )
5370   1          {
5371   2              return FALSE;
5372   2          }
5373   1          UserPrefGreenColorNormal = tempValue;
5374   1        UserPrefColorTemp=CTEMP_6500K;
5375   1          SetColorTemperature6500K();
5376   1          return TRUE;
5377   1      }
5378          Bool AdjustBlueColorNormal( MenuItemActionType action )
5379          {
5380   1          WORD tempValue;
5381   1          tempValue = DecIncValue( action, UserPrefBlueColorNormal, MinColorValue, MaxColorValue, 1 );
5382   1          if( tempValue == UserPrefBlueColorNormal )
5383   1          {
5384   2              return FALSE;
5385   2          }
5386   1          UserPrefBlueColorNormal = tempValue;
5387   1        UserPrefColorTemp=CTEMP_6500K;
5388   1          SetColorTemperature6500K();
5389   1          return TRUE;
5390   1      }
5391          WORD GetRColorNormalValue( void )
5392          {
5393   1          return UserPrefRedColorNormal;
5394   1      }
5395          WORD GetGColorNormalValue( void )
5396          {
5397   1          return UserPrefGreenColorNormal;
5398   1      }
5399          WORD GetBColorNormalValue( void )
5400          {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 89  

5401   1          return UserPrefBlueColorNormal;
5402   1      }
5403          
5404          Bool AdjustRedColorCool1( MenuItemActionType action )
5405          {
5406   1          WORD tempValue;
5407   1          tempValue = DecIncValue( action, UserPrefRedColorCool1, MinColorValue, MaxColorValue, 1 );
5408   1          if( tempValue == UserPrefRedColorCool1 )
5409   1          {
5410   2              return FALSE;
5411   2          }
5412   1          UserPrefRedColorCool1 = tempValue;
5413   1          UserPrefColorTemp=CTEMP_9300K;
5414   1          SetColorTemperature9300K();
5415   1          return TRUE;
5416   1      }
5417          Bool AdjustGreenColorCool1( MenuItemActionType action )
5418          {
5419   1          WORD tempValue;
5420   1          tempValue = DecIncValue( action, UserPrefGreenColorCool1, MinColorValue, MaxColorValue, 1 );
5421   1          if( tempValue == UserPrefGreenColorCool1 )
5422   1          {
5423   2              return FALSE;
5424   2          }
5425   1          UserPrefGreenColorCool1 = tempValue;
5426   1        UserPrefColorTemp=CTEMP_9300K;
5427   1           SetColorTemperature9300K();
5428   1          return TRUE;
5429   1      }
5430          Bool AdjustBlueColorCool1( MenuItemActionType action )
5431          {
5432   1          WORD tempValue;
5433   1          tempValue = DecIncValue( action, UserPrefBlueColorCool1, MinColorValue, MaxColorValue, 1 );
5434   1          if( tempValue == UserPrefBlueColorCool1 )
5435   1          {
5436   2              return FALSE;
5437   2          }
5438   1          UserPrefBlueColorCool1 = tempValue;
5439   1        UserPrefColorTemp=CTEMP_9300K;
5440   1           SetColorTemperature9300K();
5441   1          return TRUE;
5442   1      }
5443          WORD GetRColorCool1Value( void )
5444          {
5445   1          return UserPrefRedColorCool1;
5446   1      }
5447          WORD GetGColorCool1Value( void )
5448          {
5449   1          return UserPrefGreenColorCool1;
5450   1      }
5451          WORD GetBColorCool1Value( void )
5452          {
5453   1          return UserPrefBlueColorCool1;
5454   1      }
5455          
5456          
5457          #if ENABLE_FACTORY_SSCADJ
5458          Bool AdjustFactorySSCModulation( MenuItemActionType action )
5459          {
5460   1          WORD xdata tempValue;
5461   1      
5462   1          tempValue = DecIncValue( action, FactorySetting.SSCModulation, 0, PANEL_SSC_MODULATION_MAX, 1 );
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 90  

5463   1      
5464   1          if( tempValue == FactorySetting.SSCModulation )
5465   1              return FALSE;
5466   1      
5467   1          FactorySetting.SSCModulation = tempValue;
5468   1      
5469   1          mStar_SetPanelSSC(FactorySetting.SSCModulation, FactorySetting.SSCPercentage);
5470   1      
5471   1          #if USEFLASH
5472   1          Set_FlashForceSaveFactoryFlag();
5473   1          #else
                  NVRam_WriteByte( nvrFactoryAddr( SSCModulation ), FactorySetting.SSCModulation );
                  #endif
5476   1      
5477   1          return TRUE;
5478   1      }
5479          
5480          WORD GetFactorySSCModulationValue( void )
5481          {
5482   1          return FactorySetting.SSCModulation;
5483   1      }
5484          
5485          Bool AdjustFactorySSCPercentage( MenuItemActionType action )
5486          {
5487   1          WORD xdata tempValue;
5488   1      
5489   1          tempValue = DecIncValue( action, FactorySetting.SSCPercentage, 0, PANEL_SSC_PERCENTAGE_MAX, 1 );
5490   1          if( tempValue == FactorySetting.SSCPercentage )
5491   1              return FALSE;
5492   1      
5493   1          FactorySetting.SSCPercentage = tempValue;
5494   1      
5495   1          mStar_SetPanelSSC(FactorySetting.SSCModulation, FactorySetting.SSCPercentage);
5496   1          #if USEFLASH
5497   1          Set_FlashForceSaveFactoryFlag();
5498   1          #else
                  NVRam_WriteByte( nvrFactoryAddr( SSCPercentage ), FactorySetting.SSCPercentage );
                  #endif
5501   1          return TRUE;
5502   1      }
5503          
5504          WORD GetFactorySSCPercentageValue( void )
5505          {
5506   1          return FactorySetting.SSCPercentage;
5507   1      }
5508          #endif
5509          
5510          Bool EnableBurninMode( void )
5511          {
5512   1          PatternNo = 0;
5513   1          //msWriteByte( BK0_32, BIT0 );
5514   1          drvOSD_FrameColorEnable(TRUE);
5515   1          return TRUE;
5516   1      }
5517          
5518          WORD GetBurninValue( void )
5519          {
5520   1          return ( BurninModeFlag ) ? ( 1 ) : ( 0 );
5521   1      }
5522          Bool AdjustBurnin( MenuItemActionType action )
5523          {
5524   1          action = action;
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 91  

5525   1          if( BurninModeFlag )
5526   1          {
5527   2              Clr_BurninModeFlag();
5528   2              Clr_DoBurninModeFlag();     //110928 Rick modified for do burnin mode while burnin on - A027
5529   2          }
5530   1          else
5531   1          {
5532   2              Set_BurninModeFlag();
5533   2              Set_DoBurninModeFlag();      //110928 Rick modified for do burnin mode while burnin on - A027
5534   2          }
5535   1      #if USEFLASH
5536   1          //SaveMonitorSetting();
5537   1          Set_FlashForceSaveMonitorFlag();
5538   1      #else
                  NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #endif
5541   1          Delay1ms( 200 );
5542   1          return TRUE;
5543   1      }
5544          
5545          #if DisplayLogo!=NoBrand  //130613 Jun
5546          WORD GetLogoValue(void)
5547          {
5548   1        return (UserPrefLogoON) ? (1): (0);
5549   1      }
5550          Bool AdjustLogo(MenuItemActionType action)
5551          {
5552   1        action = action;  
5553   1        if (UserPrefLogoON)
5554   1        {
5555   2          UserPrefLogoON=0;//130613 Modify for TPV Request
5556   2        }
5557   1        else
5558   1        {
5559   2          UserPrefLogoON=1;//130613 Modify for TPV Request
5560   2        } 
5561   1        #if USEFLASH
5562   1        SaveFactorySetting();
5563   1        #else
                NVRam_WriteByte(nvrFactoryAddr(LogoON), UserPrefLogoON);
                #endif
5566   1        
5567   1        return TRUE;
5568   1      }
5569          #endif
5570          
5571          #if DDCCI_ENABLE
5572          WORD GetDDCCIValue(void)
5573          {
5574   1        return (DDCciFlag) ? (1): (0);
5575   1      }
5576          
5577          Bool AdjustDDCCI( MenuItemActionType action )
5578          {
5579   1          action = action;
5580   1          if( DDCciFlag )
5581   1              Clr_DDCciFlag();
5582   1          else
5583   1              Set_DDCciFlag();
5584   1          return TRUE;
5585   1      }
5586          #endif
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 92  

5587          
5588          Bool EnterDisplayLogo( void )
5589          {
5590   1        if(UserPrefLogoON)
5591   1        {
5592   2            OsdCounter = 3;
5593   2             mStar_SetupFreeRunMode();
5594   2             mStar_AdjustBrightness(UserPrefBrightness);   //  80
5595   2      #if !ENABLE_EDP_OUTPUT // Leger eDP Tx output without this process to avoide garbage display
5596   2            Power_TurnOnPanel();
5597   2      #endif
5598   2        }
5599   1        else
5600   1          OsdCounter = 1; 
5601   1        
5602   1          return TRUE;
5603   1      }
5604          
5605          #if Enable_Expansion
5606          void SetExpansionMode( void )
5607          {
5608   1          mStar_BlackWhiteScreenCtrl(BW_SCREEN_BLACK);
5609   1          {
5610   2              #if UseINT
5611   2              mStar_EnableModeChangeINT(FALSE);
5612   2              #endif
5613   2              mStar_SetupMode();
5614   2              #if UseINT
5615   2              mStar_EnableModeChangeINT(TRUE);
5616   2              #endif
5617   2          }
5618   1          mStar_BlackWhiteScreenCtrl(BW_SCREEN_OFF);
5619   1      }
5620          
5621          Bool AdjustExpansionMode(void)
5622          {
5623   1      
5624   1              UserprefExpansionMode++;
5625   1              UserprefExpansionMode = (UserprefExpansionMode) % Expansion_Nums;
5626   1      
5627   1          drvOSD_FrameColorRGB(0, 0, 0); // 43
5628   1      
5629   1          OverScanSetting.AspRatio = UserprefExpansionMode; //20150728  
5630   1              SetExpansionMode();
5631   1      
5632   1          Set_SaveMonitorSettingFlag(); 
5633   1          return TRUE;
5634   1      }
5635          #endif
5636          
5637          #if OSD_OD 
              #if 0
                      WORD GetOverDriveValue(void)
                      {
                          return (UserprefOverDriveSwitch) ? (1): (0);
                      }
              #endif
              Bool AdjustOverDrive(MenuItemActionType action)
              {
                action = action;
                if (UserprefOverDriveSwitch)
                {
C51 COMPILER V9.60.0.0   MENUFUNC                                                          12/22/2020 19:50:26 PAGE 93  

                  UserprefOverDriveSwitch = 0;
                  msOverDriveOnOff( FALSE );
                }
                else
                {
                  UserprefOverDriveSwitch = 1;
                  msOverDriveOnOff( TRUE );
                }
              #if USEFLASH
                Set_FlashSaveMonitorFlag();
              #else
                NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #endif  
                Delay1ms(200);
                return TRUE;
              }
              #endif
5666          
5667          #if LowBlueLight
              Bool AdjustBlueLightMode(MenuItemActionType action)
              {
              
                  if( action == MIA_DecValue )
                  {
                      UserPrefLowBlueMode = ( UserPrefLowBlueMode + BlueLight_Nums - 1 ) % BlueLight_Nums;
                  }
                  else
                  {
                      UserPrefLowBlueMode = ( UserPrefLowBlueMode + 1 ) % BlueLight_Nums;
                  }
              
                 UserPrefColorTemp=CTEMP_USER;
              
                 if ( UserPrefColorTemp == CTEMP_USER )
                  {
                  SetColorTemperatureUser();
                  }
                 
                ReadColorTempSetting();
              #if USEFLASH
                Set_FlashSaveMonitorFlag();
              #else
                NVRam_WriteByte( nvrMonitorAddr( MonitorFlag ), MonitorFlags );
              #endif  
                Delay1ms(200);
                return TRUE;
              }
              #endif
5697          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4591    ----
   CONSTANT SIZE    =    243    ----
   XDATA SIZE       =      4       5
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      28
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
